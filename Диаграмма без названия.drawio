<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36" version="28.2.7">
  <diagram name="Страница — 1" id="UEoj7QPsIXpe_KQzLWxL">
    <mxGraphModel dx="1152" dy="692" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="dUc_57Bg2O3dePhUninS-3" value="&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;xslData;XLSY;v2;5822;-1;-1;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&quot; style=&quot;border-collapse: collapse;font-family:Calibri;font-size:11pt;color:#000;background-color:transparent;&quot;&gt;&lt;tbody&gt;&lt;tr style=&quot;height:240.43pt&quot;&gt;&lt;td style=&quot;width:820.7142857142857pt;white-space:normal;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;Автовывод: Финансовое состояние, рассчитанное моделью &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Неудовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Результативность (операционные результаты)&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Удовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Снижение выручки LTM по сравнению с АППГ (5.8)%.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Выручка за квартал относительно предыдущего снижается 2 квартала подряд ((18.6)% и (7.2)%), аналогично АППГ.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Выручка за квартал относительно АППГ снижается 2 квартала подряд ((6.3)% и (8)%).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Рентабельность EBITDA LTM составила 5.5%.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Чистая прибыль 8 165 тыс. руб.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Качество активов и управление ими&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Хорошее&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;КТЛ 3.36, выше порогового значения 1.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость ДЗ LTM 36 дней - соответствует оборачиваемости большинства компаний данного ОКК (44 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость КЗ LTM 48 дней - соответствует оборачиваемости большинства компаний данного ОКК (71 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость запасов LTM 118 дней - соответствует оборачиваемости большинства компаний данного ОКК (171 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Возможность исполнения обязательств&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Неудовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Долг(за искл. субор. займов)/EBITDA LTM 3.93, выше порогового значения 3.5 для данного ОКК.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;ICR LTM 2.73 - выше порогового значения 1.5.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Доля ЧА в структуре баланса 31.8% (&amp;gt;=20%).&lt;br&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="490" y="770" width="560" height="410" as="geometry" />
        </mxCell>
        <mxCell id="dUc_57Bg2O3dePhUninS-4" value="&quot;Автовывод: Финансовое состояние, рассчитанное моделью - Удовлетворительное&#xa;Результативность (операционные результаты) - Неудовлетворительное&#xa;Снижение выручки LTM по сравнению с АППГ (33.3)%.&#xa;Выручка за квартал увеличивается хотя бы в одном из 2х кварталов подряд: относительно прошлого периода ((95.8)% и 1772.9%) и АППГ ((76.5)% и 50.5%).&#xa;Рентабельность EBITDA LTM составила 22.3%.&#xa;Чистая прибыль 79 585 тыс. руб.&#xa;Качество активов и управление ими - Удовлетворительное&#xa;КТЛ 1.84, выше порогового значения 1.&#xa;Оборачиваемость ДЗ LTM 108 дней - соответствует оборачиваемости большинства компаний данного ОКК (135 дней).&#xa;Оборачиваемость КЗ LTM 183 дней - соответствует оборачиваемости большинства компаний данного ОКК (192 дней).&#xa;Оборачиваемость запасов LTM 340 дней - выше оборачиваемости большинства компаний данного ОКК (204 дней).&#xa;Возможность исполнения обязательств - Удовлетворительное&#xa;Чистый долг(за искл. субор. займов)/EBITDA LTM 3.63, соответствует диапазону от 3.5 до 4 для данного ОКК.&#xa;ICR LTM 2.1 - выше порогового значения 2.&#xa;Доля ЧА в структуре баланса 19.7% (&lt;20%).&#xa;&quot;" style="text;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="520" y="1180" width="560" height="330" as="geometry" />
        </mxCell>
        <mxCell id="dUc_57Bg2O3dePhUninS-5" value="&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;x_xslData;XLSY;v2;4053;-1;-1;BwaAAgAAB5sCAAAJPQQAAAHOCgAAAt4MAAADTQQAAASQBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEWAAAA+gwADQAOAA8A+wAHAAAA+hIAAAAA+wKdAQAA+gAcAAAAYwByAGkAdABlAHIAaQBhAF8AZABpAGMAdABpAG8AbgBhAHIAeQAgACgANAApAC4AeABsAHMAeAACFwAAABsETwRFBBAEOwQ1BDoEQQQwBD0ENARABDAEEgQwBDsENQRABEwENQQyBD0EMAQDAQAAADQABBQAAAAyADAAMgA1AC0AMAA2AC0AMgA5AFQAMQA5ADoAMwA5ADoANQAyAFoABRQAAAAyADAAMgA1AC0AMAA3AC0AMQA3AFQAMQAxADoANQAyADoAMAAyAFoA+wDFAAAA+gdCAAAALwBoAG8AbQBlAC8AcwBpAGcAbQBhAC4AcwBiAHIAZgAuAHIAdQBAAGwAeQBhAGsAaAAtAGEAdgAvABcEMAQzBEAEQwQ3BDoEOAQvAGMAcgBpAHQAZQByAGkAYQBfAGQAaQBjAHQAaQBvAG4AYQByAHkAIAAoADQAKQAuAHgAbABzAHgACRQAAABmADcANgA2ADYAMQBmADEANwA3ADIANgA5ADgAZgBmAGMAZgA1ADAACwQAAAAxADAANAA5APswCwAAAPr7AAQAAAAAAAAAPwIAAAAAAAAAAQsAAAACBgAAAAAEAwAAAAMgAgAABH8AAAAAKgAAAF8AeABsAG4AbQAuAF8ARgBpAGwAdABlAHIARABhAHQAYQBiAGEAcwBlAAE8AAAAJwAhBDsEPgQyBDAEQARMBCAAOgRABDgEQgQ1BEAEOAQ1BDIEJwAhACQAQQAkADEAOgAkAEYAJAAyADAAAgQAAAABAAAAAwEAAAABBIcAAAAAKgAAAF8AeABsAG4AbQAuAF8ARgBpAGwAdABlAHIARABhAHQAYQBiAGEAcwBlAAFEAAAAJwAhBDsEPgQyBDAEQARMBCAAOgRABDgEQgQ1BEAEOAQ1BDIEIAAoADIAKQAnACEAJABBACQAMQA6ACQARgAkADEANAACBAAAAAIAAAADAQAAAAEEfwAAAAAqAAAAXwB4AGwAbgBtAC4AXwBGAGkAbAB0AGUAcgBEAGEAdABhAGIAYQBzAGUAATwAAAAnACEEOwQ+BDIEMARABEwEIAA6BEAEOARCBDUEQAQ4BDUEMgQnACEAJABBACQAMQA6ACQARgAkADIAMAACBAAAAAEAAAADAQAAAAEEhwAAAAAqAAAAXwB4AGwAbgBtAC4AXwBGAGkAbAB0AGUAcgBEAGEAdABhAGIAYQBzAGUAAUQAAAAnACEEOwQ+BDIEMARABEwEIAA6BEAEOARCBDUEQAQ4BDUEMgQgACgAMgApACcAIQAkAEEAJAAxADoAJABGACQAMQA0AAIEAAAAAgAAAAMBAAAAAQ8AAAAAOgQAAAA1BAAAASkAAAAABgoAAAAbBDgEQQRCBDEAAQQBAAAAAgECAwYKAAAAQQAxADoARAA4AAJ4AAAAAxkAAAACBAEAAAADBAEAAAAFBQAAAAAAtjlABgEBAxkAAAACBAIAAAADBAIAAAAFBQAAAAAAATFABgEBAxkAAAACBAMAAAADBAMAAAAFBQAAAAAAEkNABgEBAxkAAAACBAQAAAADBAQAAAAFBQAAAAAAbDJABgEBFisAAAAXJgAAABQhAAAAAAQAAABBADEAAQQAAAAAAAAAAgoAAABBADEAOgBEADgACwoAAAABBQAAAAAAACxADjwAAAAABUfhehSuxzFAAQXMzMzMzAwzQAIFR+F6FK7HMUADBczMzMzMDDNABAV7FK5H4XoeQAUFexSuR+F6HkAPPwAAAAEBCQIBAAMBAAQEAQAAAAUBAAYBAAgEAQAAAAkEAQAAAAoEWAIAAAABAQsBAA8EZAAAABABABEBARIEWAIAABAGAAAAAAEAAQEACacCAAAjogIAACEIAACRAQAAEQAAAAAAAAAAGAEAAAAAAAAABw4AAAAAAQAAAAAAAAAAAAcOAQAAAAEAAAABAAAAAAAHDgIAAAABAAAAAgAAAAAABw4DAAAAAgAAAAMAAAAAAAARAQAAAAAAAAAYAQAAAAAAAAAFEgAAAAABAAAAAAAAAAAAIEAAAAcOAQAAAAMAAAAEAAAAAAAHDgIAAAABAAAABQAAAAAAAQoDAAAAAQAAAAAAABECAAAAAAAAABgBAAAAAAAAAAUSAAAAAAIAAAAAAAAAAAAkQAAABw4BAAAAAgAAAAYAAAAAAAcOAgAAAAQAAAAHAAAAAAABCgMAAAABAAAAAAAAEQMAAAAAAAAAGAEAAAAAAAAABRIAAAAAAgAAAAAAAAAAAC5AAAAHDgEAAAACAAAACAAAAAAABw4CAAAAAwAAAAcAAAAAAAEKAwAAAAEAAAAAAAARBAAAAAAAAAAYAQAAAAAAAAAFEgAAAAADAAAAAAAAAAAAMUAAAAcOAQAAAAIAAAAEAAAAAAAHDgIAAAACAAAACQAAAAAAAQoDAAAAAgAAAAAAABEFAAAAAAAAABgBAAAAAAAAAAUSAAAAAAMAAAAAAAAAAAAzQAAABw4BAAAAAwAAAAYAAAAAAAcOAgAAAAEAAAAKAAAAAAABCgMAAAACAAAAAAAAEQYAAAAAAAAAGAEAAAAAAAAABRIAAAAAAwAAAAAAAAAAADRAAAAHDgEAAAADAAAACAAAAAAABw4CAAAABAAAAAsAAAAAAAEKAwAAAAIAAAAAAAARBwAAAAAAAAAYAQAAAAAAAAAFEgAAAAADAAAAAAAAAAAAOkAAAAcOAQAAAAMAAAAGAAAAAAAHDgIAAAAEAAAADAAAAAAAAQoDAAAAAgAAAAAAkgEABQAAAAAHAAAAABsAAAAADAIAAAAvAAAAAyoAAABABDUEOQRCBDgEPQQzBCAAKAA+BEIEIAAxADAAIAA0BD4EIAAyADYAKQAACwAAAAMGAAAAHgQaBCEEACcAAAADIgAAABoEQAQ1BDQEOARCBD0EMARPBCAAOARBBEIEPgRABDgETwQAFwAAAAMSAAAAMgRLBDIEPgQ0BCAAIwQkBBAEABcAAAADEgAAAEEEPgQ6BEAEMARJBDAEQgRMBAAnAAAAAyIAAAA/BEAEPgRBBEAEPgRHBDoEMAQgADEAMAAgADQEPQQ1BDkEABkAAAADFAAAAD0EMARABDAESQQ4BDIEMARCBEwEAC8AAAADKgAAAD8EQAQ+BEEEQAQ+BEcEOgQwBCAAPgRCBEEEQwRCB&quot; style=&quot;color: rgb(0, 0, 0); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: transparent; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; border-collapse: collapse; font-family: Calibri; font-size: 11pt;&quot;&gt;&lt;tbody&gt;&lt;tr style=&quot;height: 14pt;&quot;&gt;&lt;/tr&gt;&lt;tr style=&quot;height: 14pt;&quot;&gt;&lt;td style=&quot;width: 135pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;рейтинг (от 10 до 26)&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 89.375pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;ОКС&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 200pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;Кредитная история&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 96.875pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;вывод УФА&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height: 14pt;&quot;&gt;&lt;td style=&quot;width: 135pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;8&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 89.375pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;сокращать&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 200pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;просрочка 10 дней&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 96.875pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height: 14pt;&quot;&gt;&lt;td style=&quot;width: 135pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;10&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 89.375pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;наращивать&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 200pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;просрочка отсутствует&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 96.875pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height: 14pt;&quot;&gt;&lt;td style=&quot;width: 135pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;15&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 89.375pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;держать&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 200pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;просрочка отсутствует&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 96.875pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height: 14pt;&quot;&gt;&lt;td style=&quot;width: 135pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;17&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 89.375pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;сокращать&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 200pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;нарушены сроки возврата кредита&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 96.875pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height: 14pt;&quot;&gt;&lt;td style=&quot;width: 135pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;19&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 89.375pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;наращивать&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 200pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;просрочка 50 дней&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 96.875pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height: 14pt;&quot;&gt;&lt;td style=&quot;width: 135pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;20&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 89.375pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;держать&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 200pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;просрочка 30 дней&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 96.875pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height: 14pt;&quot;&gt;&lt;td style=&quot;width: 135pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;26&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 89.375pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;наращивать&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 200pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;span style=&quot;vertical-align: baseline; font-family: Calibri, serif, EmojiFont;&quot;&gt;просрочка 100 дней&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width: 96.875pt; vertical-align: bottom; border-width: 1px; border-style: solid; border-color: rgb(0, 0, 0);&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br class=&quot;Apple-interchange-newline&quot;&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="40" y="760" width="560" height="240" as="geometry" />
        </mxCell>
        <mxCell id="JJz8-9tXR7XxKiCPV7C5-7" value="&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;xslData;XLSY;v2;5995;-1;-1;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&quot; style=&quot;border-collapse: collapse;font-family:Calibri;font-size:11pt;color:#000;background-color:transparent;&quot;&gt;&lt;tbody&gt;&lt;tr style=&quot;height:15.43pt&quot;&gt;&lt;td style=&quot;width:820.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-family:PT Sans;font-weight:bold;vertical-align:baseline;&quot;&gt;Финансовое состояние&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:240.43pt&quot;&gt;&lt;td style=&quot;width:820.7142857142857pt;white-space:normal;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;Автовывод: Финансовое состояние, рассчитанное моделью &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Неудовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Результативность (операционные результаты)&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Удовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Снижение выручки LTM по сравнению с АППГ (5.8)%.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Выручка за квартал относительно предыдущего снижается 2 квартала подряд ((18.6)% и (7.2)%), аналогично АППГ.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Выручка за квартал относительно АППГ снижается 2 квартала подряд ((6.3)% и (8)%).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Рентабельность EBITDA LTM составила 5.5%.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Чистая прибыль 8 165 тыс. руб.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Качество активов и управление ими&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Хорошее&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;КТЛ 3.36, выше порогового значения 1.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость ДЗ LTM 36 дней - соответствует оборачиваемости большинства компаний данного ОКК (44 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость КЗ LTM 48 дней - соответствует оборачиваемости большинства компаний данного ОКК (71 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость запасов LTM 118 дней - соответствует оборачиваемости большинства компаний данного ОКК (171 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Возможность исполнения обязательств&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Неудовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Долг(за искл. субор. займов)/EBITDA LTM 3.93, выше порогового значения 3.5 для данного ОКК.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;ICR LTM 2.73 - выше порогового значения 1.5.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Доля ЧА в структуре баланса 31.8% (&amp;gt;=20%).&lt;br&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="100" y="1160" width="560" height="430" as="geometry" />
        </mxCell>
        <mxCell id="JJz8-9tXR7XxKiCPV7C5-8" value="&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;xslData;XLSY;v2;5851;-1;-1;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&quot; style=&quot;border-collapse: collapse;font-family:Calibri;font-size:11pt;color:#000;background-color:transparent;&quot;&gt;&lt;tbody&gt;&lt;tr style=&quot;height:15.43pt&quot;&gt;&lt;td style=&quot;width:820.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-family:PT Sans;font-weight:bold;vertical-align:baseline;&quot;&gt;Финансовое состояние&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:226.29pt&quot;&gt;&lt;td style=&quot;width:820.7142857142857pt;white-space:normal;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;Автовывод: Финансовое состояние, рассчитанное моделью &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Неудовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Результативность (операционные результаты)&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Неудовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Снижение выручки LTM по сравнению с АППГ (31.9)%.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Выручка за квартал снижается в течение 2х кварталов подряд: относительно прошлого периода ((5.5)% и (27.5)%) и АППГ ((57.1)% и (37.6)%).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Рентабельность EBITDA LTM составила 6.3%.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Чистая прибыль 39 725 тыс. руб.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Качество активов и управление ими&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Удовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;КТЛ 3.04, выше порогового значения 1.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость ДЗ LTM 75 дней - соответствует оборачиваемости большинства компаний данного ОКК (87 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость КЗ LTM 83 дней - соответствует оборачиваемости большинства компаний данного ОКК (92 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость запасов LTM 135 дней - выше оборачиваемости большинства компаний данного ОКК (89 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Возможность исполнения обязательств&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Неудовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Долг(за искл. субор. займов)/EBITDA LTM 3.88, соответствует диапазону от 3.5 до 4 для данного ОКК.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;ICR LTM 1.48 - ниже порогового значения 1.5.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Доля ЧА в структуре баланса 29.6% (&amp;gt;=20%).&lt;br&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="90" y="1590" width="560" height="400" as="geometry" />
        </mxCell>
        <mxCell id="JJz8-9tXR7XxKiCPV7C5-9" value="&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;xslData;XLSY;v2;5791;-1;-1;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&quot; style=&quot;border-collapse: collapse;font-family:Calibri;font-size:11pt;color:#000;background-color:transparent;&quot;&gt;&lt;tbody&gt;&lt;tr style=&quot;height:15.43pt&quot;&gt;&lt;td style=&quot;width:820.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-family:PT Sans;font-weight:bold;vertical-align:baseline;&quot;&gt;Финансовое состояние&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:226.29pt&quot;&gt;&lt;td style=&quot;width:820.7142857142857pt;white-space:normal;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;Автовывод: Финансовое состояние, рассчитанное моделью &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Удовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Результативность (операционные результаты)&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Хорошее&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Увеличение выручки LTM по сравнению с АППГ 10.3%.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Выручка за квартал увеличивается хотя бы в одном из 2х кварталов подряд: относительно прошлого периода ((15.6)% и 24.4%) и АППГ (39.4% и 6.8%).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Рентабельность EBITDA LTM составила 4.5%.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Чистая прибыль 23 354 тыс. руб.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Качество активов и управление ими&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Удовлетворительное&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;КТЛ 5.22, выше порогового значения 1.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость ДЗ LTM 9 дней - соответствует оборачиваемости большинства компаний данного ОКК (63 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость КЗ LTM 5 дней - соответствует оборачиваемости большинства компаний данного ОКК (48 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Оборачиваемость запасов LTM 107 дней - выше оборачиваемости большинства компаний данного ОКК (59 дней).&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;text-decoration:underline;vertical-align:baseline;&quot;&gt;Возможность исполнения обязательств&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;font-family:PT Sans;font-size:9pt;font-weight:bold;vertical-align:baseline;&quot;&gt;- Хорошее&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Долг(за искл. субор. займов)/EBITDA LTM 3.39, ниже порогового значения 3.5 для данного ОКК.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;ICR LTM 2.94 - выше порогового значения 1.5.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Доля ЧА в структуре баланса 57.8% (&amp;gt;=20%).&lt;br&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="190" y="2040" width="560" height="400" as="geometry" />
        </mxCell>
        <mxCell id="JJz8-9tXR7XxKiCPV7C5-10" value="&lt;p&gt;1.Отстутствуют случаи возникновения просроченной задолженности 5 р.д. и выше в течение 180 дней до даты оценки&lt;/p&gt;&lt;p&gt;Примеры: отсутствуют случаи нарушения сроков возврата кредита, наличия текущей просрочки от 1 дня (у нас в банке этот есть в АС КЮЛ).&lt;/p&gt;&lt;p&gt;3. заемщик имеет положительную кредитную историю&lt;/p&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="180" y="2510" width="540" height="140" as="geometry" />
        </mxCell>
        <mxCell id="JJz8-9tXR7XxKiCPV7C5-11" value="&lt;p&gt;если у модели итоговый вывод по уровню риска: &quot;риск высокий (приемлемый)&quot;, &quot;риск средний&quot;, &quot;риск низкий&quot;, он же Вывод﻿, то хорошо.&lt;/p&gt;&lt;p&gt;Если у модели риск &quot;высокий (неприемлемый)&quot; он же Вывод 2 ,то плохо&lt;/p&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="180" y="2650" width="560" height="100" as="geometry" />
        </mxCell>
        <mxCell id="JJz8-9tXR7XxKiCPV7C5-12" value="&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;color: rgb(33, 202, 154);&quot;&gt; Вывод №1&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;color: rgb(33, 202, 154);&quot;&gt;«Модель ДДС утверждена. Заложенные в модель структура денежных потоков и используемые предпосылки построения модели ДДС позволяют сделать вывод о возможности Контрагента исполнять свои обязательства»:&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;color: rgb(33, 202, 154);&quot;&gt; риск высокий (приемлемый), риск средний, риск низкий﻿.&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;color: rgb(33, 202, 154);&quot;&gt;﻿&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;﻿&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(255, 113, 83);&quot;&gt;﻿Вывод №2&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(255, 113, 83);&quot;&gt;«Модель ДДС утверждена, однако заложенная в модель структура денежных потоков и используемые предпосылки построения модели ДДС позволяют сделать вывод о невозможности Контрагента исполнять свои обязательства»: риск высокий (неприемлемый). &lt;/span&gt;&lt;/p&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="300" y="2820" width="560" height="280" as="geometry" />
        </mxCell>
        <UserObject label="You are CreditDecisionAgent, a specialized AI agent for automated credit decisioning in a large bank. &#xa;You must perform two phases:&#xa;&#xa;&#xa;1. **Detailed criterion-by-criterion analysis** (Custom Chain of Thought).&#xa;2. **Return the final decision** in strict JSON format (Structured Output).&#xa;&#xa;&#xa;------&#xa;&#xa;&#xa;### ������ INPUT BLOCKS (the LLM receives exactly these 4 textual blocks, verbatim)&#xa;&#xa;&#xa;#### 1. АС УФА:&#xa;{ufa_block}&#xa;&#xa;&#xa;#### 2. Рейтинг:&#xa;{rating_block}&#xa;&#xa;&#xa;#### 3. ОКС:&#xa;{oks_block}&#xa;&#xa;&#xa;#### 4. Cashflow:&#xa;{cf_block}&#xa;&#xa;&#xa;#### 5. Кредитная история:&#xa;{history_block}&#xa;&#xa;&#xa;------&#xa;&#xa;&#xa;### ⚙️ MODULE 1: Analysis Schema&#xa;&#xa;&#xa;Each criterion must be evaluated with:&#xa;- `name`&#xa;- `value`&#xa;- `status`: &quot;ХОРОШО&quot; | &quot;ПЛОХО&quot;&#xa;- `comment`&#xa;- `weight` (default 1 unless specified)&#xa;&#xa;&#xa;Available criteria:&#xa;- Динамика бизнеса (выручка LTM, EBITDA LTM, квартальный рост)&#xa;- Оборачиваемость запасов, ДЗ, КЗ LTM&#xa;- Уровень долговой нагрузки (debt/EBITDA, ICR)&#xa;- Текущая ликвидность (КТЛ)&#xa;- Рентабельность (чистая прибыль, EBITDA-margin)&#xa;- Доля чистых активов&#xa;- Рейтинг&#xa;- Собственный оборотный капитал&#xa;- Соответствие ОКС&#xa;- Вывод модели CF (Вывод №1 vs №2)&#xa;- Кредитная история (наличие просрочек)&#xa;&#xa;&#xa;------&#xa;&#xa;&#xa;### ������ MODULE 2: Custom Chain of Thought&#xa;&#xa;&#xa;You must analyze **each criterion step-by-step**, with this structure:&#xa;&#xa;&#xa;For criterion **[NAME]**:&#xa;1. explanation: &quot;Проверяем [NAME]: значение = X, порог = Y&quot;&#xa;2. determine status: &quot;ХОРОШО&quot; or &quot;ПЛОХО&#xa;3. comment: короткое объяснение&#xa;4. record weight: default 1 (or overridden)&#xa;&#xa;&#xa;Proceed through all criteria. After each, retain reasoning in the response.&#xa;&#xa;&#xa;------&#xa;&#xa;&#xa;### ������ MODULE 3: Aggregation Rule&#xa;&#xa;&#xa;After evaluating all criteria:&#xa;- If **any** criterion.status == &quot;ПЛОХО&quot; → final_decision = &quot;ОТКАЗ&quot;&#xa;- Else → final_decision = &quot;ОДОБРЕНО&quot;&#xa;&#xa;&#xa;final_comment must list **all плохие критерии** (if отказ) или общий позитивный вывод.&#xa;&#xa;&#xa;------&#xa;&#xa;&#xa;### ������ MODULE 4: JSON Structured Output&#xa;&#xa;&#xa;Return *only* the following JSON (no extra text outside it):&#xa;&#xa;&#xa;```json&#xa;{&#xa;  &quot;criteria&quot;: [&#xa;    {&quot;name&quot;: &quot;...&quot;, &quot;value&quot;: &quot;...&quot;, &quot;status&quot;: &quot;ХОРОШО/ПЛОХО&quot;, &quot;comment&quot;: &quot;...&quot;, &quot;weight&quot;: 1},&#xa;    ... (one entry per criterion)&#xa;  ],&#xa;  &quot;final_decision&quot;: &quot;ОДОБРЕНО/ОТКАЗ&quot;,&#xa;  &quot;final_comment&quot;: &quot;...&quot;&#xa;}" link="You are CreditDecisionAgent, a specialized AI agent for automated credit decisioning in a large bank. &#xa;You must perform two phases:&#xa;&#xa;&#xa;1. **Detailed criterion-by-criterion analysis** (Custom Chain of Thought).&#xa;2. **Return the final decision** in strict JSON format (Structured Output).&#xa;&#xa;&#xa;------&#xa;&#xa;&#xa;### ������ INPUT BLOCKS (the LLM receives exactly these 4 textual blocks, verbatim)&#xa;&#xa;&#xa;#### 1. АС УФА:&#xa;{ufa_block}&#xa;&#xa;&#xa;#### 2. Рейтинг:&#xa;{rating_block}&#xa;&#xa;&#xa;#### 3. ОКС:&#xa;{oks_block}&#xa;&#xa;&#xa;#### 4. Cashflow:&#xa;{cf_block}&#xa;&#xa;&#xa;#### 5. Кредитная история:&#xa;{history_block}&#xa;&#xa;&#xa;------&#xa;&#xa;&#xa;### ⚙️ MODULE 1: Analysis Schema&#xa;&#xa;&#xa;Each criterion must be evaluated with:&#xa;- `name`&#xa;- `value`&#xa;- `status`: &quot;ХОРОШО&quot; | &quot;ПЛОХО&quot;&#xa;- `comment`&#xa;- `weight` (default 1 unless specified)&#xa;&#xa;&#xa;Available criteria:&#xa;- Динамика бизнеса (выручка LTM, EBITDA LTM, квартальный рост)&#xa;- Оборачиваемость запасов, ДЗ, КЗ LTM&#xa;- Уровень долговой нагрузки (debt/EBITDA, ICR)&#xa;- Текущая ликвидность (КТЛ)&#xa;- Рентабельность (чистая прибыль, EBITDA-margin)&#xa;- Доля чистых активов&#xa;- Рейтинг&#xa;- Собственный оборотный капитал&#xa;- Соответствие ОКС&#xa;- Вывод модели CF (Вывод №1 vs №2)&#xa;- Кредитная история (наличие просрочек)&#xa;&#xa;&#xa;------&#xa;&#xa;&#xa;### ������ MODULE 2: Custom Chain of Thought&#xa;&#xa;&#xa;You must analyze **each criterion step-by-step**, with this structure:&#xa;&#xa;&#xa;For criterion **[NAME]**:&#xa;1. explanation: &quot;Проверяем [NAME]: значение = X, порог = Y&quot;&#xa;2. determine status: &quot;ХОРОШО&quot; or &quot;ПЛОХО&#xa;3. comment: короткое объяснение&#xa;4. record weight: default 1 (or overridden)&#xa;&#xa;&#xa;Proceed through all criteria. After each, retain reasoning in the response.&#xa;&#xa;&#xa;------&#xa;&#xa;&#xa;### ������ MODULE 3: Aggregation Rule&#xa;&#xa;&#xa;After evaluating all criteria:&#xa;- If **any** criterion.status == &quot;ПЛОХО&quot; → final_decision = &quot;ОТКАЗ&quot;&#xa;- Else → final_decision = &quot;ОДОБРЕНО&quot;&#xa;&#xa;&#xa;final_comment must list **all плохие критерии** (if отказ) или общий позитивный вывод.&#xa;&#xa;&#xa;------&#xa;&#xa;&#xa;### ������ MODULE 4: JSON Structured Output&#xa;&#xa;&#xa;Return *only* the following JSON (no extra text outside it):&#xa;&#xa;&#xa;```json&#xa;{&#xa;  &quot;criteria&quot;: [&#xa;    {&quot;name&quot;: &quot;...&quot;, &quot;value&quot;: &quot;...&quot;, &quot;status&quot;: &quot;ХОРОШО/ПЛОХО&quot;, &quot;comment&quot;: &quot;...&quot;, &quot;weight&quot;: 1},&#xa;    ... (one entry per criterion)&#xa;  ],&#xa;  &quot;final_decision&quot;: &quot;ОДОБРЕНО/ОТКАЗ&quot;,&#xa;  &quot;final_comment&quot;: &quot;...&quot;&#xa;}" id="DvTzBklmQQ-uR9xNobqU-1">
          <mxCell style="text;whiteSpace=wrap;" parent="1" vertex="1">
            <mxGeometry x="200" y="3230" width="560" height="1660" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="CF2Xue_zBJq6MxR_8Y5s-1" value="&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;xslData;XLSY;v2;6012;-1;-1;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BDgENQQgAD8EPgQ6BDAENwQwBEIENQQ7BE8EIAA0BD4EOwQzBD4EMgQ+BDkEIAA9BDAEMwRABEMENwQ6BDgEAPMIAAAD7ggAAB8EQAQ1BDIESwRIBDUEPQQ4BDUEIAAyBCAAPgRCBD0EPgRIBDUEPQQ4BDgEIABDBEcEMARBBEIEPQQ4BDoEPgQyBCAAEwRABEMEPwQ/BEsELAAgAEMEOgQwBDcEMAQ9BD0EPgQ5BCAAMgQgAB8ENQRABDUERwQ9BDUEIAAxACAAHwRABDgEOwQ+BDYENQQ9BDgETwQgAKsAIQQ+BEEEQgQwBDIEIAATBEAEQwQ/BD8ESwS7ACAAOgQgABQEPgQzBD4EMgQ+BEAEQwQsACAAQQQ+BD4EQgQ9BD4ESAQ1BD0EOARPBCAAPwQ+BDoEMAQ3BDAEQgQ1BDsENQQ5BCAAFAQ+BDsEMwQvAEUAQgBJAFQARABBACwAIABDBEEEQgQwBD0EMAQyBDsEOAQyBDAENQQ8BD4EMwQ+BCAAPQQwBCAAOgQwBDYENARDBE4EIAA+BEIERwQ1BEIEPQRDBE4EIAA0BDAEQgRDBCAAKAA/BD4EIAAgBCEEEQQjBCkALAAgAEMEQAQ+BDIEPQRPBDoACgBBBCAAMQQ7BDgENgQwBDkESAQ1BDkEIAA+BEIERwQ1BEIEPQQ+BDkEIAA0BDAEQgRLBCAAKAA/BD4EIAAgBCEEEQQjBCkALAAgAEEEOwQ1BDQEQwROBEkENQQ5BCAANwQwBCAANAQwBEIEPgQ5BCAANwQwBDoEOwROBEcENQQ9BDgETwQgABQEPgQzBD4EMgQ+BEAEMAQsACAAEyAgADEEPgQ7BDUENQQgADMALAA1ACAAKAAiBEAENQRFBCAARgQ1BDsESwRFBCAAPwRPBEIEOAQgADQENQRBBE8EQgRLBEUEKQAgACgAMgQ6BDsETgRHBDgEQgQ1BDsETAQ9BD4EKQA7AAoAOAQ7BDgEIABBBD0EOAQ2BDUEPQQ4BDUEIABBBD4EPgRCBD0EPgRIBDUEPQQ4BE8EIAA/BD4EOgQwBDcEMARCBDUEOwQ1BDkEIAAUBD4EOwQzBC8ARQBCAEkAVABEAEEAIAA0BD4EIAA+BEIEQAQ4BEYEMARCBDUEOwRMBD0EPgQzBD4EIAA3BD0EMARHBDUEPQQ4BE8ELgAKABIEIABABDAEQQRHBDUEQgQgABQEPgQ7BDMEMAQgADIEOgQ7BE4ERwQwBE4EQgRBBE8EIAAwBDMENQQ9BEIEQQQ6BDgEOQQgAEQEMAQ6BEIEPgRABDgEPQQzBC4ACgASBCAAQAQwBEEERwQ1BEIEIAAUBD4EOwQzBDAEIAA9BDUEIAAyBDoEOwROBEcEMAROBEIEQQRPBCAAPwRABDUENAQ+BEEEQgQwBDIEOwQ1BD0EPQRLBDUEIABDBEcEMARBBEIEPQQ4BDoEQwQoADAEPAQpACAAEwRABEMEPwQ/BEsELAAgAEMEOgQwBDcEMAQ9BD0EPgQ5BCAAMgQgAB8ENQRABDUERwQ9BDUEIAAxACAAHwRABDgEOwQ+BDYENQQ9BDgETwQgAKsAIQQ+BEEEQgQwBDIEIAATBEAEQwQ/BD8ESwS7ACAAOgQgABQEPgQzBD4EMgQ+BEAEQwQsACAANwQwBDkEPARLBCwAIAA6BEAENQQ0BDgEQgRLBCAAOAQgADgEPQRLBDUEIAA0BDUEPQQ1BDYEPQRLBDUEIAA+BDEETwQ3BDAEQgQ1BDsETARBBEIEMgQwBCwAIABBBEMEMQQ+BEAENAQ4BD0EOARABD4EMgQwBD0EPQRLBDUEIABBBDsENQQ0BEMETgRJBDgEPAQoADgEPAQ4BCkAIABBBD8EPgRBBD4EMQQ+BDwEKAAwBDwEOAQpADoACgAxACkAIAA3BDAEOQQ8BEsELAAgADoEPgQ9BDIENQRABEIEOARABD4EMgQwBD0EPQRLBDUEIAAyBCAAMgQ1BDoEQQQ1BDsETwQgACgAPwRDBEIENQQ8BCAAMgRLBD8EQwRBBDoEMAQgAD8EQAQ+BEEEQgRLBEUEIAAyBDUEOgRBBDUEOwQ1BDkELAAgAD8EMARABDAEPAQ1BEIEQARLBCAAOgQ+BEIEPgRABEsERQQgAEEEPgQzBDsEMARBBD4EMgQwBD0ESwQgAEEEIAARBDAEPQQ6BD4EPAQpACwAIAA4BCAAPgREBD4EQAQ8BDsENQQ9BDgENQQgADcEMAQ7BD4EMwQwBCAANAQwBD0EPQRLBEUEIAAyBDUEOgRBBDUEOwQ1BDkEIAAyBCAAPwQ+BDsETAQ3BEMEIAARBDAEPQQ6BDAEIABBBCAAPwQ1BEAENQQ0BDAERwQ1BDkEIAARBDAEPQQ6BEMELgAKADIAKQAgADQENQQ9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&quot; style=&quot;border-collapse: collapse;font-family:Calibri;font-size:11pt;color:#000;background-color:transparent;&quot;&gt;&lt;tbody&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;text-align:center;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;Код&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;text-align:center;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;Краткое наименование&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;text-align:center;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;Полное наименование&lt;/span&gt;&lt;/td&gt;&lt;td colspan=&quot;4&quot; rowspan=&quot;1&quot; style=&quot;width:493.57142857142844pt;white-space:nowrap;text-align:center;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;Ответ LLM&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;text-align:center;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;codeForPrint&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;text-align:center;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;name&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;text-align:center;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;text&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:center;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;Сокращенное&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;Знак&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;text-align:center;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;Значение&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:86.42857142857142pt;white-space:nowrap;text-align:center;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;font-weight:bold;vertical-align:baseline;&quot;&gt;Ед изм/валюта&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:311.15pt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V1&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:normal;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении участников Группы, указанной в Перечне 1 Приложения «Состав Группы» к Договору, соотношения показателей Долг/EBITDA, устанавливаемого на каждую отчетную дату (по РСБУ), уровня:&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, – более 3,5 (Трех целых пяти десятых) (включительно);&lt;br&gt;или снижение соотношения показателей Долг/EBITDA до отрицательного значения.&lt;br&gt;В расчет Долга включаются агентский факторинг.&lt;br&gt;В расчет Долга не включаются предоставленные участнику(ам) Группы, указанной в Перечне 1 Приложения «Состав Группы» к Договору, займы, кредиты и иные денежные обязательства, субординированные следующим(ими) способом(ами):&lt;br&gt;1) займы, конвертированные в векселя (путем выпуска простых векселей, параметры которых согласованы с Банком), и оформление залога данных векселей в пользу Банка с передачей Банку.&lt;br&gt;2) денежные обязательства участников Группы, в отношении которых между соответствующим участником Группы, Банком и другими кредиторами заключено(ы) соглашение(ия) кредиторов о порядке удовлетворения их требований к соответствующему участнику Группы на условиях, согласованных с Банком.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Долг / EBITDA по ГК&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;3,5&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:86.42857142857142pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="90" y="4950" width="560" height="1310" as="geometry" />
        </mxCell>
        <mxCell id="CF2Xue_zBJq6MxR_8Y5s-2" value="&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;xslData;XLSY;v2;4583;-1;-1;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ABMgIAAxBD4EOwQ1BDUEIAA0ACwANQAgACgAJwQ1BEIESwRABDUERQQgAEYENQQ7BEsERQQgAD8ETwRCBDgEIAA0BDUEQQRPBEIESwRFBCkAIAAoADIEOgQ7BE4ERwQ4BEIENQQ7BEwEPQQ+BCkAOwAKADgEOwQ4BCAAQQQ9BDgENgQ1BD0EOAQ1BCAAQQQ+BD4EQgQ9BD4ESAQ1BD0EOARPBCAAPwQ+BDoEMAQ3BDAEQgQ1BDsENQQ5BCAAFAQ+BDsEMwQvAEUAQgBJAFQARABBACAANAQ+BCAAPgRCBEAEOARGBDAEQgQ1BDsETAQ9BD4EMwQ+BCAANwQ9BDAERwQ1BD0EOARPBC4ACgASBCAAQAQwBEEERwQ1BEIEIAAUBD4EOwQzBDAEIAA9BDUEIAAyBDoEOwROBEcEMAROBEIEQQRPBCAAPgQxBE8ENwQwBEIENQQ7BEwEQQRCBDIEMAQgAD8ENQRABDUENAQgAEEEOwQ1BDQEQwROBEkEOAQ8BDgEIAA7BDgERgQwBDwEOAQ6ACAAKAQYBBQEHgQSBCAAFwQQBCMEIAQgABwEIwQlBBAEHAQVBBQEHgQSBBgEJwQuAAAfAAAAAxoAAAAUBD4EOwQzBCAALwAgAEUAQgBJAFQARABBAAAJAAAAAwQAAAA8AD0AAH8CAAADegIAAB8EQAQ1BDIESwRIBDUEPQQ4BDUEIAAyBCAAPgRCBD0EPgRIBDUEPQQ4BDgEIAAaBDsEOAQ1BD0EQgQwBCAAQQQ+BD4EQgQ9BD4ESAQ1BD0EOARPBCAAPwQ+BDoEMAQ3BDAEQgQ1BDsENQQ5BCAAFAQ+BDsEMwQvAEUAQgBJAFQARABBACwAIABDBEEEQgQwBD0EMAQyBDsEOAQyBDAENQQ8BD4EMwQ+BCAAPQQwBCAAOgQwBDYENARDBE4EIAA+BEIERwQ1BEIEPQRDBE4EIAA0BDAEQgRDBCAAKAA/BD4EIAAgBCEEEQQjBCkALAAgAEMEQAQ+BDIEPQRPBDoACgBBBCAAMQQ7BDgENgQwBDkESAQ1BDkEIAA+BEIERwQ1BEIEPQQ+BDkEIAA0BDAEQgRLBCAAKAA/BD4EIAAgBCEEEQQjBCkALAAgAEEEOwQ1BDQEQwROBEkENQQ5BCAANwQwBCAANAQwBEIEPgQ5BCAANwQwBDoEOwROBEcENQQ9BDgETwQgABQEPgQzBD4EMgQ+BEAEMAQsACAAEyAgADEEPgQ7BDUENQQgADQAIAAoACcENQRCBEsEQAQ1BEUEKQAgACgAMgQ6BDsETgRHBDgEQgQ1BDsETAQ9BD4EKQA7AAoAOAQ7BDgEIABBBD0EOAQ2BDUEPQQ4BDUEIABBBD4EPgRCBD0EPgRIBDUEPQQ4BE8EIAA/BD4EOgQwBDcEMARCBDUEOwQ1BDkEIAAUBD4EOwQzBC8ARQBCAEkAVABEAEEAIAA0BD4EIAA+BEIEQAQ4BEYEMARCBDUEOwRMBD0EPgQzBD4EIAA3BD0EMARHBDUEPQQ4BE8ELgDeAgAAAC0AAAABKAAAAAADAAAAAQEKAQMAAAABAQoCAwAAAAEBCgQDAAAAAQEKBQMAAAABAQoEIAAAAAULAAAAAAYAAAACAQAAABEFCwAAAAAGAAAAAgEAAAAIBnsAAAAHKgAAAAEGAwAAAAIBAQQGDgAAAEMAYQBsAGkAYgByAGkACQEBBgUAAAAAAAAmQAdHAAAAAQYDAAAAAgEBBAYuAAAAVgBhAHIAKAAtAC0AdAB5AHAAbwAtAGYAbwBuAHQALQBmAGEAbQBpAGwAeQApAAYFAAAAAAAAJkAOKQAAAAMkAAAAAQEBBgQAAAAAAgEBBwQAAAAAAwEBCAQAAAAABAEBCQQAAAAAAhEBAAADHgAAAAYEAAAAAAcEAAAAAAgEAAAAAAkEAAAAAAwEAAAAAAMeAAAABgQAAAAABwQAAAAACAQAAAAACQQAAAAADAQAAAAAAy0AAAAGBAAAAAAHBAAAAAAIBAAAAAAJBAAAAAAAAQENBgYAAAAAAQAHAQQMBAAAAAADKgAAAAYEAAAAAAcEAAAAAAgEAAAAAAkEAAAAAAABAQ0GAwAAAAgBAQwEAAAAAAMwAAAABgQAAAAABwQAAAAAAwEBCAQBAAAACQQAAAAAAAEBDQYGAAAAAAEGBwEBDAQAAAAAAzAAAAAGBAAAAAAHBAAAAAADAQEIBAEAAAAJBAAAAAAAAQENBgYAAAAAAQAHAQQMBAAAAAAPKgAAABAlAAAAAAQAAAAAAAAABA4AAAAeBDEESwRHBD0ESwQ5BAUEAAAAAAAAAAxOAAAAACIAAABUAGEAYgBsAGUAUwB0AHkAbABlAE0AZQBkAGkAdQBtADIAASIAAABQAGkAdgBvAHQAUwB0AHkAbABlAEwAaQBnAGgAdAAxADYAETcAAAAAMgAAAPoAEQAAAFMAbABpAGMAZQByAFMAdAB5AGwAZQBMAGkAZwBoAHQAMQD7AAQAAAAAAAAACAAAAAA=&quot; style=&quot;border-collapse: collapse;font-family:Calibri;font-size:11pt;color:#000;background-color:transparent;&quot;&gt;&lt;tbody&gt;&lt;tr style=&quot;height:141.43pt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V1&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:normal;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении Клиента соотношения показателей Долг/EBITDA, устанавливаемого на каждую отчетную дату (по РСБУ), уровня:&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, – более 4,5 (Четырех целых пяти десятых) (включительно);&lt;br&gt;или снижение соотношения показателей Долг/EBITDA до отрицательного значения.&lt;br&gt;В расчет Долга не включаются обязательства перед следующими лицами: ШИДОВ ЗАУР МУХАМЕДОВИЧ.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Долг / EBITDA&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;4,5&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V1&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении Клиента соотношения показателей Долг/EBITDA, устанавливаемого на каждую отчетную дату (по РСБУ), уровня:&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, – более 4 (Четырех) (включительно);&lt;br&gt;или снижение соотношения показателей Долг/EBITDA до отрицательного значения.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Долг / EBITDA&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;4&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="120" y="6270" width="560" height="260" as="geometry" />
        </mxCell>
        <mxCell id="CF2Xue_zBJq6MxR_8Y5s-3" value="&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;xslData;XLSY;v2;13232;-1;-1;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eh5ABQV7FK5H4XoeQA8/AAAAAQEJAgEAAwEABAQBAAAABQEABgEACAQBAAAACQQBAAAACgRYAgAAAAEBCwEADwRkAAAAEAEAEQEBEgRYAgAAEAYAAAAAAQABAQAJ+QQAACP0BAAAcgcAAJEBAAARBQAAAAAAAAAAAAAAAAAAAAAHDgAAAAABAAAAAAAAAAAABw4BAAAAAAAAAAEAAAAAAAcOAgAAAAAAAAACAAAAAAAHDgMAAAADAAAAAwAAAAAABw4EAAAABAAAAAQAAAAAAAUSBQAAAAEAAAAAAAAAAAAQQAAAABEGAAAAAAAAAAAAAAAAAAAAAAcOAAAAAAEAAAAAAAAAAAAHDgEAAAAAAAAAAQAAAAAABw4CAAAAAAAAAAUAAAAAAAcOAwAAAAMAAAAGAAAAAAAHDgQAAAAEAAAABAAAAAAABRIFAAAAAQAAAAAAAAAAAARAAAAAEQcAAAAAAAAAAAAAAAAAAAAABw4AAAAAAQAAAAAAAAAAAAcOAQAAAAAAAAABAAAAAAAHDgIAAAAAAAAABwAAAAAABw4DAAAAAwAAAAYAAAAAAAcOBAAAAAQAAAAEAAAAAAAFEgUAAAABAAAAAAAAAAAACEAAAAARCAAAAAAAAAAAAAAAAAAAAAAHDgAAAAABAAAACAAAAAAABw4BAAAAAQAAAAEAAAAAAAcOAgAAAAEAAAAJAAAAAAAHDgMAAAADAAAACgAAAAAABw4EAAAABAAAAAQAAAAAAAUSBQAAAAEAAAAAAAAAAAAUQAAAAQoGAAAAAwAAAAAAABEJAAAAAAAAAAAAAAAAAAAAAAcOAAAAAAEAAAAIAAAAAAAHDgEAAAABAAAAAQAAAAAABw4CAAAAAQAAAAsAAAAAAAcOAwAAAAMAAAAMAAAAAAAHDgQAAAAEAAAABAAAAAAABRIFAAAAAQAAAAAAAAAAABRAAAABCgYAAAADAAAAAAAAEQoAAAAAAAAAAAAAAAAAAAAABw4AAAAAAQAAAAgAAAAAAAcOAQAAAAEAAAABAAAAAAAHDgIAAAABAAAADQAAAAAABw4DAAAAAwAAAAoAAAAAAAcOBAAAAAQAAAAEAAAAAAAFEgUAAAABAAAAAAAAAAAAEEAAAAARCwAAAAAAAAAAAAAAAAAAAAAHDgAAAAABAAAADgAAAAAABw4BAAAAAQAAAAEAAAAAAAcOAgAAAAEAAAAPAAAAAAAHDgMAAAADAAAAEAAAAAAABw4EAAAABAAAAAQAAAAAAAUSBQAAAAEAAACamZmZmZnZPwAAAQoGAAAAAwAAAAAAABEMAAAAAAAAAAAAAAAAAAAAAAcOAAAAAAEAAAAOAAAAAAAHDgEAAAAAAAAAAQAAAAAABw4CAAAAAQAAABEAAAAAAAcOAwAAAAMAAAAQAAAAAAAHDgQAAAAEAAAABAAAAAAABRIFAAAAAQAAAAAAAAAAANA/AAAAEQ0AAAAAAAAAAAAAAAAAAAAABw4AAAAAAQAAABIAAAAAAAcOAQAAAAEAAAATAAAAAAAHDgIAAAABAAAAFAAAAAAABw4DAAAAAwAAABMAAAAAAAcOBAAAAAQAAAAVAAAAAAAFEgUAAAAFAAAAAAAAANASY0EAAAcOBgAAAAMAAAAWAAAAAAAAEQ4AAAAAAAAAAAAAAAAAAAAABw4AAAAAAQAAABcAAAAAAAcOAQAAAAEAAAATAAAAAAAHDgIAAAABAAAAGAAAAAAABw4DAAAAAwAAABMAAAAAAAcOBAAAAAQAAAAVAAAAAAAFEgUAAAAFAAAAAAAAANASY0EAAAcOBgAAAAMAAAAWAAAAAACSAQAFAAAAAAcAAAAAGwAAAABQJAAAABcAAAADEgAAAFMARgBfADEALgAxAF8AVgAxAABTAAAAA04AAAAhBD4EMQQ7BE4ENAQ1BD0EOAQ1BCAAPwQ+BDoEMAQ3BDAEQgQ1BDsETwQgADQEPgQ7BDMEPgQyBD4EOQQgAD0EMAQzBEAEQwQ3BDoEOAQADwMAAAMKAwAAHwRABDUEMgRLBEgENQQ9BDgENQQgADIEIAA+BEIEPQQ+BEgENQQ9BDgEOAQgAEMERwQwBEEEQgQ9BDgEOgQ+BDIEIAATBEAEQwQ/BD8ESwQsACAAQwQ6BDAENwQwBD0EPQQ+BDkEIAAyBCAAHwQ1BEAENQRHBD0ENQQgADEAIAAfBEAEOAQ7BD4ENgQ1BD0EOARPBCAAqwAhBD4EQQRCBDAEMgQgABMEQARDBD8EPwRLBLsAIAA6BCAAFAQ+BDMEPgQyBD4EQARDBCwAIABBBD4EPgRCBD0EPgRIBDUEPQQ4BE8EIAA/BD4EOgQwBDcEMARCBDUEOwQ1BDkEIAAUBD4EOwQzBC8ARQBCAEkAVABEAEEALAAgAEMEQQRCBDAEPQQwBDIEOwQ4BDIEMAQ1BDwEPgQzBD4EIAA9BDAEIAA6BDAENgQ0BEMETgQgAD4EQgRHBDUEQgQ9BEMETgQgADQEMARCBEMEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQwRABD4EMgQ9BE8EOgAKAEEEIAAxBDsEOAQ2BDAEOQRIBDUEOQQgAD4EQgRHBDUEQgQ9BD4EOQQgADQEMARCBEsEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQQQ7BDUENARDBE4ESQQ1BDkEIAA3BDAEIAA0BDAEQgQ+BDkEIAA3BDAEOgQ7BE4ERwQ1BD0EOARPBCAAFAQ+BDMEPgQyBD4EQAQwBCwAIAATICAAMQQ+BDsENQQ1BCAANAAgACgAJwQ1BEIESwRABDUERQQpACAAKAAyBDoEOwROBEcEOARCBDUEOwRMBD0EPgQpADsACgA4BDsEOAQgAEEEPQQ4BDYENQQ9BDgENQQgAEEEPgQ+BEIEPQQ+BEgENQQ9BDgETwQgAD8EPgQ6BDAENwQwBEIENQQ7BDUEOQQgABQEPgQ7BDMELwBFAEIASQBUAEQAQQAgADQEPgQgAD4EQgRABDgERgQwBEIENQQ7BEwEPQQ+BDMEPgQgADcEPQQwBEcENQQ9BDgETwQuAAArAAAAAyYAAAAUBD4EOwQzBCAALwAgAEUAQgBJAFQARABBACAAPwQ+BCAAEwQaBAAJAAAAAwQAAAA8AD0AAPEGAAAD7AYAAB8EQAQ1BDIESwRIBDUEPQQ4BDUEIAAyBCAAPgRCBD0EPgRIBDUEPQQ4BDgEIAAaBDsEOAQ1BD0EQgQwBCAAQQQ+BD4EQgQ9BD4ESAQ1BD0EOARPBCAAPwQ+BDoEMAQ3BDAEQgQ1BDsENQQ5BCAAFAQ+BDsEMwQvAEUAQgBJAFQARABBACwAIABDBEEEQgQwBD0EMAQyBDsEOAQyBDAENQQ8BD4EMwQ+BCAAPQQwBCAAOgQwBDYENARDBE4EIAA+BEIERwQ1BEIEPQRDBE4EIAA0BDAEQgRDBCAAKAA/BD4EIAAgBCEEEQQjBCkALAAgAEMEQAQ+BDIEPQRPBDoACgBBBCAAMQQ7BDgENgQwBDkESAQ1BDkEIAA+BEIERwQ1BEIEPQQ+BDkEIAA0BDAEQgRLBCAAKAA/BD4EIAAgBCEEEQQjBCkALAAgAEEEOwQ1BDQEQwROBEkENQQ5BCAANwQwBCAANAQwBEIEPgQ5BCAANwQwBDoEOwROBEcENQQ9BDgETwQgABQEPgQzBD4EMgQ+BEAEMAQsACAAEyAgADEEPgQ7BDUENQQgADIALAA1ACAAKAAUBDIEQwRFBCAARgQ1BDsESwRFBCAAPwRPBEIEOAQgADQENQRBBE8EQgRLBEUEKQAgACgAMgQ6BDsETgRHBDgEQgQ1BDsETAQ9BD4EKQA7AAoAOAQ7BDgEIABBBD0EOAQ2BDUEPQQ4BDUEIABBBD4EPgRCBD0EPgRIBDUEPQQ4BE8EIAA/BD4EOgQwBDcEMARCBDUEOwQ1BDkEIAAUBD4EOwQzBC8ARQBCAEkAVABEAEEAIAA0BD4EIAA+BEIEQAQ4BEYEMARCBDUEOwRMBD0EPgQzBD4EIAA3BD0EMARHBDUEPQQ4BE8ELgAKABIEIABABDAEQQRHBDUEQgQgABQEPgQ7BDMEMAQgAD0ENQQgADIEOgQ7BE4ERwQwBE4EQgRBBE8EIAA/BEAENQQ0BD4EQQRCBDAEMgQ7BDUEPQQ9BEsENQQgABoEOwQ4BDUEPQRCBEMEIAA3BDAEOQQ8BEsELAAgADoEQAQ1BDQEOARCBEsEIAA4BCAAOAQ9BEsENQQgADQENQQ9BDUENgQ9BEsENQQgAD4EMQRPBDcEMARCBDUEOwRMBEEEQgQyBDAELAAgAEEEQwQxBD4EQAQ0BDgEPQQ4BEAEPgQyBDAEPQQ9BEsENQQgAEEEOwQ1BDQEQwROBEkEOAQ8BCgAOAQ8BDgEKQAgAEEEPwQ+BEEEPgQxBD4EPAQoADAEPAQ4BCkAOgAKADEAKQAgADcEMAQ5BDwESwQsACAAOgQ+BD0EMgQ1BEAEQgQ4BEAEPgQyBDAEPQQ9BEsENQQgADIEIAAyBDUEOgRBBDUEOwRPBCAAKAA/BEMEQgQ1BDwEIAAyBEsEPwRDBEEEOgQwBCAAPwRABD4EQQRCBEsERQQgADIENQQ6BEEENQQ7BDUEOQQsACAAPwQwBEAEMAQ8BDUEQgRABEsEIAA6BD4EQgQ+BEAESwRFBCAAQQQ+BDMEOwQwBEEEPgQyBDAEPQRLBCAAQQQgABEEMAQ9BDoEPgQ8BCkALAAgADgEIAA+BEQEPgRABDwEOwQ1BD0EOAQ1BCAANwQwBDsEPgQzBDAEIAA0BDAEPQQ9BEsERQQgADIENQQ6BEEENQQ7BDUEOQQgADIEIAA/BD4EOwRMBDcEQwQgABEEMAQ9BDoEMAQgAEEEIAA/BDUEQAQ1BDQEMARHBDUEOQQgABEEMAQ9BDoEQwQuAAoAMgApACAANAQ1BD0ENQQ2BD0ESwQ1BCAAPgQxBE8ENwQwBEIENQQ7BEwEQQRCBDIEMAQgABoEOwQ4BDUEPQRCBDAELAAgADIEIAA+BEIEPQQ+BEgENQQ9BDgEOAQgADoEPgRCBD4EQARLBEUEIAA8BDUENgQ0BEMEIAAaBDsEOAQ1BD0EQgQ+BDwELAAgABEEMAQ9BDoEPgQ8BCAAOAQgADgEPQRLBDwEOAQgADoEQAQ1BDQEOARCBD4EQAQwBDwEOAQgADcEMAQ6BDsETgRHBDUEPQQ+BCgASwQpACAAQQQ+BDMEOwQwBEgENQQ9BDgENQQoADgETwQpACAAOgRABDUENAQ4BEIEPgRABD4EMgQgAD4EIAA/BD4EQARPBDQEOgQ1BCAAQwQ0BD4EMgQ7BDUEQgQyBD4EQAQ1BD0EOARPBCAAOARFBCAAQgRABDUEMQQ+BDIEMAQ9BDgEOQQgADoEIAAaBDsEOAQ1BD0EQgRDBCAAPQQwBCAAQwRBBDsEPgQyBDgETwRFBCwAIABBBD4EMwQ7BDAEQQQ+BDIEMAQ9BD0ESwRFBCAAQQQgABEEMAQ9BDoEPgQ8BC4AAB8AAAADGgAAABQEPgQ7BDMEIAAvACAARQBCAEkAVABEAEEAAHkCAAADdAIAAB8EQAQ1BDIESwRIBDUEPQQ4BDUEIAAyBCAAPgRCBD0EPgRIBDUEPQQ4BDgEIAAaBDsEOAQ1BD0EQgQwBCAAQQQ+BD4EQgQ9BD4ESAQ1BD0EOARPBCAAPwQ+BDoEMAQ3BDAEQgQ1BDsENQQ5BCAAFAQ+BDsEMwQvAEUAQgBJAFQARABBACwAIABDBEEEQgQwBD0EMAQyBDsEOAQyBDAENQQ8BD4EMwQ+BCAAPQQwBCAAOgQwBDYENARDBE4EIAA+BEIERwQ1BEIEPQRDBE4EIAA0BDAEQgRDBCAAKAA/BD4EIAAgBCEEEQQjBCkALAAgAEMEQAQ+BDIEPQRPBDoACgBBBCAAMQQ7BDgENgQwBDkESAQ1BDkEIAA+BEIERwQ1BEIEPQQ+BDkEIAA0BDAEQgRLBCAAKAA/BD4EIAAgBCEEEQQjBCkALAAgAEEEOwQ1BDQEQwROBEkENQQ5BCAANwQwBCAANAQwBEIEPgQ5BCAANwQwBDoEOwROBEcENQQ9BDgETwQgABQEPgQzBD4EMgQ+BEAEMAQsACAAEyAgADEEPgQ7BDUENQQgADMAIAAoACIEQAQ1BEUEKQAgACgAMgQ6BDsETgRHBDgEQgQ1BDsETAQ9BD4EKQA7AAoAOAQ7BDgEIABBBD0EOAQ2BDUEPQQ4BDUEIABBBD4EPgRCBD0EPgRIBDUEPQQ4BE8EIAA/BD4EOgQwBDcEMARCBDUEOwQ1BDkEIAAUBD4EOwQzBC8ARQBCAEkAVABEAEEAIAA0BD4EIAA+BEIEQAQ4BEYEMARCBDUEOwRMBD0EPgQzBD4EIAA3BD0EMARHBDUEPQQ4BE8ELgAAFwAAAAMSAAAAUwBGAF8AMQAuADEAXwBWADIAAJUCAAADkAIAAB8EQAQ1BDIESwRIBDUEPQQ4BDUEIAAyBCAAPgRCBD0EPgRIBDUEPQQ4BDgEIAAaBDsEOAQ1BD0EQgQwBCAAQQQ+BD4EQgQ9BD4ESAQ1BD0EOARPBCAAPwQ+BDoEMAQ3BDAEQgQ1BDsENQQ5BCAAJwQ4BEEEQgRLBDkEIAA0BD4EOwQzBC8ARQBCAEkAVABEAEEALAAgAEMEQQRCBDAEPQQwBDIEOwQ4BDIEMAQ1BDwEPgQzBD4EIAA9BDAEIAA6BDAENgQ0BEMETgQgAD4EQgRHBDUEQgQ9BEMETgQgADQEMARCBEMEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQwRABD4EMgQ9BE8EOgAKAEEEIAAxBDsEOAQ2BDAEOQRIBDUEOQQgAD4EQgRHBDUEQgQ9BD4EOQQgADQEMARCBEsEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQQQ7BDUENARDBE4ESQQ1BDkEIAA3BDAEIAA0BDAEQgQ+BDkEIAA3BDAEOgQ7BE4ERwQ1BD0EOARPBCAAFAQ+BDMEPgQyBD4EQAQwBCwAIAATICAAMQQ+BDsENQQ1BCAANQAgACgAHwRPBEIEOAQpACAAKAAyBDoEOwROBEcEOARCBDUEOwRMBD0EPgQpADsACgA4BDsEOAQgAEEEPQQ4BDYENQQ9BDgENQQgAEEEPgQ+BEIEPQQ+BEgENQQ9BDgETwQgAD8EPgQ6BDAENwQwBEIENQQ7BDUEOQQgACcEOARBBEIESwQ5BCAANAQ+BDsEMwQvAEUAQgBJAFQARABBACAANAQ+BCAAPgRCBEAEOARGBDAEQgQ1BDsETAQ9BD4EMwQ+BCAANwQ9BDAERwQ1BD0EOARPBC4AAC0AAAADKAAAACcEOARBBEIESwQ5BCAANAQ+BDsEMwQgAC8AIABFAEIASQBUAEQAQQAATQQAAANIBAAAHwRABDUEMgRLBEgENQQ9BDgENQQgADIEIAA+BEIEPQQ+BEgENQQ9BDgEOAQgAEMERwQwBEEEQgQ9BDgEOgQ+BDIEIAATBEAEQwQ/BD8ESwQsACAAQwQ6BDAENwQwBD0EPQQ+BDkEIAAyBCAAHwQ1BEAENQRHBD0ENQQgADEAIAAfBEAEOAQ7BD4ENgQ1BD0EOARPBCAAqwAhBD4EQQRCBDAEMgQgABMEQARDBD8EPwRLBLsAIAA6BCAAFAQ+BDMEPgQyBD4EQARDBCwAIABBBD4EPgRCBD0EPgRIBDUEPQQ4BE8EIAA/BD4EOgQwBDcEMARCBDUEOwQ1BDkEIAAnBDgEQQRCBEsEOQQgADQEPgQ7BDMELwBFAEIASQBUAEQAQQAsACAAQwRBBEIEMAQ9BDAEMgQ7BDgEMgQwBDUEPAQ+BDMEPgQgAD0EMAQgADoEMAQ2BDQEQwROBCAAPgRCBEcENQRCBD0EQwROBCAANAQwBEIEQwQgADgEIAA9BDAEIAA0BDAEQgRDBCAAMgRLBDQEMARHBDgEIAA6BEAENQQ0BDgEQgQ9BEsERQQgAEEEQAQ1BDQEQQRCBDIEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQwRABD4EMgQ9BE8EOgAKAEEEIAAxBDsEOAQ2BDAEOQRIBDUEOQQgAD4EQgRHBDUEQgQ9BD4EOQQgADQEMARCBEsEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQQQ7BDUENARDBE4ESQQ1BDkEIAA3BDAEIAA0BDAEQgQ+BDkEIAA3BDAEOgQ7BE4ERwQ1BD0EOARPBCAAFAQ+BDMEPgQyBD4EQAQwBCwAIAA4BDsEOAQgAEEEIAA0BDAEQgRLBCAAPwQ1BEAEMgQ+BDkEIAAyBEsENAQwBEcEOAQgADoEQAQ1BDQEOARCBDAEIAAoADIEOgQ7BE4ERwQ4BEIENQQ7BEwEPQQ+BCkAIAAoADIEIAA3BDAEMgQ4BEEEOAQ8BD4EQQRCBDgEIAA+BEIEIABCBD4EMwQ+BCwAIAA6BDAEOgQ+BDUEKAAwBE8EKQAgAEEEPgQxBEsEQgQ4BDUEIAAoADQEMARCBDAEKQAgAD0EMARBBEIEQwQ/BDgEQgQgAEAEMAQ9BDUENQQpACAAEyAgADEEPgQ7BDUENQQgADUAIAAoAB8ETwRCBDgEKQAgACgAMgQ6BDsETgRHBDgEQgQ1BDsETAQ9BD4EKQA7AAoAOAQ7BDgEIABBBD0EOAQ2BDUEPQQ4BDUEIABBBD4EPgRCBD0EPgRIBDUEPQQ4BE8EIAA/BD4EOgQwBDcEMARCBDUEOwQ1BDkEIAAnBDgEQQRCBEsEOQQgADQEPgQ7BDMELwBFAEIASQBUAEQAQQAgADQEPgQgAD4EQgRABDgERgQwBEIENQQ7BEwEPQQ+BDMEPgQgADcEPQQwBEcENQQ9BDgETwQuAAA5AAAAAzQAAAAnBDgEQQRCBEsEOQQgADQEPgQ7BDMEIAAvACAARQBCAEkAVABEAEEAIAA/BD4EIAATBBoEAA8DAAADCgMAAB8EQAQ1BDIESwRIBDUEPQQ4BDUEIAAyBCAAPgRCBD0EPgRIBDUEPQQ4BDgEIAAaBDsEOAQ1BD0EQgQwBCAAQQQ+BD4EQgQ9BD4ESAQ1BD0EOARPBCAAPwQ+BDoEMAQ3BDAEQgQ1BDsENQQ5BCAAJwQ4BEEEQgRLBDkEIAA0BD4EOwQzBC8ARQBCAEkAVABEAEEALAAgAEMEQQRCBDAEPQQwBDIEOwQ4BDIEMAQ1BDwEPgQzBD4EIAA9BDAEIAA6BDAENgQ0BEMETgQgAD4EQgRHBDUEQgQ9BEMETgQgADQEMARCBEMEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQwRABD4EMgQ9BE8EOgAKAEEEIAAxBDsEOAQ2BDAEOQRIBDUEOQQgAD4EQgRHBDUEQgQ9BD4EOQQgADQEMARCBEsEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQQQ7BDUENARDBE4ESQQ1BDkEIAA3BDAEIAA0BDAEQgQ+BDkEIAA3BDAEOgQ7BE4ERwQ1BD0EOARPBCAAFAQ+BDMEPgQyBD4EQAQwBCwAIAATICAAMQQ+BDsENQQ1BCAANAAgACgAJwQ1BEIESwRABDUERQQpACAAKAAyBDoEOwROBEcEOARCBDUEOwRMBD0EPgQpADsACgA4BDsEOAQgAEEEPQQ4BDYENQQ9BDgENQQgAEEEPgQ+BEIEPQQ+BEgENQQ9BDgETwQgAD8EPgQ6BDAENwQwBEIENQQ7BDUEOQQgACcEOARBBEIESwQ5BCAANAQ+BDsEMwQvAEUAQgBJAFQARABBACAANAQ+BCAAPgRCBEAEOARGBDAEQgQ1BDsETAQ9BD4EMwQ+BCAANwQ9BDAERwQ1BD0EOARPBC4ACgASBCAAQAQwBEEERwQ1BEIEIAAnBDgEQQRCBD4EMwQ+BCAAFAQ+BDsEMwQwBCAAMgQ6BDsETgRHBDAETgRCBEEETwQgAD0ENQQ/BD4EOgRABEsEQgRLBDUEIAAwBDoEOgRABDUENAQ4BEIEOAQyBEsELgAAFwAAAAMSAAAAUwBGAF8AMQAuADEAXwBWADMAAK0CAAADqAIAAB8EQAQ1BDIESwRIBDUEPQQ4BDUEIAAyBCAAPgRCBD0EPgRIBDUEPQQ4BDgEIAAaBDsEOAQ1BD0EQgQwBCAAQQQ+BD4EQgQ9BD4ESAQ1BD0EOARPBCAAPwQ+BDoEMAQ3BDAEQgQ1BDsENQQ5BCAAFAQ+BDsEMwQvABIESwRABEMERwQ6BDAELAAgAEMEQQRCBDAEPQQwBDIEOwQ4BDIEMAQ1BDwEPgQzBD4EIAA9BDAEIAA6BDAENgQ0BEMETgQgAD4EQgRHBDUEQgQ9BEMETgQgADQEMARCBEMEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQwRABD4EMgQ9BE8EOgAKAEEEIAAxBDsEOAQ2BDAEOQRIBDUEOQQgAD4EQgRHBDUEQgQ9BD4EOQQgADQEMARCBEsEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQQQ7BDUENARDBE4ESQQ1BDkEIAA3BDAEIAA0BDAEQgQ+BDkEIAA3BDAEOgQ7BE4ERwQ1BD0EOARPBCAAFAQ+BDMEPgQyBD4EQAQwBCwAIAATICAAMQQ+BDsENQQ1BCAAMAAsADQAIAAoAB0EPgQ7BE8EIABGBDUEOwRLBEUEIABHBDUEQgRLBEAENQRFBCAANAQ1BEEETwRCBEsERQQpACAAKAAyBDoEOwROBEcEOARCBDUEOwRMBD0EPgQpADsACgA4BDsEOAQgAEEEPQQ4BDYENQQ9BDgENQQgAEEEPgQ+BEIEPQQ+BEgENQQ9BDgETwQgAD8EPgQ6BDAENwQwBEIENQQ7BDUEOQQgABQEPgQ7BDMELwASBEsEQARDBEcEOgQwBCAANAQ+BCAAPgRCBEAEOARGBDAEQgQ1BDsETAQ9BD4EMwQ+BCAANwQ9BDAERwQ1BD0EOARPBC4AACEAAAADHAAAABQEPgQ7BDMEIAAvACAAEgRLBEAEQwRHBDoEMAQAdwMAAANyAwAAHwRABDUEMgRLBEgENQQ9BDgENQQgADIEIAA+BEIEPQQ+BEgENQQ9BDgEOAQgABoEOwQ4BDUEPQRCBDAEIABBBD4EPgRCBD0EPgRIBDUEPQQ4BE8EIAA/BD4EOgQwBDcEMARCBDUEOwQ1BDkEIAAUBNAAvgA7BDMELwASBEsEQARDBEcEOgQwBCwAIABDBEEEQgQwBD0EMAQyBDsEOAQyBDAENQQ8BD4EMwQ+BCAAPQQwBCAAOgQwBDYENARDBE4EIAA+BEIERwQ1BEIEPQRDBE4EIAA0BDAEQgRDBCAAKAA/BD4EIAAgBCEEEQQjBCkALAAgAEMEQAQ+BDIEPQRPBDoACgAKAEEEIAAxBDsEOAQ2BDAEOQRIBDUEOQQgAD4EQgRHBDUEQgQ9BD4EOQQgADQEMARCBEsEIAAoAD8EPgQgACAEIQQRBCMEKQAsACAAQQQ7BDUENARDBE4ESQQ1BDkEIAA3BDAEIAA0BDAEQgQ+BDkEIAA3BDAEOgQ7BE4ERwQ1BD0EOARPBCAAFAQ+BDMEPgQyBD4EQAQwBCwAIAATICAAMQQ+BDsENQQ1BCAAMAAsADIANQAgACgAHQQ+BDsETwQgAEYENQQ7BEsERQQgADQEMgQwBDQERgQwBEIEOAQgAD8ETwRCBDgEIABBBD4EQgRLBEUEKQAgACgAMgQ6BDsETgRHBDgEQgQ1BDsETAQ9BD4EKQA7AAoACgA4BDsEOAQgAEEEPQQ4BDYENQQ9BDgENQQgAEEEPgQ+BEIEPQQ+BEgENQQ9BDgETwQgAD8EPgQ6BDAENwQwBEIENQQ7BDUEOQQgABQEPgQ7BDMELwASBEsEQARDBEcEOgQwBCAANAQ+BCAAPgRCBEAEOARGBDAEQgQ1BDsETAQ9BD4EMwQ+BCAANwQ9BDAERwQ1BD0EOARPBC4ACgAKABIEIABABDAEQQRHBDUEQgQgABQEPgQ7BDMEMAQgAD0ENQQgADIEOgQ7BE4ERwQwBE4EQgRBBE8EIAA+BDEETwQ3BDAEQgQ1BDsETARBBEIEMgQwBCAAPwQ1BEAENQQ0BCAAQQQ7BDUENARDBE4ESQQ4BDwEOAQgADsEOARGBDAEPAQ4BDoAIAAoBBgEFAQeBBIEIAAXBBAEIwQgBCAAHAQjBCUEEAQcBBUEFAQeBBIEGAQnBC4AABcAAAADEgAAAFMARgBfADEALgAyAF8AVgAxAABRAAAAA0wAAAAeBDMEQAQwBD0EOARHBDUEPQQ4BDUEIAA+BDEESgQ1BDwEMAQgAD8EQAQ1BDQESgRPBDIEOwQ1BD0EPQRLBEUEIAA4BEEEOgQ+BDIEAEsCAAADRgIAAB8EQAQ1BDQESgRPBDIEOwQ1BD0EOAQ1BCAAOwROBDEEPgQ8BEMEIAAjBEcEMARBBEIEPQQ4BDoEQwQgAEEENAQ1BDsEOgQ4BCAAOARBBDoEMAQoAD4EMgQpACAAOAQvADgEOwQ4BCAAPwRABDgEPQRPBEIEOAQ1BCAAQQRDBDQEPgQ8BCAAOgQgAD8EQAQ+BDgENwQyBD4ENARBBEIEMgRDBCAAOARBBDoEPgQyBD4EMwQ+BCgASwRFBCkAIAA3BDAETwQyBDsENQQ9BDgETwQoADgEOQQpACAAPgQxBCAAQwQ/BDsEMARCBDUEIAA0BDUEPQQ1BDYEPQQ+BDkEIABBBEMEPAQ8BEsEIAA4BC8AOAQ7BDgEIAA+BDEEIAA4BEEEQgRABDUEMQQ+BDIEMAQ9BDgEOAQgADgEPARDBEkENQRBBEIEMgQwBCAAPQQwBCAAQQQ+BDIEPgQ6BEMEPwQ9BEMETgQgAEEEQwQ8BDwEQwQsACAAPwRABDUEMgRLBEgEMAROBEkEQwROBCAAMQAwACAAMAAwADAAIAAwADAAMAAgACgAFAQ1BEEETwRCBEwEIAA8BDgEOwQ7BDgEPgQ9BD4EMgQpACAAQARDBDEEOwQ1BDkEIAAyBCAAPgRCBD0EPgRIBDUEPQQ4BDgEIAA7BE4EMQQ+BDMEPgQgADgENwQgAEMEOgQwBDcEMAQ9BD0ESwRFBCAAMgQgAD0EMARBBEIEPgRPBEkENQQ8BCAAPwRDBD0EOgRCBDUEIAA7BDgERgQuAAAHAAAAAwIAAAA8AAARAAAAAwwAAABABEMEMQQ7BDUEOQQAFwAAAAMSAAAAUwBGAF8AMQAuADIAXwBWADIAAPECAAAD7AIAAB8EQAQ1BDQESgRPBDIEOwQ1BD0EOAQ1BCAAOARBBDoEMAQoAD4EMgQpACAAOAQvADgEOwQ4BCAAPwRABDgEPQRPBEIEOAQ1BCAAQQRDBDQEPgQ8BCAAOgQgAD8EQAQ+BDgENwQyBD4ENARBBEIEMgRDBCAAOARBBDoEPgQyBD4EMwQ+BCgASwRFBCkAIAA3BDAETwQyBDsENQQ9BDgETwQoADgEOQQpACAAPgQxBCAAQwQ/BDsEMARCBDUEIAA0BDUEPQQ1BDYEPQQ+BDkEIABBBEMEPAQ8BEsEIAA4BC8AOAQ7BDgEIAA+BDEEIAA4BEEEQgRABDUEMQQ+BDIEMAQ9BDgEOAQgADgEPARDBEkENQRBBEIEMgQwBDoACgATICAAPwRABDgEPAQ1BD0EOARCBDUEOwRMBD0EPgQgADoEIAAaBDsEOAQ1BD0EQgRDBCAAMgQgAEEEPgQyBD4EOgRDBD8EPQQ+BDwEIABABDAENwQ8BDUEQAQ1BCwAIAA/BEAENQQyBEsESAQwBE4ESQQ1BDwEIAAxADAAIAAwADAAMAAgADAAMAAwACAAKAAUBDUEQQRPBEIETAQgADwEOAQ7BDsEOAQ+BD0EPgQyBCkAIABABEMEMQQ7BDUEOQQ7AAoAEyAgAD8EQAQ4BDwENQQ9BDgEQgQ1BDsETAQ9BD4EIAA6BCAAPwQ+BEAEQwRHBDgEQgQ1BDsETgQgADgELwA4BDsEOAQgADcEMAQ7BD4EMwQ+BDQEMARCBDUEOwROBCAAOAQvADgEOwQ4BCAAMwQwBEAEMAQ9BEIEQwQgADIEIABBBD4EMgQ+BDoEQwQ/BD0EPgQ8BCAAQAQwBDcEPAQ1BEAENQQsACAAPwRABDUEMgRLBEgEMAROBEkENQQ8BCAAMQAwACAAMAAwADAAIAAwADAAMAAgACgAFAQ1BEEETwRCBEwEIAA8BDgEOwQ7BDgEPgQ9BD4EMgQpACAAQARDBDEEOwQ1BDkELgDnAgAAAC0AAAABKAAAAAADAAAAAQEKAQMAAAABAQoCAwAAAAEBCgQDAAAAAQEKBQMAAAABAQoEIAAAAAULAAAAAAYAAAACAQAAABEFCwAAAAAGAAAAAgEAAAAIBnsAAAAHKgAAAAEGAwAAAAIBAQQGDgAAAEMAYQBsAGkAYgByAGkACQEBBgUAAAAAAAAmQAdHAAAAAQYDAAAAAgEBBAYuAAAAVgBhAHIAKAAtAC0AdAB5AHAAbwAtAGYAbwBuAHQALQBmAGEAbQBpAGwAeQApAAYFAAAAAAAAJkAOKQAAAAMkAAAAAQEBBgQAAAAAAgEBBwQAAAAAAwEBCAQAAAAABAEBCQQAAAAAAhoBAAADHgAAAAYEAAAAAAcEAAAAAAgEAAAAAAkEAAAAAAwEAAAAAAMeAAAABgQAAAAABwQAAAAACAQAAAAACQQAAAAADAQAAAAAAy0AAAAGBAAAAAAHBAAAAAAIBAAAAAAJBAAAAAAAAQENBgYAAAAAAQAHAQQMBAAAAAADMAAAAAYEAAAAAAcEAAAAAAMBAQgEAQAAAAkEAAAAAAABAQ0GBgAAAAABBgcBAQwEAAAAAAMwAAAABgQAAAAABwQAAAAAAwEBCAQBAAAACQQAAAAAAAEBDQYGAAAAAAEABwEEDAQAAAAAAzMAAAAGBAAAAAAHBAAAAAADAQEIBAEAAAAEAQEJBAMAAAAAAQENBgYAAAAAAQYHAQEMBAAAAAAPKgAAABAlAAAAAAQAAAAAAAAABA4AAAAeBDEESwRHBD0ESwQ5BAUEAAAAAAAAAAxOAAAAACIAAABUAGEAYgBsAGUAUwB0AHkAbABlAE0AZQBkAGkAdQBtADIAASIAAABQAGkAdgBvAHQAUwB0AHkAbABlAEwAaQBnAGgAdAAxADYAETcAAAAAMgAAAPoAEQAAAFMAbABpAGMAZQByAFMAdAB5AGwAZQBMAGkAZwBoAHQAMQD7AAQAAAAAAAAACAAAAAA=&quot; style=&quot;border-collapse: collapse;font-family:Calibri;font-size:11pt;color:#000;background-color:transparent;&quot;&gt;&lt;tbody&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V1&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении участников Группы, указанной в Перечне 1 Приложения «Состав Группы» к Договору, соотношения показателей Долг/EBITDA, устанавливаемого на каждую отчетную дату (по РСБУ), уровня:&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, – более 4 (Четырех) (включительно);&lt;br&gt;или снижение соотношения показателей Долг/EBITDA до отрицательного значения.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Долг / EBITDA по ГК&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;4&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V1&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении Клиента соотношения показателей Долг/EBITDA, устанавливаемого на каждую отчетную дату (по РСБУ), уровня:&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, – более 2,5 (Двух целых пяти десятых) (включительно);&lt;br&gt;или снижение соотношения показателей Долг/EBITDA до отрицательного значения.&lt;br&gt;В расчет Долга не включаются предоставленные Клиенту займы, кредиты и иные денежные обязательства, субординированные следующим(ими) способом(ами):&lt;br&gt;1) займы, конвертированные в векселя (путем выпуска простых векселей, параметры которых согласованы с Банком), и оформление залога данных векселей в пользу Банка с передачей Банку.&lt;br&gt;2) денежные обязательства Клиента, в отношении которых между Клиентом, Банком и иными кредиторами заключено(ы) соглашение(ия) кредиторов о порядке удовлетворения их требований к Клиенту на условиях, согласованных с Банком.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Долг / EBITDA&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;2,5&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V1&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении Клиента соотношения показателей Долг/EBITDA, устанавливаемого на каждую отчетную дату (по РСБУ), уровня:&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, – более 3 (Трех) (включительно);&lt;br&gt;или снижение соотношения показателей Долг/EBITDA до отрицательного значения.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Долг / EBITDA&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;3&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V2&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении Клиента соотношения показателей Чистый долг/EBITDA, устанавливаемого на каждую отчетную дату (по РСБУ), уровня:&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, – более 5 (Пяти) (включительно);&lt;br&gt;или снижение соотношения показателей Чистый долг/EBITDA до отрицательного значения.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Чистый долг / EBITDA&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;5&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:86.42857142857142pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V2&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении участников Группы, указанной в Перечне 1 Приложения «Состав Группы» к Договору, соотношения показателей Чистый долг/EBITDA, устанавливаемого на каждую отчетную дату и на дату выдачи кредитных средств (по РСБУ), уровня:&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, или с даты первой выдачи кредита (включительно) (в зависимости от того, какое(ая) событие (дата) наступит ранее) – более 5 (Пяти) (включительно);&lt;br&gt;или снижение соотношения показателей Чистый долг/EBITDA до отрицательного значения.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Чистый долг / EBITDA по ГК&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;5&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:86.42857142857142pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V2&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении Клиента соотношения показателей Чистый долг/EBITDA, устанавливаемого на каждую отчетную дату (по РСБУ), уровня:&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, – более 4 (Четырех) (включительно);&lt;br&gt;или снижение соотношения показателей Чистый долг/EBITDA до отрицательного значения.&lt;br&gt;В расчет Чистого Долга включаются непокрытые аккредитивы.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Чистый долг / EBITDA&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;4&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V3&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении Клиента соотношения показателей Долг/Выручка, устанавливаемого на каждую отчетную дату (по РСБУ), уровня:&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, – более 0,4 (Ноля целых четырех десятых) (включительно);&lt;br&gt;или снижение соотношения показателей Долг/Выручка до отрицательного значения.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Долг / Выручка&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;0,4&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:86.42857142857142pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.1_V3&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Соблюдение показателя долговой нагрузки&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Превышение в отношении Клиента соотношения показателей ДÐ¾лг/Выручка, устанавливаемого на каждую отчетную дату (по РСБУ), уровня:&lt;br&gt;&lt;br&gt;с ближайшей отчетной даты (по РСБУ), следующей за датой заключения Договора, – более 0,25 (Ноля целых двадцати пяти сотых) (включительно);&lt;br&gt;&lt;br&gt;или снижение соотношения показателей Долг/Выручка до отрицательного значения.&lt;br&gt;&lt;br&gt;В расчет Долга не включаются обязательства перед следующими лицами: ШИДОВ ЗАУР МУХАМЕДОВИЧ.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Долг / Выручка&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;0,25&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.2_V1&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Ограничение объема предъявленных исков&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Предъявление любому Участнику сделки иска(ов) и/или принятие судом к производству искового(ых) заявления(ий) об уплате денежной суммы и/или об истребовании имущества на совокупную сумму, превышающую 10 000 000 (Десять миллионов) рублей в отношении любого из указанных в настоящем пункте лиц.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Ограничение объема предъявленных исков&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;10 000 000&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:86.42857142857142pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;рублей&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;height:nullpt&quot;&gt;&lt;td style=&quot;width:92.14285714285712pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;SF_1.2_V2&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:230.7142857142857pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Ограничение объема предъявленных исков&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:337.85714285714283pt;white-space:nowrap;vertical-align:bottom;&quot;&gt;&lt;span style=&quot;vertical-align:baseline;&quot;&gt;Предъявление иска(ов) и/или принятие судом к производству искового(ых) заявления(ий) об уплате денежной суммы и/или об истребовании имущества:&lt;br&gt;– применительно к Клиенту в совокупном размере, превышающем 10 000 000 (Десять миллионов) рублей;&lt;br&gt;– применительно к поручителю и/или залогодателю и/или гаранту в совокупном размере, превышающем 10 000 000 (Десять миллионов) рублей.&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:271.4285714285714pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;Ограничение объема предъявленных исков&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:47.857142857142854pt;white-space:nowrap;text-align:center;vertical-align:top;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;&amp;lt;&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:87.85714285714285pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;10 000 000&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;width:86.42857142857142pt;white-space:nowrap;text-align:left;vertical-align:middle;&quot;&gt;&lt;span style=&quot;font-family:Var(--typo-font-family);vertical-align:baseline;&quot;&gt;рублей&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="170" y="6570" width="560" height="660" as="geometry" />
        </mxCell>
        <mxCell id="kW_1GkDuVryrUP6SlwmR-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.786;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="JJz8-9tXR7XxKiCPV7C5-8" target="JJz8-9tXR7XxKiCPV7C5-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kW_1GkDuVryrUP6SlwmR-2" value="Вы — CreditDecisionAgent, экспертная система для автоматического принятия решений по онлайн-заявкам на кредит в крупном банке. Вам нужно выполнить два этапа:&#xa;1. Подробный анализ каждого критерия (Custom Chain of Thought).&#xa;2. Вывести итоговое заключение в строгом JSON-формате (Structured Output).&#xa;&#xa;&#xa;&#xa;&#xa;###  Входные блоки (передаются как есть):&#xa;Блок 1 – АС УФА:&#xa;{ufa_block}&#xa;&#xa;&#xa;&#xa;&#xa;Блок 2 – Рейтинг:&#xa;{rating_block}&#xa;&#xa;&#xa;&#xa;&#xa;Блок 3 – ОКС:&#xa;{oks_block}&#xa;&#xa;&#xa;&#xa;&#xa;Блок 4 – Cashflow:&#xa;{cf_block}&#xa;&#xa;&#xa;&#xa;&#xa;Блок 5 – Кредитная история:&#xa;{history_block}&#xa;&#xa;&#xa;Блок 6 – АС УФА (заключение):&#xa;{ufa_block_2}&#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;&#xa;&#xa;### Описание критериев анализа:&#xa;&#xa;&#xa;&#xa;&#xa;1. **Динамика бизнеса**:&#xa;    1.1 **Выручка LTM **:&#xa;должен быть положительный рост (&gt;0) - хорошо;&#xa;допустимое снижение в пределах 10% (было 100, стало 95 или 90) - удовлетворительно;&#xa;снижение больше 10% - плохо. &#xa;Рекомендация если удовлетворительно и плохо - Необходимо оформить поручительство платежеспособного юридического лица&#xa;Обязателен при принятии решения&#xa;    1.2 **EBITDA LTM**:&#xa;должен быть положительный рост (&gt;0) и сама EBITDA LTM должна быть (&gt;0) было 100 стало 120 - хорошо;&#xa;допускается сокращение не более на 10% и сама EBITDA LTM должна быть (&gt;0), было 100 стало 90 - удовлетворительно;&#xa;снижение в пределах больше 10%  было 100 стало 89, и/или само значение отрицательное (было - 500 млн, а стало -250 млн) - плохо.&#xa;EBITDA LTM определяется по рентабельности EBITDA LTM.&#xa;Обязателен при принятии решения&#xa;    1.3 **Прирост квартальной выручки** &#xa;должен быть положительный рост (&gt;0) хотя бы в одном из друх кварталов подряд - хорошо;&#xa;сокращение в двух кварталах подряд относительно АППГ (аналогичный период  прошлого года) не более 10%, 100 стало 90 млн - удовлетворительно;&#xa;сокращение в двух кварталах  подряд более 10% относительно АППГ (аналогичный период  прошлого года) - плохо&#xa;Рекомендация если удовлетворительно и плохо - Необходимо оформить поручительство платежеспособного юридического лица&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;2. **Оборачиваемость запасов LTM (дни)**:&#xa;Соответствует или выше оборачиваемости большинства компаний данного ОКК не более 10% (было 70 стало 77) - хорошо&#xa;Выше оборачиваемости большинства компаний данного ОКК (от 10% до 20%) - удовлетворительно&#xa;Выше оборачиваемости большинства компаний данного ОКК (от 20% и более) - плохо&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;3. **Оборачиваемость дебиторской задолженности (ДЗ) LTM**:&#xa;Соответствует или выше оборачиваемости большинства компаний данного ОКК не более 10% (было 70 стало 77) - хорошо&#xa;Выше оборачиваемости большинства компаний данного ОКК (от 10% до 20%) - удовлетворительно&#xa;Выше оборачиваемости большинства компаний данного ОКК (от 20% и более) - плохо&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;4. **Оборачиваемость кредиторской задолженности (КЗ) LTM**:&#xa;Соответствует или выше оборачиваемости большинства компаний данного ОКК не более 10% (было 70 стало 77) - хорошо&#xa;Выше оборачиваемости большинства компаний данного ОКК (от 10% до 20%) - удовлетворительно&#xa;Выше оборачиваемости большинства компаний данного ОКК (от 20% и более) - плохо&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;5. **Уровень долговой нагрузки**:&#xa; 5.1 **ICR LTM**:&#xa;  если выше порогового значения — хорошо, если ниже порогового значения — плохо&#xa;Обязателен при принятии решения&#xa;5.2 **Долговая нагрузка**:&#xa;   - Чистый долг/EBITDA если выше порогового значения - хорошо, если соответствует диапазону показателя для данного ОКК - удовлетворительно, если ниже порогового значения для данного ОКК - плохо&#xa;Обязателен при принятии решения&#xa;   - Долг/EBITDA если выше порогового значения - хорошо, если соответствует диапазону показателя для данного ОКК - удовлетворительно, если ниже порогового значения для данного ОКК - плохо&#xa;Обязателен при принятии решения&#xa;   - Чистый долг/Выручка LTM если выше порогового значения - хорошо, если соответствует диапазону показателя для данного ОКК - удовлетворительно, если ниже порогового значения для данного ОКК - плохо&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;6. **Текущая ликвидность (КТЛ)**:&#xa;   - КТЛ ≥ 1.5 — хорошо  (берём только значение КТЛ),  от 1 - 1.5 - удовлетворительно, &lt; 1 — плохо&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;7. **Рентабельность бизнеса**:&#xa;   - Чистая прибыль &gt;= 0 - хорошо, иначе - плохо&#xa;Необязателен при принятии решения&#xa;&#xa;&#xa;8. **Доля чистых активов (ЧА)**:&#xa;   - ≥ 20% — хорошо, 0-20% - удовлетворительно, &lt; 0 - плохо&#xa;Рекомендация если удовлетворительно и плохо - Необходимо оформить поручительство платежеспособного юридического лица&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;9. **Рейтинг**:&#xa;   - ≤ 17 — хорошо, от 18-22 - удовлетворительно, &gt;= 23 - плохо&#xa;Рекомендация если удовлетворительно и плохо - Необходимо оформить поручительство платежеспособного юридического лица&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;10. **Собственный оборотный капитал (СОК)**:&#xa;    - &gt;=0 — хорошо, &lt; 0 — плохо&#xa;Рекомендация если удовлетворительно и плохо - Необходимо оформить поручительство платежеспособного юридического лица&#xa;Необязателен при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;11. **Соответствие сделки ОКС**:&#xa;    - значение “Наращивать” или “Держать” — хорошо; “Сокращать” — плохо&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;12. **Вывод CF‑модели**:&#xa;    - “Вывод №1” с любым уровнем риска — хорошо&#xa;    - “Вывод №2” — плохо&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;13. **Кредитная история**:&#xa;    - Нет просрочек ≥5 дней за последние 180 дней&#xa;    - В целом положительная&#xa;Обязателен при принятии решения&#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;&#xa;&#xa;###  Custom Chain of Thought&#xa;&#xa;&#xa;&#xa;&#xa;Для каждого критерия:&#xa;- **explanation**: «Проверяем [Название]: значение = X, порог = Y»&#xa;- **status**: «ХОРОШО», «УДОВЛЕТВОРИТЕЛЬНО» или «ПЛОХО»&#xa;- **comment**: короткое пояснение&#xa;- **has_value**: наличие значения (данных) по критерию&#xa;- **recommendation**: рекомендация если удовлетворительно и плохо&#xa;- **required**: обязательность критерия при принятии решения&#xa;&#xa;&#xa;&#xa;&#xa;&#xa;&#xa;Модель выводит промежуточные рассуждения для каждого критерия.&#xa;&#xa;&#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;&#xa;&#xa;### Агрегация решения&#xa;&#xa;&#xa;&#xa;&#xa;После анализа всех критериев:&#xa;- Если **хотя бы один** статус = «ПЛОХО» → `final_decision = &quot;ОТКАЗ&quot;`&#xa;- Если **отсутствует данные хотя бы по одному обязательному критерию**, то `final_decision = &quot;ОТКАЗ&quot;`&#xa;- Иначе → `final_decision = &quot;ОДОБРЕНО&quot;`&#xa;&#xa;&#xa;&#xa;&#xa;`final_comment`: при отказе — перечислить плохие критерии; при одобрении — общий позитивный итог.&#xa;&#xa;&#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;&#xa;&#xa;###  Выходной формат (только JSON!)&#xa;&#xa;&#xa;&#xa;&#xa;{json}" style="text;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="170" y="7410" width="560" height="3740" as="geometry" />
        </mxCell>
        <UserObject label="&lt;div class=&quot;page-metadata&quot; style=&quot;margin: -15px 0px 20px; padding: 0px; font-size: 12px; color: rgb(94, 108, 132); line-height: 1.5; font-weight: 300;&quot;&gt;&lt;ul style=&quot;margin: 0px; overflow: hidden; padding: 0px; list-style-type: none; line-height: 16px; display: inline-block; vertical-align: bottom;&quot;&gt;&lt;li class=&quot;page-metadata-modification-info&quot; style=&quot;list-style: none; float: left; padding: 0px; margin: 0px; line-height: 1.5;&quot;&gt;Создал(а)&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;author&quot;&gt;&lt;a href=&quot;https://confluence.delta.sbrf.ru/display/~23097935&quot; aria-label=&quot;создано Григорян Тигран Самвелович&quot; class=&quot;url fn confluence-userlink userlink-0&quot; data-username=&quot;23097935&quot; title=&quot;&quot; data-user-hover-bound=&quot;true&quot; style=&quot;color: rgb(94, 108, 132); text-decoration: none solid rgb(94, 108, 132); font-size: 12px; line-height: 1.5; font-weight: 300;&quot;&gt;Григорян Тигран Самвелович&lt;/a&gt;&lt;/span&gt;, редактировал(а)&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;editor&quot;&gt;&lt;a href=&quot;https://confluence.delta.sbrf.ru/display/~burnyshev-ov&quot; aria-label=&quot;модифицировано Бурнышев Олег Викторович&quot; class=&quot;url fn confluence-userlink userlink-1&quot; data-username=&quot;burnyshev-ov&quot; title=&quot;&quot; data-user-hover-bound=&quot;true&quot; style=&quot;color: rgb(94, 108, 132); text-decoration: none solid rgb(94, 108, 132); font-size: 12px; line-height: 1.5; font-weight: 300;&quot;&gt;Бурнышев Олег Викторович&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;a class=&quot;last-modified&quot; aria-label=&quot;отредактировано июл. 31, 2025, выберите, чтобы просмотреть изменения&quot; title=&quot;Показать изменения&quot; href=&quot;https://confluence.delta.sbrf.ru/pages/diffpagesbyversion.action?pageId=16154497310&amp;amp;selectedPageVersions=9&amp;amp;selectedPageVersions=10&quot; style=&quot;color: rgb(94, 108, 132); text-decoration: none solid rgb(94, 108, 132); font-size: 12px; line-height: 1.5; font-weight: 300;&quot;&gt;июл. 31, 2025&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul class=&quot;cw-bylines&quot; style=&quot;margin: 0px; display: inline-block; font-size: 12px; color: rgb(94, 108, 132); list-style-type: none; overflow: hidden; padding: 0px; line-height: 16px; vertical-align: top;&quot;&gt;&lt;li class=&quot;cw-byline-item&quot; style=&quot;display: inline-block; list-style: none; padding: 0px 5px 0px 0px; margin: 0px; line-height: 1.5; float: left;&quot;&gt;&lt;div id=&quot;cw-approval-byline&quot; class=&quot;cw-approval-byline&quot; style=&quot;margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: -5px !important; padding: 0px;&quot;&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;cw-byline-item&quot; style=&quot;display: inline-block; list-style: none; padding: 0px 5px 0px 0px; margin: 0px; line-height: 1.5; float: left;&quot;&gt;&lt;div id=&quot;cw-state-byline&quot; class=&quot;cw-state-byline&quot; style=&quot;margin: 0px; padding: 0px; color: rgb(204, 204, 204);&quot;&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;cw-byline-item&quot; style=&quot;display: inline-block; list-style: none; padding: 0px 5px 0px 0px; margin: 0px; line-height: 1.5; float: left;&quot;&gt;&lt;div id=&quot;cw-tasks-byline&quot; class=&quot;cw-tasks-byline&quot; style=&quot;margin: 0px; padding: 0px;&quot;&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;cw-byline-item&quot; style=&quot;display: inline-block; list-style: none; padding: 0px 5px 0px 0px; margin: 0px; line-height: 1.5; float: left;&quot;&gt;&lt;div id=&quot;cw-state-alternate&quot; class=&quot;cw-state-alternate&quot; style=&quot;margin: 0px; padding: 0px;&quot;&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div id=&quot;rioja-page-message&quot; style=&quot;margin: 0px 0px 20px; padding: 0px;&quot;&gt;&lt;/div&gt;&lt;div id=&quot;main-content&quot; class=&quot;wiki-content&quot; style=&quot;margin: 0px; padding: 0px;&quot;&gt;&lt;h3 id=&quot;id-1Динамикабизнеса-Описание:&quot; style=&quot;margin: 0px; padding: 0px; font-size: 16px; font-weight: bold; line-height: 1.5; letter-spacing: -0.006em; text-transform: none; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: start; text-indent: 0px; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;strong&gt;Описание:&lt;/strong&gt;&lt;/h3&gt;Показатель указывает&amp;nbsp; на наличие изменений в объемах доходов и расходов в ретро-периоде.&amp;nbsp;&lt;br&gt;Применяется 3 показателя:&lt;br&gt;1. Динамика выручки LTM к аналогичной дате прошлого года. Например производится сравнение Выручки LTM на 01.04.2025 к этому же показателю на 01.04.2024.&lt;br&gt;2. Динамика квартальных показателей Выручки: 1.&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;inline-comment-marker valid&quot; data-ref=&quot;e6c93a3e-9b7f-4526-b44a-1f70188a95b0&quot; style=&quot;background-color: rgba(246, 195, 66, 0.3);&quot;&gt;Если отрасль относится к несезонной&lt;/span&gt;, то сравнение производится анализируемого квартала к предыдущему (например 2 кв. 2025 к 1 кв.2025); 2. Если в деятельности присутствует сезонность, то сравниваются сопоставимые периоды к прошлому году (например 2 кв. 2025 ко 2 кв. 2024)&lt;br&gt;3. Динамика EBITDA LTM к аналогичной дате прошлого года. Например производится сравнение EBITDA LTM на 01.04.2025 к этому же показателю на 01.04.2024.&lt;br&gt;&lt;strong&gt;EBITDA&lt;/strong&gt;&lt;span style=&quot;color: rgb(64, 64, 64);&quot;&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;(Earnings Before Interest, Taxes, Depreciation and Amortization) — прибыль до вычета процентов, налогов и амортизации. Показывает&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;операционную рентабельность&lt;span style=&quot;color: rgb(64, 64, 64);&quot;&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;без учёта структуры капитала и налогов.&lt;/span&gt;&lt;h3 class=&quot;p1&quot; id=&quot;id-1Динамикабизнеса-Условияприменимости:&quot; style=&quot;margin: 30px 0px 0px; padding: 0px; font-size: 16px; font-weight: bold; line-height: 1.5; letter-spacing: -0.006em; text-transform: none; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: start; text-indent: 0px; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;strong&gt;&lt;span class=&quot;inline-comment-marker valid&quot; data-ref=&quot;14b41cde-b1af-41ab-9a6e-298669a07f14&quot; style=&quot;background-color: rgba(246, 195, 66, 0.3);&quot;&gt;Условия применимости:&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p style=&quot;margin: 10px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;Оцениваются все показатели по всем клиентам.&lt;/p&gt;&lt;p style=&quot;margin: 10px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;strong style=&quot;font-size: 16px; letter-spacing: -0.006em;&quot;&gt;Возможные значения:&lt;span class=&quot;apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p style=&quot;margin: 10px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;Положительным моментом является одновременный рост Выручки и EBITDA.&lt;/p&gt;&lt;p style=&quot;margin: 10px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;Удовлетворительным индикатором является:&lt;/p&gt;&lt;ul style=&quot;margin: 10px 0px 0px; list-style-type: square; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;li&gt;сокращение выручки на 10% при сохранении либо увеличении EBITDA.&lt;/li&gt;&lt;/ul&gt;&lt;ul style=&quot;margin: 10px 0px 0px; list-style-type: square; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;li class=&quot;ds-markdown-paragraph&quot;&gt;сокращение EBITDA показателя до 10%.&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;p1&quot; id=&quot;id-1Динамикабизнеса-Рекомендацииприудовлетворительномзначениисигнала:&quot; style=&quot;margin: 30px 0px 0px; padding: 0px; font-size: 16px; font-weight: bold; line-height: 1.5; letter-spacing: -0.006em; text-transform: none; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: start; text-indent: 0px; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;strong&gt;Рекомендации при удовлетворительном значении сигнала:&lt;/strong&gt;&lt;/h3&gt;Рекомендуется построение модели движения денежных средств для оценки влияния сокращения поступлений на возвратность кредита.&lt;h3 class=&quot;p1&quot; id=&quot;id-1Динамикабизнеса-Рекомендацииприотрицательномзначениисигнала:&quot; style=&quot;margin: 30px 0px 0px; padding: 0px; font-size: 16px; font-weight: bold; line-height: 1.5; letter-spacing: -0.006em; text-transform: none; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: start; text-indent: 0px; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;strong&gt;Рекомендации при отрицательном&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;значении&amp;nbsp;&lt;/strong&gt;&lt;strong&gt;сигнала:&lt;/strong&gt;&lt;/h3&gt;&lt;p style=&quot;margin: 10px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;Поскольку бизнес клиента сокращается, то важно проверить как отрицательная динамика повлияет на возвратность кредита. Для этого необходимо построить CF модель и проверить как погашение кредита может повлиять на остаток денежных средств либо возникновение балансирующего кредита. Балансирующий кредит - это вынужденное привлечение кредитных средств для закрытия сформированных остатков денежных средств. Отрицательным фактором будет выступать наращивание потребности в балансирующем кредите. Также рекомендуется в качестве минимизации риска отрицательной динамики бизнеса оформить поручительство юридического лица, которое будет способно погашать как собственные обязательства, так и обязательства по договору поручительства.&lt;/p&gt;&lt;br class=&quot;Apple-interchange-newline&quot;&gt;&lt;/div&gt;" link="&lt;div class=&quot;page-metadata&quot; style=&quot;margin: -15px 0px 20px; padding: 0px; font-size: 12px; color: rgb(94, 108, 132); line-height: 1.5; font-weight: 300;&quot;&gt;&lt;ul style=&quot;margin: 0px; overflow: hidden; padding: 0px; list-style-type: none; line-height: 16px; display: inline-block; vertical-align: bottom;&quot;&gt;&lt;li class=&quot;page-metadata-modification-info&quot; style=&quot;list-style: none; float: left; padding: 0px; margin: 0px; line-height: 1.5;&quot;&gt;Создал(а)&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;author&quot;&gt;&lt;a href=&quot;https://confluence.delta.sbrf.ru/display/~23097935&quot; aria-label=&quot;создано Григорян Тигран Самвелович&quot; class=&quot;url fn confluence-userlink userlink-0&quot; data-username=&quot;23097935&quot; title=&quot;&quot; data-user-hover-bound=&quot;true&quot; style=&quot;color: rgb(94, 108, 132); text-decoration: none solid rgb(94, 108, 132); font-size: 12px; line-height: 1.5; font-weight: 300;&quot;&gt;Григорян Тигран Самвелович&lt;/a&gt;&lt;/span&gt;, редактировал(а)&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;editor&quot;&gt;&lt;a href=&quot;https://confluence.delta.sbrf.ru/display/~burnyshev-ov&quot; aria-label=&quot;модифицировано Бурнышев Олег Викторович&quot; class=&quot;url fn confluence-userlink userlink-1&quot; data-username=&quot;burnyshev-ov&quot; title=&quot;&quot; data-user-hover-bound=&quot;true&quot; style=&quot;color: rgb(94, 108, 132); text-decoration: none solid rgb(94, 108, 132); font-size: 12px; line-height: 1.5; font-weight: 300;&quot;&gt;Бурнышев Олег Викторович&lt;/a&gt;&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;a class=&quot;last-modified&quot; aria-label=&quot;отредактировано июл. 31, 2025, выберите, чтобы просмотреть изменения&quot; title=&quot;Показать изменения&quot; href=&quot;https://confluence.delta.sbrf.ru/pages/diffpagesbyversion.action?pageId=16154497310&amp;amp;selectedPageVersions=9&amp;amp;selectedPageVersions=10&quot; style=&quot;color: rgb(94, 108, 132); text-decoration: none solid rgb(94, 108, 132); font-size: 12px; line-height: 1.5; font-weight: 300;&quot;&gt;июл. 31, 2025&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul class=&quot;cw-bylines&quot; style=&quot;margin: 0px; display: inline-block; font-size: 12px; color: rgb(94, 108, 132); list-style-type: none; overflow: hidden; padding: 0px; line-height: 16px; vertical-align: top;&quot;&gt;&lt;li class=&quot;cw-byline-item&quot; style=&quot;display: inline-block; list-style: none; padding: 0px 5px 0px 0px; margin: 0px; line-height: 1.5; float: left;&quot;&gt;&lt;div id=&quot;cw-approval-byline&quot; class=&quot;cw-approval-byline&quot; style=&quot;margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: -5px !important; padding: 0px;&quot;&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;cw-byline-item&quot; style=&quot;display: inline-block; list-style: none; padding: 0px 5px 0px 0px; margin: 0px; line-height: 1.5; float: left;&quot;&gt;&lt;div id=&quot;cw-state-byline&quot; class=&quot;cw-state-byline&quot; style=&quot;margin: 0px; padding: 0px; color: rgb(204, 204, 204);&quot;&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;cw-byline-item&quot; style=&quot;display: inline-block; list-style: none; padding: 0px 5px 0px 0px; margin: 0px; line-height: 1.5; float: left;&quot;&gt;&lt;div id=&quot;cw-tasks-byline&quot; class=&quot;cw-tasks-byline&quot; style=&quot;margin: 0px; padding: 0px;&quot;&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&quot;cw-byline-item&quot; style=&quot;display: inline-block; list-style: none; padding: 0px 5px 0px 0px; margin: 0px; line-height: 1.5; float: left;&quot;&gt;&lt;div id=&quot;cw-state-alternate&quot; class=&quot;cw-state-alternate&quot; style=&quot;margin: 0px; padding: 0px;&quot;&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div id=&quot;rioja-page-message&quot; style=&quot;margin: 0px 0px 20px; padding: 0px;&quot;&gt;&lt;/div&gt;&lt;div id=&quot;main-content&quot; class=&quot;wiki-content&quot; style=&quot;margin: 0px; padding: 0px;&quot;&gt;&lt;h3 id=&quot;id-1Динамикабизнеса-Описание:&quot; style=&quot;margin: 0px; padding: 0px; font-size: 16px; font-weight: bold; line-height: 1.5; letter-spacing: -0.006em; text-transform: none; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: start; text-indent: 0px; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;strong&gt;Описание:&lt;/strong&gt;&lt;/h3&gt;Показатель указывает&amp;nbsp; на наличие изменений в объемах доходов и расходов в ретро-периоде.&amp;nbsp;&lt;br&gt;Применяется 3 показателя:&lt;br&gt;1. Динамика выручки LTM к аналогичной дате прошлого года. Например производится сравнение Выручки LTM на 01.04.2025 к этому же показателю на 01.04.2024.&lt;br&gt;2. Динамика квартальных показателей Выручки: 1.&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;span class=&quot;inline-comment-marker valid&quot; data-ref=&quot;e6c93a3e-9b7f-4526-b44a-1f70188a95b0&quot; style=&quot;background-color: rgba(246, 195, 66, 0.3);&quot;&gt;Если отрасль относится к несезонной&lt;/span&gt;, то сравнение производится анализируемого квартала к предыдущему (например 2 кв. 2025 к 1 кв.2025); 2. Если в деятельности присутствует сезонность, то сравниваются сопоставимые периоды к прошлому году (например 2 кв. 2025 ко 2 кв. 2024)&lt;br&gt;3. Динамика EBITDA LTM к аналогичной дате прошлого года. Например производится сравнение EBITDA LTM на 01.04.2025 к этому же показателю на 01.04.2024.&lt;br&gt;&lt;strong&gt;EBITDA&lt;/strong&gt;&lt;span style=&quot;color: rgb(64, 64, 64);&quot;&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;(Earnings Before Interest, Taxes, Depreciation and Amortization) — прибыль до вычета процентов, налогов и амортизации. Показывает&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;операционную рентабельность&lt;span style=&quot;color: rgb(64, 64, 64);&quot;&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;без учёта структуры капитала и налогов.&lt;/span&gt;&lt;h3 class=&quot;p1&quot; id=&quot;id-1Динамикабизнеса-Условияприменимости:&quot; style=&quot;margin: 30px 0px 0px; padding: 0px; font-size: 16px; font-weight: bold; line-height: 1.5; letter-spacing: -0.006em; text-transform: none; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: start; text-indent: 0px; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;strong&gt;&lt;span class=&quot;inline-comment-marker valid&quot; data-ref=&quot;14b41cde-b1af-41ab-9a6e-298669a07f14&quot; style=&quot;background-color: rgba(246, 195, 66, 0.3);&quot;&gt;Условия применимости:&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p style=&quot;margin: 10px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;Оцениваются все показатели по всем клиентам.&lt;/p&gt;&lt;p style=&quot;margin: 10px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;strong style=&quot;font-size: 16px; letter-spacing: -0.006em;&quot;&gt;Возможные значения:&lt;span class=&quot;apple-converted-space&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p style=&quot;margin: 10px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;Положительным моментом является одновременный рост Выручки и EBITDA.&lt;/p&gt;&lt;p style=&quot;margin: 10px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;Удовлетворительным индикатором является:&lt;/p&gt;&lt;ul style=&quot;margin: 10px 0px 0px; list-style-type: square; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;li&gt;сокращение выручки на 10% при сохранении либо увеличении EBITDA.&lt;/li&gt;&lt;/ul&gt;&lt;ul style=&quot;margin: 10px 0px 0px; list-style-type: square; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;li class=&quot;ds-markdown-paragraph&quot;&gt;сокращение EBITDA показателя до 10%.&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;p1&quot; id=&quot;id-1Динамикабизнеса-Рекомендацииприудовлетворительномзначениисигнала:&quot; style=&quot;margin: 30px 0px 0px; padding: 0px; font-size: 16px; font-weight: bold; line-height: 1.5; letter-spacing: -0.006em; text-transform: none; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: start; text-indent: 0px; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;strong&gt;Рекомендации при удовлетворительном значении сигнала:&lt;/strong&gt;&lt;/h3&gt;Рекомендуется построение модели движения денежных средств для оценки влияния сокращения поступлений на возвратность кредита.&lt;h3 class=&quot;p1&quot; id=&quot;id-1Динамикабизнеса-Рекомендацииприотрицательномзначениисигнала:&quot; style=&quot;margin: 30px 0px 0px; padding: 0px; font-size: 16px; font-weight: bold; line-height: 1.5; letter-spacing: -0.006em; text-transform: none; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; text-align: start; text-indent: 0px; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;strong&gt;Рекомендации при отрицательном&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;значении&amp;nbsp;&lt;/strong&gt;&lt;strong&gt;сигнала:&lt;/strong&gt;&lt;/h3&gt;&lt;p style=&quot;margin: 10px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Segoe UI&amp;quot;, Roboto, Oxygen, Ubuntu, &amp;quot;Fira Sans&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;Поскольку бизнес клиента сокращается, то важно проверить как отрицательная динамика повлияет на возвратность кредита. Для этого необходимо построить CF модель и проверить как погашение кредита может повлиять на остаток денежных средств либо возникновение балансирующего кредита. Балансирующий кредит - это вынужденное привлечение кредитных средств для закрытия сформированных остатков денежных средств. Отрицательным фактором будет выступать наращивание потребности в балансирующем кредите. Также рекомендуется в качестве минимизации риска отрицательной динамики бизнеса оформить поручительство юридического лица, которое будет способно погашать как собственные обязательства, так и обязательства по договору поручительства.&lt;/p&gt;&lt;br class=&quot;Apple-interchange-newline&quot;&gt;&lt;/div&gt;" id="kW_1GkDuVryrUP6SlwmR-3">
          <mxCell style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="910" y="7300" width="560" height="890" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="655VygiofIzxvnDOd8sb-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="655VygiofIzxvnDOd8sb-1" target="kW_1GkDuVryrUP6SlwmR-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="655VygiofIzxvnDOd8sb-1" value="Вы — CreditDecisionAgent, экспертная система для автоматического принятия решений по онлайн-заявкам на кредит в крупном банке.  &#xa;Ваша задача: провести детальный анализ каждого критерия, используя актуальные методологические требования, и выдать итоговое решение в строгом JSON-формате.&#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 1. Input Data&#xa;&#xa;&#xa;Блок 1 – АС УФА: &lt;данные&gt;  &#xa;Блок 2 – Рейтинг: &lt;данные&gt;  &#xa;Блок 3 – ОКС: &lt;данные&gt;  &#xa;Блок 4 – Cashflow: &lt;данные&gt;  &#xa;Блок 5 – Кредитная история: &lt;данные&gt;  &#xa;Блок 6 – АС УФА (заключение): &lt;данные&gt;  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 2. Criteria Definitions&#xa;&#xa;&#xa;&#xa;&#xa;{{criteria_definitions}}&#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 3. Core Logic&#xa;**Custom Chain of Thought:**&#xa;Для каждого критерия:&#xa;- explanation: «Проверяем [Название]: значение = X, порог = Y»&#xa;- status: «ХОРОШО», «УДОВЛЕТВОРИТЕЛЬНО» или «ПЛОХО»&#xa;- comment: пояснение  &#xa;- has_value: true/false  &#xa;- recommendation: рекомендации  &#xa;- required: true/false  &#xa;&#xa;&#xa;**Aggregation Rules:**&#xa;- Если любой обязательный критерий = «ПЛОХО» → `final_decision = &quot;ОТКАЗ&quot;`&#xa;- Если нет данных по обязательному критерию → `final_decision = &quot;ОТКАЗ&quot;`&#xa;- Если УФА = «Удовлетворительное» или «Неудовлетворительное» → `final_decision = &quot;ОТКАЗ&quot;`&#xa;- Если Рейтинг ≥ 25, ОКС = «Сокращать» или CF = «Вывод №2» → `final_decision = &quot;ОТКАЗ&quot;`&#xa;- Иначе → `final_decision = &quot;ОДОБРЕНО&quot;`&#xa;&#xa;&#xa;**Output Format (only JSON):**&#xa;```json&#xa;{&#xa;  &quot;criteria&quot;: [&#xa;    {&quot;name&quot;: &quot;...&quot;, &quot;value&quot;: &quot;...&quot;, &quot;status&quot;: &quot;ХОРОШО/УДОВЛЕТВОРИТЕЛЬНО/ПЛОХО&quot;, &quot;comment&quot;: &quot;...&quot;, &quot;recommendation&quot;: &quot;...&quot;, &quot;required&quot;: true/false, &quot;has_value&quot;: true/false}&#xa;  ],&#xa;  &quot;final_decision&quot;: &quot;ОДОБРЕНО/ОТКАЗ&quot;,&#xa;  &quot;final_comment&quot;: &quot;...&quot;&#xa;}&#xa;&#xa;&#xa;&#xa;&#xa;{{criteria_definitions}}&#xa;## Описание критериев анализа (актуализировано с учётом обязательности и взаимосвязей)&#xa;&#xa;&#xa;### 1. Динамика бизнеса *(required = true)*&#xa;**Описание:**  &#xa;Показатель отражает изменения в объёмах доходов и расходов компании в ретроспективе. Оценка ведётся по трём подпоказателям:  &#xa;1.1 **Выручка LTM** — сравнение к аналогичной дате прошлого года:  &#xa;- Рост &gt; 0% — **ХОРОШО**  &#xa;- Снижение ≤ 10% при росте или сохранении EBITDA — **УДОВЛЕТВОРИТЕЛЬНО**  &#xa;- Снижение &gt; 10% или при падении EBITDA — **ПЛОХО**  &#xa;&#xa;&#xa;1.2 **EBITDA LTM** — сравнение к аналогичной дате прошлого года:  &#xa;- Рост &gt; 0% и EBITDA &gt; 0 — **ХОРОШО**  &#xa;- Снижение ≤ 10% и EBITDA &gt; 0 — **УДОВЛЕТВОРИТЕЛЬНО**  &#xa;- Снижение &gt; 10% и/или EBITDA ≤ 0 — **ПЛОХО**  &#xa;&#xa;&#xa;1.3 **Прирост квартальной выручки** — метод зависит от сезонности:  &#xa;- Рост хотя бы в одном из 2 кварталов подряд — **ХОРОШО**  &#xa;- Снижение ≤ 10% в двух кварталах подряд — **УДОВЛЕТВОРИТЕЛЬНО**  &#xa;- Снижение &gt; 10% в двух кварталах подряд — **ПЛОХО**  &#xa;&#xa;&#xa;**Взаимосвязи:**  &#xa;- При «УДОВЛЕТВОРИТЕЛЬНО» или «ПЛОХО» требуется построение CF-модели (критерий 13).  &#xa;- Отрицательная динамика в сочетании с низким КТЛ или высоким долгом усиливает риск.  &#xa;&#xa;&#xa;**Рекомендации:**  &#xa;- УДОВЛЕТВОРИТЕЛЬНО — построить модель ДДС для оценки влияния сокращения поступлений на возвратность кредита  &#xa;- ПЛОХО — построить CF-модель, проверить балансирующий кредит, оформить поручительство платёжеспособного юр. лица  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 2. Оборачиваемость запасов LTM (дни) *(required = true)*&#xa;**Описание:**  &#xa;Отражает период обновления запасов. Сравнивается со среднеотраслевым показателем по ОКК.  &#xa;- Превышение ≤ 10% — **ХОРОШО**  &#xa;- Превышение &gt; 10% и ≤ 20% — **УДОВЛЕТВОРИТЕЛЬНО** (получить пояснения, подтвердить отсутствие неликвидов)  &#xa;- Превышение &gt; 20% — **ПЛОХО** (проверка запасов, поручительство, залог)  &#xa;&#xa;&#xa;**Взаимосвязи:**  &#xa;- Высокое отклонение при низком КТЛ усиливает риск.  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 3. Оборачиваемость дебиторской задолженности LTM *(required = true)*&#xa;**Описание:**  &#xa;Отражает скорость получения оплаты. Сравнивается со среднеотраслевым по ОКК.  &#xa;- Превышение ≤ 10% — **ХОРОШО**  &#xa;- Превышение &gt; 10% и ≤ 20% — **УДОВЛЕТВОРИТЕЛЬНО** (пояснения, отсутствие просрочки)  &#xa;- Превышение &gt; 20% — **ПЛОХО** (пояснения, проверка долгов &gt;5% без движения &gt; квартал, поручительство)  &#xa;&#xa;&#xa;**Взаимосвязи:**  &#xa;- Высокая ДЗ при низком КТЛ усиливает риск ликвидности.  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 4. Оборачиваемость кредиторской задолженности LTM *(required = true)*&#xa;**Описание:**  &#xa;Показывает сроки оплаты поставщикам.  &#xa;- Отклонение ≤ 10% — **ХОРОШО**  &#xa;- Отклонение &gt; 10% и ≤ 20% — **УДОВЛЕТВОРИТЕЛЬНО** (пояснения)  &#xa;- Отклонение &gt; 20% — **ПЛОХО** (пояснения, соглашения о статусе долга, поручительство/субординация)  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 5. ICR LTM *(required = true)*&#xa;**Описание:**  &#xa;Коэффициент покрытия процентов.  &#xa;- &gt; 1.5 — **ХОРОШО**  &#xa;- &gt; 1.0 и ≤ 1.5 — **УДОВЛЕТВОРИТЕЛЬНО** (поручительство)  &#xa;- ≤ 1.0 — **ПЛОХО** (доп. источники, поручительство)  &#xa;&#xa;&#xa;**Взаимосвязи:**  &#xa;- Низкий ICR при высокой долговой нагрузке усиливает риск.  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 6. Долговая нагрузка *(required = true)*&#xa;**Описание:**  &#xa;Оценивается по Чистый долг/EBITDA и Чистый долг/Выручка LTM.  &#xa;- Ниже порогового значения ОКС — **ХОРОШО**  &#xa;- В пределах допустимого диапазона — **УДОВЛЕТВОРИТЕЛЬНО** (субординация обязательств)  &#xa;- Выше верхнего порога или отрицательная EBITDA — **ПЛОХО** (субординация, доп. доходность, поручительство)  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 7. Текущая ликвидность (КТЛ) *(required = true)*&#xa;**Описание:**  &#xa;- ≥ 1.5 — **ХОРОШО**  &#xa;- ≥ 1.0 и &lt; 1.5 — **УДОВЛЕТВОРИТЕЛЬНО** (субординация займов связанных компаний)  &#xa;- &lt; 1.0 — **ПЛОХО** (субординация, поручительство, залог)  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 8. Рентабельность бизнеса *(required = false)*&#xa;- ≥ 0 — **ХОРОШО**  &#xa;- &lt; 0 — **ПЛОХО** (CF-модель)  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 9. Доля чистых активов (ЧА) *(required = true)*&#xa;- ≥ 20% — **ХОРОШО**  &#xa;- &gt; 0% и &lt; 20% — **УДОВЛЕТВОРИТЕЛЬНО** (ограничение долга и долг/EBITDA)  &#xa;- ≤ 0% — **ПЛОХО** (отказ)  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 10. Рейтинг *(required = true)*&#xa;- 1–17 — **ХОРОШО**  &#xa;- 18–22 — **УДОВЛЕТВОРИТЕЛЬНО** (доп. залог ≥ 60% суммы кредита, доп. доходность)  &#xa;- 23–24 — **ПЛОХО** (залог ≥ 100%, поручительство, доп. доходность)  &#xa;- 25–26 — **ПЛОХО** (отказ)  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 11. Собственный оборотный капитал (СОК) *(required = false)*&#xa;- ≥ 0 — **ХОРОШО**  &#xa;- &lt; 0 — **ПЛОХО** (субординация займов, поручительство)  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 12. Соответствие сделки ОКС *(required = true)*&#xa;- «Наращивать» или «Держать» — **ХОРОШО**  &#xa;- «Сокращать» — **ПЛОХО** (изменение структуры сделки, повторная оценка)  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 13. Вывод CF-модели *(required = true)*&#xa;- «Вывод №1» — **ХОРОШО**  &#xa;- «Вывод №2» — **ПЛОХО** (уменьшить сумму, скорректировать срок/график, поручительство)  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 14. Кредитная история *(required = true)*&#xa;- Нет просрочек ≥ 5 дней за последние 180 дней — **ХОРОШО**  &#xa;- 1 просрочка ≤ 5 дней — **УДОВЛЕТВОРИТЕЛЬНО**  &#xa;- ≥ 2 просрочек и/или любая &gt; 5 дней — **ПЛОХО** (поручительство, CF-модель с сезонностью)  &#xa;&#xa;&#xa;---&#xa;&#xa;&#xa;### 15. УФА (автовывод) *(required = true)*&#xa;- «Хорошее» — **ХОРОШО**  &#xa;- «Удовлетворительное» — **ПЛОХО** (решение не принимается, нужны меры)  &#xa;- «Неудовлетворительное» — **ПЛОХО** (автоотказ)  &#xa;&#xa;&#xa;---" style="text;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="900" y="8220" width="560" height="3820" as="geometry" />
        </mxCell>
        <UserObject label="Я помогу вам запустить юнит тесты в проекте AI Gateway. Сначала давайте посмотрим на структуру проекта и конфигурацию тестов.&#xa;&#xa;&#xa;&#xa;&#xa;[3 tools called]&#xa;&#xa;&#xa;Теперь давайте посмотрим на структуру тестов:&#xa;&#xa;&#xa;&#xa;&#xa;[2 tools called]&#xa;&#xa;&#xa;Отлично! Теперь я вижу структуру проекта. Для запуска юнит тестов в проекте AI Gateway используйте следующие команды:&#xa;&#xa;&#xa;## Запуск юнит тестов&#xa;&#xa;&#xa;### 1. Запуск всех тестов&#xa;```bash&#xa;poetry run pytest&#xa;```&#xa;&#xa;&#xa;### 2. Запуск только юнит тестов&#xa;```bash&#xa;poetry run pytest tests/unit/&#xa;```&#xa;&#xa;&#xa;### 3. Запуск с подробным выводом&#xa;```bash&#xa;poetry run pytest tests/unit/ -v&#xa;```&#xa;&#xa;&#xa;### 4. Запуск конкретного теста&#xa;```bash&#xa;poetry run pytest tests/unit/test_config.py&#xa;```&#xa;&#xa;&#xa;### 5. Запуск с покрытием кода&#xa;```bash&#xa;poetry run pytest tests/unit/ --cov=src/aigw_service&#xa;```&#xa;&#xa;&#xa;## Дополнительные опции&#xa;&#xa;&#xa;### Запуск тестов в параллельном режиме&#xa;```bash&#xa;poetry run pytest tests/unit/ -n auto&#xa;```&#xa;&#xa;&#xa;### Запуск только быстрых тестов (без интеграционных)&#xa;```bash&#xa;poetry run pytest tests/unit/ -m &quot;not slow&quot;&#xa;```&#xa;&#xa;&#xa;### Запуск с остановкой на первой ошибке&#xa;```bash&#xa;poetry run pytest tests/unit/ -x&#xa;```&#xa;&#xa;&#xa;## Конфигурация тестов&#xa;&#xa;&#xa;Согласно `pyproject.toml`, тесты настроены с:&#xa;- **Python path**: включает корневую директорию и `src`&#xa;- **Asyncio mode**: автоматический режим для асинхронных тестов&#xa;- **Опции**: `-s --verbose -W ignore::DeprecationWarning`&#xa;&#xa;&#xa;## Структура тестов&#xa;&#xa;&#xa;В проекте есть:&#xa;- **Юнит тесты** (`tests/unit/`) - тестирование отдельных компонентов&#xa;- **Интеграционные тесты** (`tests/integration_tests/`) - тестирование взаимодействия компонентов&#xa;&#xa;&#xa;## Быстрый тест&#xa;&#xa;&#xa;Для быстрого тестирования API без pytest можно использовать готовые скрипты:&#xa;```bash&#xa;# Быстрый тест чата&#xa;python3 test_chat_quick.py&#xa;&#xa;&#xa;# Тест поддержки АС&#xa;python3 test_as_chat.py&#xa;```&#xa;&#xa;&#xa;Рекомендую начать с команды `poetry run pytest tests/unit/ -v` для запуска всех юнит тестов с подробным выводом." link="Я помогу вам запустить юнит тесты в проекте AI Gateway. Сначала давайте посмотрим на структуру проекта и конфигурацию тестов.&#xa;&#xa;&#xa;&#xa;&#xa;[3 tools called]&#xa;&#xa;&#xa;Теперь давайте посмотрим на структуру тестов:&#xa;&#xa;&#xa;&#xa;&#xa;[2 tools called]&#xa;&#xa;&#xa;Отлично! Теперь я вижу структуру проекта. Для запуска юнит тестов в проекте AI Gateway используйте следующие команды:&#xa;&#xa;&#xa;## Запуск юнит тестов&#xa;&#xa;&#xa;### 1. Запуск всех тестов&#xa;```bash&#xa;poetry run pytest&#xa;```&#xa;&#xa;&#xa;### 2. Запуск только юнит тестов&#xa;```bash&#xa;poetry run pytest tests/unit/&#xa;```&#xa;&#xa;&#xa;### 3. Запуск с подробным выводом&#xa;```bash&#xa;poetry run pytest tests/unit/ -v&#xa;```&#xa;&#xa;&#xa;### 4. Запуск конкретного теста&#xa;```bash&#xa;poetry run pytest tests/unit/test_config.py&#xa;```&#xa;&#xa;&#xa;### 5. Запуск с покрытием кода&#xa;```bash&#xa;poetry run pytest tests/unit/ --cov=src/aigw_service&#xa;```&#xa;&#xa;&#xa;## Дополнительные опции&#xa;&#xa;&#xa;### Запуск тестов в параллельном режиме&#xa;```bash&#xa;poetry run pytest tests/unit/ -n auto&#xa;```&#xa;&#xa;&#xa;### Запуск только быстрых тестов (без интеграционных)&#xa;```bash&#xa;poetry run pytest tests/unit/ -m &quot;not slow&quot;&#xa;```&#xa;&#xa;&#xa;### Запуск с остановкой на первой ошибке&#xa;```bash&#xa;poetry run pytest tests/unit/ -x&#xa;```&#xa;&#xa;&#xa;## Конфигурация тестов&#xa;&#xa;&#xa;Согласно `pyproject.toml`, тесты настроены с:&#xa;- **Python path**: включает корневую директорию и `src`&#xa;- **Asyncio mode**: автоматический режим для асинхронных тестов&#xa;- **Опции**: `-s --verbose -W ignore::DeprecationWarning`&#xa;&#xa;&#xa;## Структура тестов&#xa;&#xa;&#xa;В проекте есть:&#xa;- **Юнит тесты** (`tests/unit/`) - тестирование отдельных компонентов&#xa;- **Интеграционные тесты** (`tests/integration_tests/`) - тестирование взаимодействия компонентов&#xa;&#xa;&#xa;## Быстрый тест&#xa;&#xa;&#xa;Для быстрого тестирования API без pytest можно использовать готовые скрипты:&#xa;```bash&#xa;# Быстрый тест чата&#xa;python3 test_chat_quick.py&#xa;&#xa;&#xa;# Тест поддержки АС&#xa;python3 test_as_chat.py&#xa;```&#xa;&#xa;&#xa;Рекомендую начать с команды `poetry run pytest tests/unit/ -v` для запуска всех юнит тестов с подробным выводом." id="5IHkVXNPXtW-t5hTtuE6-1">
          <mxCell style="text;whiteSpace=wrap;" parent="1" vertex="1">
            <mxGeometry x="680" y="30" width="560" height="1590" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="#!/usr/bin/env python3&#xa;&quot;&quot;&quot;&#xa;VND KB CLI — минимальный, но боевой скелет пайплайна:&#xa;  DOCX → Pandoc AST → секции/чанки → метаданные → объекты (summary/keywords/questions)&#xa;  → SQLite (метаданные+объекты) → экспорт JSONL&#xa;&#xa;Зависимости (Python 3.10+):&#xa;  pip install typer[all] pydantic rapidfuzz python-docx&#xa;&#xa;Внешние инструменты:&#xa;  pandoc (должен быть в PATH)&#xa;&#xa;Примеры запуска:&#xa;  python vnd_kb_cli.py ingest path/to/file.docx --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli.py parse   --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli.py build-kb --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli.py export-jsonl --doc-id DOC123 --out data.jsonl&#xa;&#xa;Структура SQLite (файл по умолчанию: vnd_kb.sqlite):&#xa;  documents, sections, objects, terms&#xa;&#xa;Важно: LLM-вызовы здесь заглушены (см. LLMClientStub). Подключи свою реализацию.&#xa;&quot;&quot;&quot;&#xa;from __future__ import annotations&#xa;&#xa;import concurrent.futures&#xa;import dataclasses&#xa;import hashlib&#xa;import json&#xa;import os&#xa;import re&#xa;import sqlite3&#xa;import subprocess&#xa;import sys&#xa;import time&#xa;from dataclasses import dataclass&#xa;from pathlib import Path&#xa;from typing import Any, Dict, Iterable, List, Literal, Optional, Tuple&#xa;&#xa;import typer&#xa;from pydantic import BaseModel, Field&#xa;from rapidfuzz import fuzz, process as rf_process&#xa;from docx import Document as DocxDocument&#xa;&#xa;app = typer.Typer(add_completion=False, help=&quot;VND KB CLI — DOCX → KB&quot;)&#xa;&#xa;DB_PATH = os.environ.get(&quot;VND_KB_DB&quot;, &quot;vnd_kb.sqlite&quot;)&#xa;CACHE_DIR = Path(os.environ.get(&quot;VND_KB_CACHE&quot;, &quot;.vnd_kb_cache&quot;))&#xa;CACHE_DIR.mkdir(parents=True, exist_ok=True)&#xa;&#xa;# ======================&#xa;#     Data Models&#xa;# ======================&#xa;class VersionInfo(BaseModel):&#xa;    number: str&#xa;    date: Optional[str] = None&#xa;    status: Optional[str] = None&#xa;&#xa;class Owner(BaseModel):&#xa;    role: Optional[str] = None&#xa;    person: str&#xa;&#xa;class DocMeta(BaseModel):&#xa;    doc_id: str&#xa;    title: str&#xa;    description: Optional[str] = None&#xa;    owners: List[Owner] = []&#xa;    versions: List[VersionInfo] = []&#xa;    effective_date: Optional[str] = None&#xa;    department: Optional[str] = None&#xa;    document_type: Optional[str] = None&#xa;&#xa;class KBObject(BaseModel):&#xa;    object_id: str&#xa;    section_id: str&#xa;    kind: Literal[&quot;summary&quot;, &quot;keywords&quot;, &quot;questions&quot;]&#xa;    payload: Dict[str, Any]&#xa;    meta: Dict[str, Any]&#xa;&#xa;@dataclass&#xa;class Heading:&#xa;    block_idx: int&#xa;    level: int&#xa;    text: str&#xa;    number: Optional[str]&#xa;&#xa;# ======================&#xa;#     Utils&#xa;# ======================&#xa;&#xa;def stable_id(*parts: Optional[str]) -&gt; str:&#xa;    return hashlib.sha1(&quot;||&quot;.join([p or &quot;&quot; for p in parts]).encode(&quot;utf-8&quot;)).hexdigest()[:16]&#xa;&#xa;&#xa;def approx_tokens(s: str) -&gt; int:&#xa;    # грубая оценка токенов&#xa;    return max(1, len(s) // 4)&#xa;&#xa;&#xa;def ensure_db(conn: sqlite3.Connection) -&gt; None:&#xa;    conn.execute(&#xa;        &quot;&quot;&quot;&#xa;        CREATE TABLE IF NOT EXISTS documents (&#xa;            doc_id TEXT,&#xa;            version TEXT,&#xa;            title TEXT,&#xa;            description TEXT,&#xa;            meta_json TEXT,&#xa;            source_hash TEXT,&#xa;            created_at INTEGER,&#xa;            PRIMARY KEY (doc_id, version)&#xa;        )&#xa;        &quot;&quot;&quot;&#xa;    )&#xa;    conn.execute(&#xa;        &quot;&quot;&quot;&#xa;        CREATE TABLE IF NOT EXISTS sections (&#xa;            section_id TEXT PRIMARY KEY,&#xa;            doc_id TEXT,&#xa;            version TEXT,&#xa;            level INTEGER,&#xa;            section_number TEXT,&#xa;            title TEXT,&#xa;            title_path TEXT,&#xa;            start_block_idx INTEGER,&#xa;            end_block_idx INTEGER,&#xa;            content_hash TEXT&#xa;        )&#xa;        &quot;&quot;&quot;&#xa;    )&#xa;    conn.execute(&#xa;        &quot;&quot;&quot;&#xa;        CREATE TABLE IF NOT EXISTS objects (&#xa;            object_id TEXT PRIMARY KEY,&#xa;            section_id TEXT,&#xa;            kind TEXT,&#xa;            payload_json TEXT,&#xa;            meta_json TEXT&#xa;        )&#xa;        &quot;&quot;&quot;&#xa;    )&#xa;    conn.execute(&#xa;        &quot;&quot;&quot;&#xa;        CREATE TABLE IF NOT EXISTS terms (&#xa;            id TEXT PRIMARY KEY,&#xa;            doc_id TEXT,&#xa;            section_id TEXT,&#xa;            term TEXT,&#xa;            normalized TEXT,&#xa;            kind TEXT,&#xa;            definition TEXT&#xa;        )&#xa;        &quot;&quot;&quot;&#xa;    )&#xa;    conn.commit()&#xa;&#xa;# ======================&#xa;#     Pandoc &amp; OOXML&#xa;# ======================&#xa;&#xa;def run_pandoc_ast(docx_path: Path) -&gt; Dict[str, Any]:&#xa;    out = subprocess.check_output([&#xa;        &quot;pandoc&quot;,&#xa;        str(docx_path),&#xa;        &quot;--to=json&quot;,&#xa;        &quot;--wrap=none&quot;,&#xa;        &quot;--track-changes=accept&quot;,&#xa;    ])&#xa;    return json.loads(out)&#xa;&#xa;&#xa;def cache_write(path: Path, data: Any) -&gt; None:&#xa;    path.write_text(json.dumps(data, ensure_ascii=False, indent=2), encoding=&quot;utf-8&quot;)&#xa;&#xa;&#xa;def cache_read(path: Path) -&gt; Any:&#xa;    return json.loads(path.read_text(encoding=&quot;utf-8&quot;))&#xa;&#xa;&#xa;def doc_source_hash(docx_path: Path) -&gt; str:&#xa;    data = docx_path.read_bytes()&#xa;    return hashlib.sha256(data).hexdigest()&#xa;&#xa;# ======================&#xa;#     AST helpers&#xa;# ======================&#xa;&#xa;def iter_blocks(ast: Dict[str, Any]) -&gt; List[Dict[str, Any]]:&#xa;    return ast[&quot;blocks&quot;]&#xa;&#xa;&#xa;def inlines_to_text(inlines: List[Dict[str, Any]]) -&gt; str:&#xa;    parts: List[str] = []&#xa;    for x in inlines:&#xa;        t = x.get(&quot;t&quot;)&#xa;        c = x.get(&quot;c&quot;)&#xa;        if t == &quot;Str&quot;:&#xa;            parts.append(c)&#xa;        elif t == &quot;Space&quot;:&#xa;            parts.append(&quot; &quot;)&#xa;        elif t == &quot;SoftBreak&quot;:&#xa;            parts.append(&quot;\n&quot;)&#xa;        elif t == &quot;Code&quot;:&#xa;            parts.append(c[1] if isinstance(c, list) else str(c))&#xa;        elif t in (&quot;Emph&quot;, &quot;Strong&quot;, &quot;Strikeout&quot;, &quot;SmallCaps&quot;, &quot;Superscript&quot;, &quot;Subscript&quot;):&#xa;            # рекурсивно раскрываем&#xa;            parts.append(inlines_to_text(c))&#xa;        elif t == &quot;Span&quot; and isinstance(c, list) and len(c) == 3:&#xa;            parts.append(inlines_to_text(c[2]))&#xa;        # прочие типы игнорируем для простоты&#xa;    return &quot;&quot;.join(parts).strip()&#xa;&#xa;&#xa;def extract_headings(blocks: List[Dict[str, Any]]) -&gt; List[Heading]:&#xa;    hs: List[Heading] = []&#xa;    for i, b in enumerate(blocks):&#xa;        if b.get(&quot;t&quot;) == &quot;Header&quot;:&#xa;            level = b[&quot;c&quot;][0]&#xa;            inlines = b[&quot;c&quot;][2]&#xa;            text = inlines_to_text(inlines)&#xa;            # Попробуем вытащить явный номер в начале (&quot;1.&quot;, &quot;1.2.&quot;, &quot;1.2.3&quot;)&#xa;            m = re.match(r&quot;^([0-9]+(?:\.[0-9]+)*)[\.)\s]+(.+)$&quot;, text)&#xa;            number = m.group(1) if m else None&#xa;            if m:&#xa;                text = m.group(2).strip()&#xa;            hs.append(Heading(block_idx=i, level=level, text=text, number=number))&#xa;    return hs&#xa;&#xa;&#xa;def section_spans(blocks: List[Dict[str, Any]], hs: List[Heading]) -&gt; List[Tuple[int, int, Heading]]:&#xa;    spans: List[Tuple[int, int, Heading]] = []&#xa;    for idx, h in enumerate(hs):&#xa;        start = h.block_idx + 1&#xa;        end = (hs[idx + 1].block_idx - 1) if idx + 1 &lt; len(hs) else len(blocks) - 1&#xa;        spans.append((start, end, h))&#xa;    return spans&#xa;&#xa;&#xa;def blocks_to_text(blocks: List[Dict[str, Any]], start: int, end: int) -&gt; str:&#xa;    out: List[str] = []&#xa;    for i in range(start, max(start, end) + 1):&#xa;        b = blocks[i]&#xa;        t = b.get(&quot;t&quot;)&#xa;        if t in (&quot;Para&quot;, &quot;Plain&quot;):&#xa;            out.append(inlines_to_text(b.get(&quot;c&quot;, [])))&#xa;        elif t == &quot;CodeBlock&quot;:&#xa;            content = b.get(&quot;c&quot;, [None, &quot;&quot;]) [1]&#xa;            out.append(content)&#xa;        elif t == &quot;BlockQuote&quot;:&#xa;            inner = b.get(&quot;c&quot;, [])&#xa;            if isinstance(inner, list):&#xa;                out.append(blocks_to_text(inner, 0, len(inner)-1))&#xa;        # Списки/таблицы можно доработать при необходимости&#xa;    return &quot;\n&quot;.join([x for x in out if x]).strip()&#xa;&#xa;# ======================&#xa;#     TOC helpers&#xa;# ======================&#xa;&#xa;def normalize_title(s: str) -&gt; str:&#xa;    return re.sub(r&quot;\s+&quot;, &quot; &quot;, s.strip().lower().rstrip(&quot;.:&quot;) )&#xa;&#xa;&#xa;def match_toc_to_headings(toc_items: List[str], headings: List[Heading]) -&gt; List[Tuple[int, Optional[int]]]:&#xa;    norm_heads = [f&quot;{h.number + &#39; &#39; if h.number else &#39;&#39;}{h.text}&quot; for h in headings]&#xa;    norm_heads = [normalize_title(x) for x in norm_heads]&#xa;    results: List[Tuple[int, Optional[int]]] = []&#xa;    for i, item in enumerate(toc_items):&#xa;        ni = normalize_title(item)&#xa;        # точное совпадение&#xa;        if ni in norm_heads:&#xa;            results.append((i, norm_heads.index(ni)))&#xa;            continue&#xa;        # fuzzy&#xa;        match = rf_process.extractOne(ni, norm_heads, scorer=fuzz.WRatio)&#xa;        if match and match[1] &gt;= 90:&#xa;            results.append((i, match[2]))&#xa;        else:&#xa;            results.append((i, None))&#xa;    return results&#xa;&#xa;# ======================&#xa;#     Chunking&#xa;# ======================&#xa;&#xa;def make_title_path(headings: List[Heading], idx: int) -&gt; List[str]:&#xa;    # Примитивно: берем цепочку уровней к текущему&#xa;    path: List[str] = []&#xa;    cur_level = headings[idx].level&#xa;    path.append(headings[idx].text)&#xa;    j = idx - 1&#xa;    while j &gt;= 0:&#xa;        if headings[j].level &lt; cur_level:&#xa;            path.insert(0, headings[j].text)&#xa;            cur_level = headings[j].level&#xa;        j -= 1&#xa;    return path&#xa;&#xa;&#xa;def chunk_section_text(text: str, max_tokens: int = 2048, overlap_tokens: int = 256) -&gt; List[str]:&#xa;    if approx_tokens(text) &lt;= max_tokens:&#xa;        return [text]&#xa;    words = text.split()&#xa;    # делим по словам примерно под размер&#xa;    chunks: List[str] = []&#xa;    cur: List[str] = []&#xa;    cur_tokens = 0&#xa;    for w in words:&#xa;        t = approx_tokens(w + &quot; &quot;)&#xa;        if cur_tokens + t &gt; max_tokens:&#xa;            chunks.append(&quot; &quot;.join(cur).strip())&#xa;            # overlap&#xa;            if overlap_tokens &gt; 0 and chunks[-1]:&#xa;                tail_words = chunks[-1].split()[-min(len(chunks[-1].split()), overlap_tokens):]&#xa;                cur = tail_words.copy()&#xa;                cur_tokens = approx_tokens(&quot; &quot;.join(cur))&#xa;            else:&#xa;                cur = []&#xa;                cur_tokens = 0&#xa;        cur.append(w)&#xa;        cur_tokens += t&#xa;    if cur:&#xa;        chunks.append(&quot; &quot;.join(cur).strip())&#xa;    return [c for c in chunks if c]&#xa;&#xa;# ======================&#xa;#     LLM Stub&#xa;# ======================&#xa;class LLMClientStub:&#xa;    &quot;&quot;&quot;Заглушка под твой LLM-клиент. Заменить на реальные вызовы (OpenAI/GigaChat и пр.).&quot;&quot;&quot;&#xa;    def extract_doc_meta(self, text: str) -&gt; DocMeta:&#xa;        # Псевдо-логика: берем первую строку как title&#xa;        title = text.splitlines()[0].strip() if text.strip() else &quot;Untitled&quot;&#xa;        return DocMeta(doc_id=&quot;&quot;, title=title, description=None, owners=[], versions=[])&#xa;&#xa;    def make_objects_for_chunk(self, *, doc_id: str, version: str, section_id: str, chunk_text: str, full_text: str, position: Dict[str, int]) -&gt; List[KBObject]:&#xa;        # Возвращаем минимальные заглушки&#xa;        base_meta = {&quot;doc_id&quot;: doc_id, &quot;version&quot;: version, &quot;position&quot;: position, &quot;full_text&quot;: full_text}&#xa;        objs: List[KBObject] = []&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;summary&quot;, hashlib.sha1(chunk_text.encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;summary&quot;,&#xa;                payload={&quot;text&quot;: chunk_text[:500]},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        kws = list({w.strip(&quot;,.()[]&quot;).lower() for w in chunk_text.split() if len(w) &gt; 5})[:15]&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;keywords&quot;, hashlib.sha1((chunk_text+&quot;k&quot;).encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;keywords&quot;,&#xa;                payload={&quot;items&quot;: kws},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        qs = [{&quot;q&quot;: f&quot;О чём этот раздел? ({i})&quot;, &quot;type&quot;: &quot;base&quot;} for i in range(1, 6)]&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;questions&quot;, hashlib.sha1((chunk_text+&quot;q&quot;).encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;questions&quot;,&#xa;                payload={&quot;items&quot;: qs},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        return objs&#xa;&#xa;# ======================&#xa;#     DB helpers&#xa;# ======================&#xa;&#xa;def db_connect() -&gt; sqlite3.Connection:&#xa;    conn = sqlite3.connect(DB_PATH)&#xa;    conn.execute(&quot;PRAGMA journal_mode=WAL&quot;)&#xa;    conn.execute(&quot;PRAGMA synchronous=NORMAL&quot;)&#xa;    return conn&#xa;&#xa;# ======================&#xa;#     CLI Commands&#xa;# ======================&#xa;@app.command()&#xa;def ingest(&#xa;    docx_path: Path = typer.Argument(..., exists=True, readable=True, help=&quot;DOCX-файл&quot;),&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;, help=&quot;ID документа&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;, help=&quot;Версия документа&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Конвертация DOCX → Pandoc AST (кэш) и запись документа в БД (мета пустая).&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    ast_cache = CACHE_DIR / f&quot;{doc_id}__{version}.pandoc.json&quot;&#xa;    h = doc_source_hash(docx_path)&#xa;    typer.echo(f&quot;[ingest] pandoc {docx_path} → {ast_cache}&quot;)&#xa;    ast = run_pandoc_ast(docx_path)&#xa;    cache_write(ast_cache, ast)&#xa;    # create/replace document row&#xa;    conn.execute(&#xa;        &quot;REPLACE INTO documents(doc_id, version, title, description, meta_json, source_hash, created_at) VALUES (?,?,?,?,?,?,?)&quot;,&#xa;        (doc_id, version, &quot;&quot;, None, json.dumps({}), h, int(time.time())),&#xa;    )&#xa;    conn.commit()&#xa;    typer.echo(&quot;[ingest] done&quot;)&#xa;&#xa;&#xa;@app.command()&#xa;def parse(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Разбор структуры: заголовки → секции, извлечение текста, запись в БД.&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    ast_cache = CACHE_DIR / f&quot;{doc_id}__{version}.pandoc.json&quot;&#xa;    if not ast_cache.exists():&#xa;        typer.secho(&quot;AST cache not found. Run ingest first.&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;    ast = cache_read(ast_cache)&#xa;    blocks = iter_blocks(ast)&#xa;    heads = extract_headings(blocks)&#xa;    spans = section_spans(blocks, heads)&#xa;&#xa;    # Очистим прошлые секции/объекты&#xa;    conn.execute(&quot;DELETE FROM sections WHERE doc_id=? AND version=?&quot;, (doc_id, version))&#xa;    conn.execute(&quot;DELETE FROM objects  WHERE section_id IN (SELECT section_id FROM sections WHERE doc_id=? AND version=?)&quot;, (doc_id, version))&#xa;&#xa;    for idx, (start, end, h) in enumerate(spans):&#xa;        text = blocks_to_text(blocks, start, end)&#xa;        title_path = make_title_path(heads, idx)&#xa;        section_id = stable_id(doc_id, version, &quot;/&quot;.join(title_path))&#xa;        content_hash = hashlib.sha1(text.encode(&quot;utf-8&quot;)).hexdigest()&#xa;        conn.execute(&#xa;            &quot;&quot;&quot;&#xa;            INSERT OR REPLACE INTO sections(section_id, doc_id, version, level, section_number, title, title_path, start_block_idx, end_block_idx, content_hash)&#xa;            VALUES (?,?,?,?,?,?,?,?,?,?)&#xa;            &quot;&quot;&quot;,&#xa;            (&#xa;                section_id,&#xa;                doc_id,&#xa;                version,&#xa;                h.level,&#xa;                h.number,&#xa;                h.text,&#xa;                json.dumps(title_path, ensure_ascii=False),&#xa;                start,&#xa;                end,&#xa;                content_hash,&#xa;            ),&#xa;        )&#xa;    conn.commit()&#xa;    typer.echo(f&quot;[parse] sections stored: {len(spans)}&quot;)&#xa;&#xa;&#xa;@app.command(&quot;extract-meta&quot;)&#xa;def extract_meta(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;    first_blocks: int = typer.Option(60, help=&quot;Сколько первых блоков отдавать LLM&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Извлечение метаданных из начала документа (LLM или эвристики).&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    ast_cache = CACHE_DIR / f&quot;{doc_id}__{version}.pandoc.json&quot;&#xa;    if not ast_cache.exists():&#xa;        typer.secho(&quot;AST cache not found. Run ingest first.&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;    ast = cache_read(ast_cache)&#xa;    blocks = iter_blocks(ast)&#xa;&#xa;    # Собираем первые N блоков в текст&#xa;    def block_to_text(b: Dict[str, Any]) -&gt; str:&#xa;        t = b.get(&quot;t&quot;)&#xa;        if t in (&quot;Para&quot;, &quot;Plain&quot;):&#xa;            return inlines_to_text(b.get(&quot;c&quot;, []))&#xa;        if t == &quot;Header&quot;:&#xa;            return inlines_to_text(b.get(&quot;c&quot;, [None, None, []])[2])&#xa;        return &quot;&quot;&#xa;&#xa;    first = &quot;\n&quot;.join([block_to_text(b) for b in blocks[:first_blocks] if block_to_text(b)]).strip()&#xa;&#xa;    # Доп. чтение титульной таблицы через python-docx (необязательно, если есть исходный DOCX)&#xa;    owners_guess: List[Owner] = []&#xa;    # (можно расширить эвристиками; сейчас оставим пусто)&#xa;&#xa;    llm = LLMClientStub()&#xa;    meta = llm.extract_doc_meta(first)&#xa;    meta.doc_id = doc_id&#xa;&#xa;    # Обновим запись документа&#xa;    conn.execute(&#xa;        &quot;UPDATE documents SET title=?, description=?, meta_json=? WHERE doc_id=? AND version=?&quot;,&#xa;        (&#xa;            meta.title,&#xa;            meta.description,&#xa;            meta.model_dump_json(ensure_ascii=False),&#xa;            doc_id,&#xa;            version,&#xa;        ),&#xa;    )&#xa;    conn.commit()&#xa;    typer.echo(&quot;[extract-meta] updated document meta&quot;)&#xa;&#xa;&#xa;@app.command(&quot;build-kb&quot;)&#xa;def build_kb(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;    max_tokens: int = typer.Option(2048, help=&quot;лимит токенов на чанк&quot;),&#xa;    overlap_tokens: int = typer.Option(256, help=&quot;оверлап между чанками&quot;),&#xa;    workers: int = typer.Option(4, help=&quot;параллельные воркеры&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Генерация объектов (summary/keywords/questions) по секциям (LLM или заглушка).&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    cur = conn.cursor()&#xa;    cur.execute(&quot;SELECT section_id, level, title, title_path, start_block_idx, end_block_idx FROM sections WHERE doc_id=? AND version=? ORDER BY start_block_idx&quot;, (doc_id, version))&#xa;    rows = cur.fetchall()&#xa;&#xa;    ast = cache_read(CACHE_DIR / f&quot;{doc_id}__{version}.pandoc.json&quot;)&#xa;    blocks = iter_blocks(ast)&#xa;    llm = LLMClientStub()&#xa;&#xa;    def process_row(row: Tuple[Any, ...]) -&gt; List[KBObject]:&#xa;        section_id, level, title, title_path_json, start, end = row&#xa;        title_path = json.loads(title_path_json)&#xa;        full_text = blocks_to_text(blocks, start, end)&#xa;        chunks = chunk_section_text(full_text, max_tokens=max_tokens, overlap_tokens=overlap_tokens)&#xa;        all_objs: List[KBObject] = []&#xa;        for ci, ch in enumerate(chunks):&#xa;            pos = {&quot;start_block_idx&quot;: start, &quot;end_block_idx&quot;: end, &quot;chunk_index&quot;: ci}&#xa;            objs = llm.make_objects_for_chunk(&#xa;                doc_id=doc_id, version=version, section_id=section_id, chunk_text=ch, full_text=full_text, position=pos&#xa;            )&#xa;            all_objs.extend(objs)&#xa;        return all_objs&#xa;&#xa;    to_insert: List[KBObject] = []&#xa;    with concurrent.futures.ThreadPoolExecutor(max_workers=workers) as ex:&#xa;        futures = [ex.submit(process_row, row) for row in rows]&#xa;        for f in concurrent.futures.as_completed(futures):&#xa;            to_insert.extend(f.result())&#xa;&#xa;    # Сохраняем&#xa;    for obj in to_insert:&#xa;        conn.execute(&#xa;            &quot;INSERT OR REPLACE INTO objects(object_id, section_id, kind, payload_json, meta_json) VALUES (?,?,?,?,?)&quot;,&#xa;            (&#xa;                obj.object_id,&#xa;                obj.section_id,&#xa;                obj.kind,&#xa;                json.dumps(obj.payload, ensure_ascii=False),&#xa;                json.dumps(obj.meta, ensure_ascii=False),&#xa;            ),&#xa;        )&#xa;    conn.commit()&#xa;    typer.echo(f&quot;[build-kb] objects stored: {len(to_insert)}&quot;)&#xa;&#xa;&#xa;@app.command(&quot;export-jsonl&quot;)&#xa;def export_jsonl(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    out: Path = typer.Option(..., &quot;--out&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Экспортирует все данные по документу в JSONL (sections + objects).&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    cur = conn.cursor()&#xa;&#xa;    data: List[Dict[str, Any]] = []&#xa;    cur.execute(&quot;SELECT * FROM sections WHERE doc_id=?&quot;, (doc_id,))&#xa;    sec_cols = [d[0] for d in cur.description]&#xa;    for row in cur.fetchall():&#xa;        rec = {k: v for k, v in zip(sec_cols, row)}&#xa;        data.append({&quot;type&quot;: &quot;section&quot;, **rec})&#xa;&#xa;    cur.execute(&quot;SELECT * FROM objects WHERE section_id IN (SELECT section_id FROM sections WHERE doc_id=?)&quot;, (doc_id,))&#xa;    obj_cols = [d[0] for d in cur.description]&#xa;    for row in cur.fetchall():&#xa;        rec = {k: v for k, v in zip(obj_cols, row)}&#xa;        data.append({&quot;type&quot;: &quot;object&quot;, **rec})&#xa;&#xa;    with out.open(&quot;w&quot;, encoding=&quot;utf-8&quot;) as f:&#xa;        for rec in data:&#xa;            f.write(json.dumps(rec, ensure_ascii=False) + &quot;\n&quot;)&#xa;    typer.echo(f&quot;[export-jsonl] wrote {len(data)} records → {out}&quot;)&#xa;&#xa;&#xa;@app.command(&quot;validate&quot;)&#xa;def validate(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Простейшие проверки качества покрытия и согласованности.&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    cur = conn.cursor()&#xa;&#xa;    cur.execute(&quot;SELECT COUNT(*) FROM sections WHERE doc_id=? AND version=?&quot;, (doc_id, version))&#xa;    sections_cnt = cur.fetchone()[0]&#xa;    cur.execute(&quot;SELECT COUNT(*) FROM objects WHERE section_id IN (SELECT section_id FROM sections WHERE doc_id=? AND version=?)&quot;, (doc_id, version))&#xa;    objects_cnt = cur.fetchone()[0]&#xa;&#xa;    cur.execute(&quot;SELECT section_id, COUNT(*) FROM objects WHERE section_id IN (SELECT section_id FROM sections WHERE doc_id=? AND version=?) GROUP BY section_id&quot;, (doc_id, version))&#xa;    per_section = cur.fetchall()&#xa;&#xa;    typer.echo(f&quot;[validate] sections: {sections_cnt}, objects: {objects_cnt}&quot;)&#xa;    zero_sections = [sid for sid, cnt in per_section if cnt == 0]&#xa;    if zero_sections:&#xa;        typer.secho(f&quot;[validate] sections without objects: {len(zero_sections)}&quot;, fg=typer.colors.YELLOW)&#xa;    else:&#xa;        typer.echo(&quot;[validate] every section has objects ✅&quot;)&#xa;&#xa;&#xa;@app.command(&quot;terms-extract&quot;)&#xa;def terms_extract(&#xa;    docx_path: Path = typer.Argument(..., exists=True, readable=True, help=&quot;DOCX-файл (оригинал)&quot;),&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Грубый парсер терминов/сокращений с титульных/табличных разделов через python-docx.&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    d = DocxDocument(str(docx_path))&#xa;&#xa;    def norm(s: str) -&gt; str:&#xa;        return re.sub(r&quot;\s+&quot;, &quot; &quot;, s).strip()&#xa;&#xa;    inserts = 0&#xa;    for tbl in d.tables:&#xa;        # предполагаем 2-3 колонки: Термин | Определение | (Вариант)&#xa;        for row in tbl.rows:&#xa;            cells = [norm(c.text) for c in row.cells]&#xa;            if len(cells) &lt; 2:&#xa;                continue&#xa;            term, definition = cells[0], cells[1]&#xa;            if not term or not definition:&#xa;                continue&#xa;            sid = stable_id(doc_id, version, term, definition[:20])&#xa;            conn.execute(&#xa;                &quot;INSERT OR REPLACE INTO terms(id, doc_id, section_id, term, normalized, kind, definition) VALUES (?,?,?,?,?,?,?)&quot;,&#xa;                (&#xa;                    sid,&#xa;                    doc_id,&#xa;                    None,&#xa;                    term,&#xa;                    term.lower(),&#xa;                    &quot;term&quot;,&#xa;                    definition,&#xa;                ),&#xa;            )&#xa;            inserts += 1&#xa;    conn.commit()&#xa;    typer.echo(f&quot;[terms-extract] terms upserted: {inserts}&quot;)&#xa;&#xa;&#xa;if __name__ == &quot;__main__&quot;:&#xa;    app() &#xa;" link="#!/usr/bin/env python3&#xa;&quot;&quot;&quot;&#xa;VND KB CLI — минимальный, но боевой скелет пайплайна:&#xa;  DOCX → Pandoc AST → секции/чанки → метаданные → объекты (summary/keywords/questions)&#xa;  → SQLite (метаданные+объекты) → экспорт JSONL&#xa;&#xa;&#xa;Зависимости (Python 3.10+):&#xa;  pip install typer[all] pydantic rapidfuzz python-docx&#xa;&#xa;&#xa;Внешние инструменты:&#xa;  pandoc (должен быть в PATH)&#xa;&#xa;&#xa;Примеры запуска:&#xa;  python vnd_kb_cli.py ingest path/to/file.docx --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli.py parse   --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli.py build-kb --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli.py export-jsonl --doc-id DOC123 --out data.jsonl&#xa;&#xa;&#xa;Структура SQLite (файл по умолчанию: vnd_kb.sqlite):&#xa;  documents, sections, objects, terms&#xa;&#xa;&#xa;Важно: LLM-вызовы здесь заглушены (см. LLMClientStub). Подключи свою реализацию.&#xa;&quot;&quot;&quot;&#xa;from __future__ import annotations&#xa;&#xa;&#xa;import concurrent.futures&#xa;import dataclasses&#xa;import hashlib&#xa;import json&#xa;import os&#xa;import re&#xa;import sqlite3&#xa;import subprocess&#xa;import sys&#xa;import time&#xa;from dataclasses import dataclass&#xa;from pathlib import Path&#xa;from typing import Any, Dict, Iterable, List, Literal, Optional, Tuple&#xa;&#xa;&#xa;import typer&#xa;from pydantic import BaseModel, Field&#xa;from rapidfuzz import fuzz, process as rf_process&#xa;from docx import Document as DocxDocument&#xa;&#xa;&#xa;app = typer.Typer(add_completion=False, help=&quot;VND KB CLI — DOCX → KB&quot;)&#xa;&#xa;&#xa;DB_PATH = os.environ.get(&quot;VND_KB_DB&quot;, &quot;vnd_kb.sqlite&quot;)&#xa;CACHE_DIR = Path(os.environ.get(&quot;VND_KB_CACHE&quot;, &quot;.vnd_kb_cache&quot;))&#xa;CACHE_DIR.mkdir(parents=True, exist_ok=True)&#xa;&#xa;&#xa;# ======================&#xa;#     Data Models&#xa;# ======================&#xa;class VersionInfo(BaseModel):&#xa;    number: str&#xa;    date: Optional[str] = None&#xa;    status: Optional[str] = None&#xa;&#xa;&#xa;class Owner(BaseModel):&#xa;    role: Optional[str] = None&#xa;    person: str&#xa;&#xa;&#xa;class DocMeta(BaseModel):&#xa;    doc_id: str&#xa;    title: str&#xa;    description: Optional[str] = None&#xa;    owners: List[Owner] = []&#xa;    versions: List[VersionInfo] = []&#xa;    effective_date: Optional[str] = None&#xa;    department: Optional[str] = None&#xa;    document_type: Optional[str] = None&#xa;&#xa;&#xa;class KBObject(BaseModel):&#xa;    object_id: str&#xa;    section_id: str&#xa;    kind: Literal[&quot;summary&quot;, &quot;keywords&quot;, &quot;questions&quot;]&#xa;    payload: Dict[str, Any]&#xa;    meta: Dict[str, Any]&#xa;&#xa;&#xa;@dataclass&#xa;class Heading:&#xa;    block_idx: int&#xa;    level: int&#xa;    text: str&#xa;    number: Optional[str]&#xa;&#xa;&#xa;# ======================&#xa;#     Utils&#xa;# ======================&#xa;&#xa;&#xa;def stable_id(*parts: Optional[str]) -&gt; str:&#xa;    return hashlib.sha1(&quot;||&quot;.join([p or &quot;&quot; for p in parts]).encode(&quot;utf-8&quot;)).hexdigest()[:16]&#xa;&#xa;&#xa;&#xa;&#xa;def approx_tokens(s: str) -&gt; int:&#xa;    # грубая оценка токенов&#xa;    return max(1, len(s) // 4)&#xa;&#xa;&#xa;&#xa;&#xa;def ensure_db(conn: sqlite3.Connection) -&gt; None:&#xa;    conn.execute(&#xa;        &quot;&quot;&quot;&#xa;        CREATE TABLE IF NOT EXISTS documents (&#xa;            doc_id TEXT,&#xa;            version TEXT,&#xa;            title TEXT,&#xa;            description TEXT,&#xa;            meta_json TEXT,&#xa;            source_hash TEXT,&#xa;            created_at INTEGER,&#xa;            PRIMARY KEY (doc_id, version)&#xa;        )&#xa;        &quot;&quot;&quot;&#xa;    )&#xa;    conn.execute(&#xa;        &quot;&quot;&quot;&#xa;        CREATE TABLE IF NOT EXISTS sections (&#xa;            section_id TEXT PRIMARY KEY,&#xa;            doc_id TEXT,&#xa;            version TEXT,&#xa;            level INTEGER,&#xa;            section_number TEXT,&#xa;            title TEXT,&#xa;            title_path TEXT,&#xa;            start_block_idx INTEGER,&#xa;            end_block_idx INTEGER,&#xa;            content_hash TEXT&#xa;        )&#xa;        &quot;&quot;&quot;&#xa;    )&#xa;    conn.execute(&#xa;        &quot;&quot;&quot;&#xa;        CREATE TABLE IF NOT EXISTS objects (&#xa;            object_id TEXT PRIMARY KEY,&#xa;            section_id TEXT,&#xa;            kind TEXT,&#xa;            payload_json TEXT,&#xa;            meta_json TEXT&#xa;        )&#xa;        &quot;&quot;&quot;&#xa;    )&#xa;    conn.execute(&#xa;        &quot;&quot;&quot;&#xa;        CREATE TABLE IF NOT EXISTS terms (&#xa;            id TEXT PRIMARY KEY,&#xa;            doc_id TEXT,&#xa;            section_id TEXT,&#xa;            term TEXT,&#xa;            normalized TEXT,&#xa;            kind TEXT,&#xa;            definition TEXT&#xa;        )&#xa;        &quot;&quot;&quot;&#xa;    )&#xa;    conn.commit()&#xa;&#xa;&#xa;# ======================&#xa;#     Pandoc &amp; OOXML&#xa;# ======================&#xa;&#xa;&#xa;def run_pandoc_ast(docx_path: Path) -&gt; Dict[str, Any]:&#xa;    out = subprocess.check_output([&#xa;        &quot;pandoc&quot;,&#xa;        str(docx_path),&#xa;        &quot;--to=json&quot;,&#xa;        &quot;--wrap=none&quot;,&#xa;        &quot;--track-changes=accept&quot;,&#xa;    ])&#xa;    return json.loads(out)&#xa;&#xa;&#xa;&#xa;&#xa;def cache_write(path: Path, data: Any) -&gt; None:&#xa;    path.write_text(json.dumps(data, ensure_ascii=False, indent=2), encoding=&quot;utf-8&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;def cache_read(path: Path) -&gt; Any:&#xa;    return json.loads(path.read_text(encoding=&quot;utf-8&quot;))&#xa;&#xa;&#xa;&#xa;&#xa;def doc_source_hash(docx_path: Path) -&gt; str:&#xa;    data = docx_path.read_bytes()&#xa;    return hashlib.sha256(data).hexdigest()&#xa;&#xa;&#xa;# ======================&#xa;#     AST helpers&#xa;# ======================&#xa;&#xa;&#xa;def iter_blocks(ast: Dict[str, Any]) -&gt; List[Dict[str, Any]]:&#xa;    return ast[&quot;blocks&quot;]&#xa;&#xa;&#xa;&#xa;&#xa;def inlines_to_text(inlines: List[Dict[str, Any]]) -&gt; str:&#xa;    parts: List[str] = []&#xa;    for x in inlines:&#xa;        t = x.get(&quot;t&quot;)&#xa;        c = x.get(&quot;c&quot;)&#xa;        if t == &quot;Str&quot;:&#xa;            parts.append(c)&#xa;        elif t == &quot;Space&quot;:&#xa;            parts.append(&quot; &quot;)&#xa;        elif t == &quot;SoftBreak&quot;:&#xa;            parts.append(&quot;\n&quot;)&#xa;        elif t == &quot;Code&quot;:&#xa;            parts.append(c[1] if isinstance(c, list) else str(c))&#xa;        elif t in (&quot;Emph&quot;, &quot;Strong&quot;, &quot;Strikeout&quot;, &quot;SmallCaps&quot;, &quot;Superscript&quot;, &quot;Subscript&quot;):&#xa;            # рекурсивно раскрываем&#xa;            parts.append(inlines_to_text(c))&#xa;        elif t == &quot;Span&quot; and isinstance(c, list) and len(c) == 3:&#xa;            parts.append(inlines_to_text(c[2]))&#xa;        # прочие типы игнорируем для простоты&#xa;    return &quot;&quot;.join(parts).strip()&#xa;&#xa;&#xa;&#xa;&#xa;def extract_headings(blocks: List[Dict[str, Any]]) -&gt; List[Heading]:&#xa;    hs: List[Heading] = []&#xa;    for i, b in enumerate(blocks):&#xa;        if b.get(&quot;t&quot;) == &quot;Header&quot;:&#xa;            level = b[&quot;c&quot;][0]&#xa;            inlines = b[&quot;c&quot;][2]&#xa;            text = inlines_to_text(inlines)&#xa;            # Попробуем вытащить явный номер в начале (&quot;1.&quot;, &quot;1.2.&quot;, &quot;1.2.3&quot;)&#xa;            m = re.match(r&quot;^([0-9]+(?:\.[0-9]+)*)[\.)\s]+(.+)$&quot;, text)&#xa;            number = m.group(1) if m else None&#xa;            if m:&#xa;                text = m.group(2).strip()&#xa;            hs.append(Heading(block_idx=i, level=level, text=text, number=number))&#xa;    return hs&#xa;&#xa;&#xa;&#xa;&#xa;def section_spans(blocks: List[Dict[str, Any]], hs: List[Heading]) -&gt; List[Tuple[int, int, Heading]]:&#xa;    spans: List[Tuple[int, int, Heading]] = []&#xa;    for idx, h in enumerate(hs):&#xa;        start = h.block_idx + 1&#xa;        end = (hs[idx + 1].block_idx - 1) if idx + 1 &lt; len(hs) else len(blocks) - 1&#xa;        spans.append((start, end, h))&#xa;    return spans&#xa;&#xa;&#xa;&#xa;&#xa;def blocks_to_text(blocks: List[Dict[str, Any]], start: int, end: int) -&gt; str:&#xa;    out: List[str] = []&#xa;    for i in range(start, max(start, end) + 1):&#xa;        b = blocks[i]&#xa;        t = b.get(&quot;t&quot;)&#xa;        if t in (&quot;Para&quot;, &quot;Plain&quot;):&#xa;            out.append(inlines_to_text(b.get(&quot;c&quot;, [])))&#xa;        elif t == &quot;CodeBlock&quot;:&#xa;            content = b.get(&quot;c&quot;, [None, &quot;&quot;]) [1]&#xa;            out.append(content)&#xa;        elif t == &quot;BlockQuote&quot;:&#xa;            inner = b.get(&quot;c&quot;, [])&#xa;            if isinstance(inner, list):&#xa;                out.append(blocks_to_text(inner, 0, len(inner)-1))&#xa;        # Списки/таблицы можно доработать при необходимости&#xa;    return &quot;\n&quot;.join([x for x in out if x]).strip()&#xa;&#xa;&#xa;# ======================&#xa;#     TOC helpers&#xa;# ======================&#xa;&#xa;&#xa;def normalize_title(s: str) -&gt; str:&#xa;    return re.sub(r&quot;\s+&quot;, &quot; &quot;, s.strip().lower().rstrip(&quot;.:&quot;) )&#xa;&#xa;&#xa;&#xa;&#xa;def match_toc_to_headings(toc_items: List[str], headings: List[Heading]) -&gt; List[Tuple[int, Optional[int]]]:&#xa;    norm_heads = [f&quot;{h.number + &#39; &#39; if h.number else &#39;&#39;}{h.text}&quot; for h in headings]&#xa;    norm_heads = [normalize_title(x) for x in norm_heads]&#xa;    results: List[Tuple[int, Optional[int]]] = []&#xa;    for i, item in enumerate(toc_items):&#xa;        ni = normalize_title(item)&#xa;        # точное совпадение&#xa;        if ni in norm_heads:&#xa;            results.append((i, norm_heads.index(ni)))&#xa;            continue&#xa;        # fuzzy&#xa;        match = rf_process.extractOne(ni, norm_heads, scorer=fuzz.WRatio)&#xa;        if match and match[1] &gt;= 90:&#xa;            results.append((i, match[2]))&#xa;        else:&#xa;            results.append((i, None))&#xa;    return results&#xa;&#xa;&#xa;# ======================&#xa;#     Chunking&#xa;# ======================&#xa;&#xa;&#xa;def make_title_path(headings: List[Heading], idx: int) -&gt; List[str]:&#xa;    # Примитивно: берем цепочку уровней к текущему&#xa;    path: List[str] = []&#xa;    cur_level = headings[idx].level&#xa;    path.append(headings[idx].text)&#xa;    j = idx - 1&#xa;    while j &gt;= 0:&#xa;        if headings[j].level &lt; cur_level:&#xa;            path.insert(0, headings[j].text)&#xa;            cur_level = headings[j].level&#xa;        j -= 1&#xa;    return path&#xa;&#xa;&#xa;&#xa;&#xa;def chunk_section_text(text: str, max_tokens: int = 2048, overlap_tokens: int = 256) -&gt; List[str]:&#xa;    if approx_tokens(text) &lt;= max_tokens:&#xa;        return [text]&#xa;    words = text.split()&#xa;    # делим по словам примерно под размер&#xa;    chunks: List[str] = []&#xa;    cur: List[str] = []&#xa;    cur_tokens = 0&#xa;    for w in words:&#xa;        t = approx_tokens(w + &quot; &quot;)&#xa;        if cur_tokens + t &gt; max_tokens:&#xa;            chunks.append(&quot; &quot;.join(cur).strip())&#xa;            # overlap&#xa;            if overlap_tokens &gt; 0 and chunks[-1]:&#xa;                tail_words = chunks[-1].split()[-min(len(chunks[-1].split()), overlap_tokens):]&#xa;                cur = tail_words.copy()&#xa;                cur_tokens = approx_tokens(&quot; &quot;.join(cur))&#xa;            else:&#xa;                cur = []&#xa;                cur_tokens = 0&#xa;        cur.append(w)&#xa;        cur_tokens += t&#xa;    if cur:&#xa;        chunks.append(&quot; &quot;.join(cur).strip())&#xa;    return [c for c in chunks if c]&#xa;&#xa;&#xa;# ======================&#xa;#     LLM Stub&#xa;# ======================&#xa;class LLMClientStub:&#xa;    &quot;&quot;&quot;Заглушка под твой LLM-клиент. Заменить на реальные вызовы (OpenAI/GigaChat и пр.).&quot;&quot;&quot;&#xa;    def extract_doc_meta(self, text: str) -&gt; DocMeta:&#xa;        # Псевдо-логика: берем первую строку как title&#xa;        title = text.splitlines()[0].strip() if text.strip() else &quot;Untitled&quot;&#xa;        return DocMeta(doc_id=&quot;&quot;, title=title, description=None, owners=[], versions=[])&#xa;&#xa;&#xa;    def make_objects_for_chunk(self, *, doc_id: str, version: str, section_id: str, chunk_text: str, full_text: str, position: Dict[str, int]) -&gt; List[KBObject]:&#xa;        # Возвращаем минимальные заглушки&#xa;        base_meta = {&quot;doc_id&quot;: doc_id, &quot;version&quot;: version, &quot;position&quot;: position, &quot;full_text&quot;: full_text}&#xa;        objs: List[KBObject] = []&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;summary&quot;, hashlib.sha1(chunk_text.encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;summary&quot;,&#xa;                payload={&quot;text&quot;: chunk_text[:500]},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        kws = list({w.strip(&quot;,.()[]&quot;).lower() for w in chunk_text.split() if len(w) &gt; 5})[:15]&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;keywords&quot;, hashlib.sha1((chunk_text+&quot;k&quot;).encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;keywords&quot;,&#xa;                payload={&quot;items&quot;: kws},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        qs = [{&quot;q&quot;: f&quot;О чём этот раздел? ({i})&quot;, &quot;type&quot;: &quot;base&quot;} for i in range(1, 6)]&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;questions&quot;, hashlib.sha1((chunk_text+&quot;q&quot;).encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;questions&quot;,&#xa;                payload={&quot;items&quot;: qs},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        return objs&#xa;&#xa;&#xa;# ======================&#xa;#     DB helpers&#xa;# ======================&#xa;&#xa;&#xa;def db_connect() -&gt; sqlite3.Connection:&#xa;    conn = sqlite3.connect(DB_PATH)&#xa;    conn.execute(&quot;PRAGMA journal_mode=WAL&quot;)&#xa;    conn.execute(&quot;PRAGMA synchronous=NORMAL&quot;)&#xa;    return conn&#xa;&#xa;&#xa;# ======================&#xa;#     CLI Commands&#xa;# ======================&#xa;@app.command()&#xa;def ingest(&#xa;    docx_path: Path = typer.Argument(..., exists=True, readable=True, help=&quot;DOCX-файл&quot;),&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;, help=&quot;ID документа&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;, help=&quot;Версия документа&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Конвертация DOCX → Pandoc AST (кэш) и запись документа в БД (мета пустая).&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    ast_cache = CACHE_DIR / f&quot;{doc_id}__{version}.pandoc.json&quot;&#xa;    h = doc_source_hash(docx_path)&#xa;    typer.echo(f&quot;[ingest] pandoc {docx_path} → {ast_cache}&quot;)&#xa;    ast = run_pandoc_ast(docx_path)&#xa;    cache_write(ast_cache, ast)&#xa;    # create/replace document row&#xa;    conn.execute(&#xa;        &quot;REPLACE INTO documents(doc_id, version, title, description, meta_json, source_hash, created_at) VALUES (?,?,?,?,?,?,?)&quot;,&#xa;        (doc_id, version, &quot;&quot;, None, json.dumps({}), h, int(time.time())),&#xa;    )&#xa;    conn.commit()&#xa;    typer.echo(&quot;[ingest] done&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command()&#xa;def parse(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Разбор структуры: заголовки → секции, извлечение текста, запись в БД.&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    ast_cache = CACHE_DIR / f&quot;{doc_id}__{version}.pandoc.json&quot;&#xa;    if not ast_cache.exists():&#xa;        typer.secho(&quot;AST cache not found. Run ingest first.&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;    ast = cache_read(ast_cache)&#xa;    blocks = iter_blocks(ast)&#xa;    heads = extract_headings(blocks)&#xa;    spans = section_spans(blocks, heads)&#xa;&#xa;&#xa;    # Очистим прошлые секции/объекты&#xa;    conn.execute(&quot;DELETE FROM sections WHERE doc_id=? AND version=?&quot;, (doc_id, version))&#xa;    conn.execute(&quot;DELETE FROM objects  WHERE section_id IN (SELECT section_id FROM sections WHERE doc_id=? AND version=?)&quot;, (doc_id, version))&#xa;&#xa;&#xa;    for idx, (start, end, h) in enumerate(spans):&#xa;        text = blocks_to_text(blocks, start, end)&#xa;        title_path = make_title_path(heads, idx)&#xa;        section_id = stable_id(doc_id, version, &quot;/&quot;.join(title_path))&#xa;        content_hash = hashlib.sha1(text.encode(&quot;utf-8&quot;)).hexdigest()&#xa;        conn.execute(&#xa;            &quot;&quot;&quot;&#xa;            INSERT OR REPLACE INTO sections(section_id, doc_id, version, level, section_number, title, title_path, start_block_idx, end_block_idx, content_hash)&#xa;            VALUES (?,?,?,?,?,?,?,?,?,?)&#xa;            &quot;&quot;&quot;,&#xa;            (&#xa;                section_id,&#xa;                doc_id,&#xa;                version,&#xa;                h.level,&#xa;                h.number,&#xa;                h.text,&#xa;                json.dumps(title_path, ensure_ascii=False),&#xa;                start,&#xa;                end,&#xa;                content_hash,&#xa;            ),&#xa;        )&#xa;    conn.commit()&#xa;    typer.echo(f&quot;[parse] sections stored: {len(spans)}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;extract-meta&quot;)&#xa;def extract_meta(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;    first_blocks: int = typer.Option(60, help=&quot;Сколько первых блоков отдавать LLM&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Извлечение метаданных из начала документа (LLM или эвристики).&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    ast_cache = CACHE_DIR / f&quot;{doc_id}__{version}.pandoc.json&quot;&#xa;    if not ast_cache.exists():&#xa;        typer.secho(&quot;AST cache not found. Run ingest first.&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;    ast = cache_read(ast_cache)&#xa;    blocks = iter_blocks(ast)&#xa;&#xa;&#xa;    # Собираем первые N блоков в текст&#xa;    def block_to_text(b: Dict[str, Any]) -&gt; str:&#xa;        t = b.get(&quot;t&quot;)&#xa;        if t in (&quot;Para&quot;, &quot;Plain&quot;):&#xa;            return inlines_to_text(b.get(&quot;c&quot;, []))&#xa;        if t == &quot;Header&quot;:&#xa;            return inlines_to_text(b.get(&quot;c&quot;, [None, None, []])[2])&#xa;        return &quot;&quot;&#xa;&#xa;&#xa;    first = &quot;\n&quot;.join([block_to_text(b) for b in blocks[:first_blocks] if block_to_text(b)]).strip()&#xa;&#xa;&#xa;    # Доп. чтение титульной таблицы через python-docx (необязательно, если есть исходный DOCX)&#xa;    owners_guess: List[Owner] = []&#xa;    # (можно расширить эвристиками; сейчас оставим пусто)&#xa;&#xa;&#xa;    llm = LLMClientStub()&#xa;    meta = llm.extract_doc_meta(first)&#xa;    meta.doc_id = doc_id&#xa;&#xa;&#xa;    # Обновим запись документа&#xa;    conn.execute(&#xa;        &quot;UPDATE documents SET title=?, description=?, meta_json=? WHERE doc_id=? AND version=?&quot;,&#xa;        (&#xa;            meta.title,&#xa;            meta.description,&#xa;            meta.model_dump_json(ensure_ascii=False),&#xa;            doc_id,&#xa;            version,&#xa;        ),&#xa;    )&#xa;    conn.commit()&#xa;    typer.echo(&quot;[extract-meta] updated document meta&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;build-kb&quot;)&#xa;def build_kb(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;    max_tokens: int = typer.Option(2048, help=&quot;лимит токенов на чанк&quot;),&#xa;    overlap_tokens: int = typer.Option(256, help=&quot;оверлап между чанками&quot;),&#xa;    workers: int = typer.Option(4, help=&quot;параллельные воркеры&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Генерация объектов (summary/keywords/questions) по секциям (LLM или заглушка).&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    cur = conn.cursor()&#xa;    cur.execute(&quot;SELECT section_id, level, title, title_path, start_block_idx, end_block_idx FROM sections WHERE doc_id=? AND version=? ORDER BY start_block_idx&quot;, (doc_id, version))&#xa;    rows = cur.fetchall()&#xa;&#xa;&#xa;    ast = cache_read(CACHE_DIR / f&quot;{doc_id}__{version}.pandoc.json&quot;)&#xa;    blocks = iter_blocks(ast)&#xa;    llm = LLMClientStub()&#xa;&#xa;&#xa;    def process_row(row: Tuple[Any, ...]) -&gt; List[KBObject]:&#xa;        section_id, level, title, title_path_json, start, end = row&#xa;        title_path = json.loads(title_path_json)&#xa;        full_text = blocks_to_text(blocks, start, end)&#xa;        chunks = chunk_section_text(full_text, max_tokens=max_tokens, overlap_tokens=overlap_tokens)&#xa;        all_objs: List[KBObject] = []&#xa;        for ci, ch in enumerate(chunks):&#xa;            pos = {&quot;start_block_idx&quot;: start, &quot;end_block_idx&quot;: end, &quot;chunk_index&quot;: ci}&#xa;            objs = llm.make_objects_for_chunk(&#xa;                doc_id=doc_id, version=version, section_id=section_id, chunk_text=ch, full_text=full_text, position=pos&#xa;            )&#xa;            all_objs.extend(objs)&#xa;        return all_objs&#xa;&#xa;&#xa;    to_insert: List[KBObject] = []&#xa;    with concurrent.futures.ThreadPoolExecutor(max_workers=workers) as ex:&#xa;        futures = [ex.submit(process_row, row) for row in rows]&#xa;        for f in concurrent.futures.as_completed(futures):&#xa;            to_insert.extend(f.result())&#xa;&#xa;&#xa;    # Сохраняем&#xa;    for obj in to_insert:&#xa;        conn.execute(&#xa;            &quot;INSERT OR REPLACE INTO objects(object_id, section_id, kind, payload_json, meta_json) VALUES (?,?,?,?,?)&quot;,&#xa;            (&#xa;                obj.object_id,&#xa;                obj.section_id,&#xa;                obj.kind,&#xa;                json.dumps(obj.payload, ensure_ascii=False),&#xa;                json.dumps(obj.meta, ensure_ascii=False),&#xa;            ),&#xa;        )&#xa;    conn.commit()&#xa;    typer.echo(f&quot;[build-kb] objects stored: {len(to_insert)}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;export-jsonl&quot;)&#xa;def export_jsonl(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    out: Path = typer.Option(..., &quot;--out&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Экспортирует все данные по документу в JSONL (sections + objects).&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    cur = conn.cursor()&#xa;&#xa;&#xa;    data: List[Dict[str, Any]] = []&#xa;    cur.execute(&quot;SELECT * FROM sections WHERE doc_id=?&quot;, (doc_id,))&#xa;    sec_cols = [d[0] for d in cur.description]&#xa;    for row in cur.fetchall():&#xa;        rec = {k: v for k, v in zip(sec_cols, row)}&#xa;        data.append({&quot;type&quot;: &quot;section&quot;, **rec})&#xa;&#xa;&#xa;    cur.execute(&quot;SELECT * FROM objects WHERE section_id IN (SELECT section_id FROM sections WHERE doc_id=?)&quot;, (doc_id,))&#xa;    obj_cols = [d[0] for d in cur.description]&#xa;    for row in cur.fetchall():&#xa;        rec = {k: v for k, v in zip(obj_cols, row)}&#xa;        data.append({&quot;type&quot;: &quot;object&quot;, **rec})&#xa;&#xa;&#xa;    with out.open(&quot;w&quot;, encoding=&quot;utf-8&quot;) as f:&#xa;        for rec in data:&#xa;            f.write(json.dumps(rec, ensure_ascii=False) + &quot;\n&quot;)&#xa;    typer.echo(f&quot;[export-jsonl] wrote {len(data)} records → {out}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;validate&quot;)&#xa;def validate(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Простейшие проверки качества покрытия и согласованности.&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    cur = conn.cursor()&#xa;&#xa;&#xa;    cur.execute(&quot;SELECT COUNT(*) FROM sections WHERE doc_id=? AND version=?&quot;, (doc_id, version))&#xa;    sections_cnt = cur.fetchone()[0]&#xa;    cur.execute(&quot;SELECT COUNT(*) FROM objects WHERE section_id IN (SELECT section_id FROM sections WHERE doc_id=? AND version=?)&quot;, (doc_id, version))&#xa;    objects_cnt = cur.fetchone()[0]&#xa;&#xa;&#xa;    cur.execute(&quot;SELECT section_id, COUNT(*) FROM objects WHERE section_id IN (SELECT section_id FROM sections WHERE doc_id=? AND version=?) GROUP BY section_id&quot;, (doc_id, version))&#xa;    per_section = cur.fetchall()&#xa;&#xa;&#xa;    typer.echo(f&quot;[validate] sections: {sections_cnt}, objects: {objects_cnt}&quot;)&#xa;    zero_sections = [sid for sid, cnt in per_section if cnt == 0]&#xa;    if zero_sections:&#xa;        typer.secho(f&quot;[validate] sections without objects: {len(zero_sections)}&quot;, fg=typer.colors.YELLOW)&#xa;    else:&#xa;        typer.echo(&quot;[validate] every section has objects ✅&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;terms-extract&quot;)&#xa;def terms_extract(&#xa;    docx_path: Path = typer.Argument(..., exists=True, readable=True, help=&quot;DOCX-файл (оригинал)&quot;),&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Грубый парсер терминов/сокращений с титульных/табличных разделов через python-docx.&quot;&quot;&quot;&#xa;    conn = db_connect(); ensure_db(conn)&#xa;    d = DocxDocument(str(docx_path))&#xa;&#xa;&#xa;    def norm(s: str) -&gt; str:&#xa;        return re.sub(r&quot;\s+&quot;, &quot; &quot;, s).strip()&#xa;&#xa;&#xa;    inserts = 0&#xa;    for tbl in d.tables:&#xa;        # предполагаем 2-3 колонки: Термин | Определение | (Вариант)&#xa;        for row in tbl.rows:&#xa;            cells = [norm(c.text) for c in row.cells]&#xa;            if len(cells) &lt; 2:&#xa;                continue&#xa;            term, definition = cells[0], cells[1]&#xa;            if not term or not definition:&#xa;                continue&#xa;            sid = stable_id(doc_id, version, term, definition[:20])&#xa;            conn.execute(&#xa;                &quot;INSERT OR REPLACE INTO terms(id, doc_id, section_id, term, normalized, kind, definition) VALUES (?,?,?,?,?,?,?)&quot;,&#xa;                (&#xa;                    sid,&#xa;                    doc_id,&#xa;                    None,&#xa;                    term,&#xa;                    term.lower(),&#xa;                    &quot;term&quot;,&#xa;                    definition,&#xa;                ),&#xa;            )&#xa;            inserts += 1&#xa;    conn.commit()&#xa;    typer.echo(f&quot;[terms-extract] terms upserted: {inserts}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;if __name__ == &quot;__main__&quot;:&#xa;    app()" id="l6Q6Y_iKE1Ih8PZb_8EV-1">
          <mxCell style="text;whiteSpace=wrap;" parent="1" vertex="1">
            <mxGeometry x="190" y="110" width="560" height="10960" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="l6Q6Y_iKE1Ih8PZb_8EV-2" value="&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Определить, какие возможны типы документов, чтобы под каждый тип сделать свой парсинг&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;В случае сложных вопросов, там где приводится фактология, а затем задаётся вопрос сделать преобразование вопроса. Сделать тестирование такого преобразованного вопроса итеративно сравнивать с ответом эксперта, затем оставить максимально качественный промпт для few shot&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Подаём в ллм начало документа, просим сделать JSON с названием, описанием, ответственными лицами, версиями и оглавление в виде списка.&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Тестируем оглавление на предмет наличия в тексте документа каждого элемента.&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Предусматриваем проверку с помощью ллм в случае не нахождения или нахождения больше одного соответствия.&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;С помощью алгоритма находим место каждого элемента в документе.&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Подаём в алгоритм каждую часть отдельно и смотрим количество символов. Если количество символов нормально для подачи в контекст ллм, то запускаем анализ. Если нет, то делаем суммаризацию каждого подпункта. Рассмотреть возможность сразу анализировать по подпунктам.&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;По каждому пункту/подпункту делаем объекты:&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;- список вопросов&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;- суммаризацию&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;- ключевые слова&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;к каждому объекту добавляем метаинформацию:&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;- полный текст&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;- название документа&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;- позиция в тексте&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Создание списка вопросов прогоняем несколько раз в зависимости от размера с подачей в контекст уже имеющихся вопросов.&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;После прогона создания списка вопросов, запускаем создание сложносоставных вопросов на основе списка вопросов.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;После создания всех списков вопросов по всему документу, делаем ещё прогон по составлению общих сложных вопросов по документу.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;В документе как правило есть список терминов и сокращений. Подаём в контекст вместе с названием документа и его описанием.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;При маршрутизации запросов на старте агента можно использовать саммари по всем документам и определять наиболее подходящие.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Маршрутизация также возможна путем уточнения у пользователя.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Маршрутизация возможна при ролевой модели, т.е на основе информации о пользователе.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Проверка валидности вопроса и промпт инжекция в отдельном потоке с присвоением флага, при отдаче результатов основной цепочки проверяем флаг. Отдаем на проверку текст с айди, как и в основной канал, проверяем флаг .&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;К каждому объекту добавить информацию о количестве токенов, для расчета контекста&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Мульти агент&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Роутинг на определенные документы.&lt;/span&gt;&lt;/p&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;В каталоге лежат части документа в MD, и результирующий JSON.&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p dir=&quot;ltr&quot; style=&quot;line-height:1.38;margin-top:0pt;margin-bottom:0pt;&quot;&gt;&lt;span style=&quot;font-size:11pt;font-family:&#39;Google Sans Text&#39;;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;&quot;&gt;Разбивка на части&lt;/span&gt;&lt;/p&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1700" y="60" width="560" height="1160" as="geometry" />
        </mxCell>
        <UserObject label="#!/usr/bin/env python3&#xa;&quot;&quot;&quot;&#xa;VND KB CLI — пайплайн DOCX → Pandoc AST → секции/чанки → метаданные → объекты&#xa;Хранилище: JSON-файлы на диске (без SQLite)&#xa;&#xa;&#xa;Зависимости (Python 3.10+):&#xa;  pip install typer[all] pydantic rapidfuzz python-docx&#xa;&#xa;&#xa;Внешние инструменты:&#xa;  pandoc (должен быть в PATH)&#xa;&#xa;&#xa;Переменные окружения:&#xa;  VND_KB_DATA   — директория хранилища (по умолчанию ./vnd_kb_data)&#xa;&#xa;&#xa;Примеры запуска:&#xa;  python vnd_kb_cli_json.py ingest input.docx --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli_json.py parse --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli_json.py extract-meta --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli_json.py build-kb --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli_json.py export-jsonl --doc-id DOC123 --out data.jsonl&#xa;  python vnd_kb_cli_json.py validate --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli_json.py terms-extract input.docx --doc-id DOC123 --version 1.0&#xa;&quot;&quot;&quot;&#xa;from __future__ import annotations&#xa;&#xa;&#xa;import concurrent.futures&#xa;import hashlib&#xa;import json&#xa;import os&#xa;import re&#xa;import subprocess&#xa;import time&#xa;from dataclasses import dataclass&#xa;from pathlib import Path&#xa;from typing import Any, Dict, List, Literal, Optional, Tuple&#xa;&#xa;&#xa;import typer&#xa;from pydantic import BaseModel, ValidationError&#xa;from rapidfuzz import fuzz, process as rf_process&#xa;from docx import Document as DocxDocument&#xa;&#xa;&#xa;app = typer.Typer(add_completion=False, help=&quot;VND KB CLI — JSON store&quot;)&#xa;&#xa;&#xa;DATA_DIR = Path(os.environ.get(&quot;VND_KB_DATA&quot;, &quot;vnd_kb_data&quot;))&#xa;CACHE_DIR = Path(os.environ.get(&quot;VND_KB_CACHE&quot;, &quot;.vnd_kb_cache&quot;))&#xa;for d in (DATA_DIR, CACHE_DIR):&#xa;    d.mkdir(parents=True, exist_ok=True)&#xa;&#xa;&#xa;# ======================&#xa;#     Data Models&#xa;# ======================&#xa;class VersionInfo(BaseModel):&#xa;    number: str&#xa;    date: Optional[str] = None&#xa;    status: Optional[str] = None&#xa;&#xa;&#xa;class Owner(BaseModel):&#xa;    role: Optional[str] = None&#xa;    person: str&#xa;&#xa;&#xa;class DocMeta(BaseModel):&#xa;    doc_id: str&#xa;    title: str&#xa;    description: Optional[str] = None&#xa;    owners: List[Owner] = []&#xa;    versions: List[VersionInfo] = []&#xa;    effective_date: Optional[str] = None&#xa;    department: Optional[str] = None&#xa;    document_type: Optional[str] = None&#xa;&#xa;&#xa;class KBObject(BaseModel):&#xa;    object_id: str&#xa;    section_id: str&#xa;    kind: Literal[&quot;summary&quot;, &quot;keywords&quot;, &quot;questions&quot;]&#xa;    payload: Dict[str, Any]&#xa;    meta: Dict[str, Any]&#xa;&#xa;&#xa;@dataclass&#xa;class Heading:&#xa;    block_idx: int&#xa;    level: int&#xa;    text: str&#xa;    number: Optional[str]&#xa;&#xa;&#xa;# ======================&#xa;#     Utils&#xa;# ======================&#xa;&#xa;&#xa;def stable_id(*parts: Optional[str]) -&gt; str:&#xa;    return hashlib.sha1(&quot;||&quot;.join([p or &quot;&quot; for p in parts]).encode(&quot;utf-8&quot;)).hexdigest()[:16]&#xa;&#xa;&#xa;&#xa;&#xa;def approx_tokens(s: str) -&gt; int:&#xa;    return max(1, len(s) // 4)&#xa;&#xa;&#xa;&#xa;&#xa;def doc_root(doc_id: str, version: str) -&gt; Path:&#xa;    p = DATA_DIR / doc_id / version&#xa;    p.mkdir(parents=True, exist_ok=True)&#xa;    return p&#xa;&#xa;&#xa;&#xa;&#xa;def write_json(path: Path, data: Any) -&gt; None:&#xa;    path.parent.mkdir(parents=True, exist_ok=True)&#xa;    path.write_text(json.dumps(data, ensure_ascii=False, indent=2), encoding=&quot;utf-8&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;def read_json(path: Path, default: Any) -&gt; Any:&#xa;    if not path.exists():&#xa;        return default&#xa;    return json.loads(path.read_text(encoding=&quot;utf-8&quot;))&#xa;&#xa;&#xa;&#xa;&#xa;def doc_source_hash(docx_path: Path) -&gt; str:&#xa;    return hashlib.sha256(docx_path.read_bytes()).hexdigest()&#xa;&#xa;&#xa;# ======================&#xa;#     Pandoc&#xa;# ======================&#xa;&#xa;&#xa;def run_pandoc_ast(docx_path: Path) -&gt; Dict[str, Any]:&#xa;    out = subprocess.check_output([&#xa;        &quot;pandoc&quot;,&#xa;        str(docx_path),&#xa;        &quot;--to=json&quot;,&#xa;        &quot;--wrap=none&quot;,&#xa;        &quot;--track-changes=accept&quot;,&#xa;    ])&#xa;    return json.loads(out)&#xa;&#xa;&#xa;&#xa;&#xa;def cache_write(path: Path, data: Any) -&gt; None:&#xa;    write_json(path, data)&#xa;&#xa;&#xa;&#xa;&#xa;def cache_read(path: Path) -&gt; Any:&#xa;    return read_json(path, {})&#xa;&#xa;&#xa;# ======================&#xa;#     AST helpers&#xa;# ======================&#xa;&#xa;&#xa;def iter_blocks(ast: Dict[str, Any]) -&gt; List[Dict[str, Any]]:&#xa;    return ast.get(&quot;blocks&quot;, [])&#xa;&#xa;&#xa;&#xa;&#xa;def inlines_to_text(inlines: List[Dict[str, Any]]) -&gt; str:&#xa;    parts: List[str] = []&#xa;    for x in inlines:&#xa;        t = x.get(&quot;t&quot;); c = x.get(&quot;c&quot;)&#xa;        if t == &quot;Str&quot;:&#xa;            parts.append(c)&#xa;        elif t == &quot;Space&quot;:&#xa;            parts.append(&quot; &quot;)&#xa;        elif t == &quot;SoftBreak&quot;:&#xa;            parts.append(&quot;\n&quot;)&#xa;        elif t == &quot;Code&quot;:&#xa;            parts.append(c[1] if isinstance(c, list) else str(c))&#xa;        elif t in (&quot;Emph&quot;, &quot;Strong&quot;, &quot;Strikeout&quot;, &quot;SmallCaps&quot;, &quot;Superscript&quot;, &quot;Subscript&quot;):&#xa;            parts.append(inlines_to_text(c))&#xa;        elif t == &quot;Span&quot; and isinstance(c, list) and len(c) == 3:&#xa;            parts.append(inlines_to_text(c[2]))&#xa;    return &quot;&quot;.join(parts).strip()&#xa;&#xa;&#xa;&#xa;&#xa;def extract_headings(blocks: List[Dict[str, Any]]) -&gt; List[Heading]:&#xa;    hs: List[Heading] = []&#xa;    for i, b in enumerate(blocks):&#xa;        if b.get(&quot;t&quot;) == &quot;Header&quot;:&#xa;            level = b[&quot;c&quot;][0]&#xa;            inlines = b[&quot;c&quot;][2]&#xa;            text_full = inlines_to_text(inlines)&#xa;            m = re.match(r&quot;^([0-9]+(?:\.[0-9]+)*)[\.)\s]+(.+)$&quot;, text_full)&#xa;            number = m.group(1) if m else None&#xa;            text = m.group(2).strip() if m else text_full&#xa;            hs.append(Heading(block_idx=i, level=level, text=text, number=number))&#xa;    return hs&#xa;&#xa;&#xa;&#xa;&#xa;def section_spans(blocks: List[Dict[str, Any]], hs: List[Heading]) -&gt; List[Tuple[int, int, Heading]]:&#xa;    spans: List[Tuple[int, int, Heading]] = []&#xa;    for idx, h in enumerate(hs):&#xa;        start = h.block_idx + 1&#xa;        end = (hs[idx + 1].block_idx - 1) if idx + 1 &lt; len(hs) else len(blocks) - 1&#xa;        spans.append((start, end, h))&#xa;    return spans&#xa;&#xa;&#xa;&#xa;&#xa;def blocks_to_text(blocks: List[Dict[str, Any]], start: int, end: int) -&gt; str:&#xa;    out: List[str] = []&#xa;    for i in range(start, max(start, end) + 1):&#xa;        b = blocks[i]; t = b.get(&quot;t&quot;)&#xa;        if t in (&quot;Para&quot;, &quot;Plain&quot;):&#xa;            out.append(inlines_to_text(b.get(&quot;c&quot;, [])))&#xa;        elif t == &quot;CodeBlock&quot;:&#xa;            content = b.get(&quot;c&quot;, [None, &quot;&quot;]) [1]&#xa;            out.append(content)&#xa;        elif t == &quot;BlockQuote&quot;:&#xa;            inner = b.get(&quot;c&quot;, [])&#xa;            if isinstance(inner, list):&#xa;                out.append(blocks_to_text(inner, 0, len(inner)-1))&#xa;        elif t == &quot;Table&quot;:&#xa;            # упрощенно: caption в текст&#xa;            c = b.get(&quot;c&quot;, [])&#xa;            if isinstance(c, list) and len(c) &gt; 1:&#xa;                cap = c[1]&#xa;                if isinstance(cap, list):&#xa;                    out.append(inlines_to_text(cap[1] if len(cap) &gt; 1 else []))&#xa;    return &quot;\n&quot;.join([x for x in out if x]).strip()&#xa;&#xa;&#xa;# ======================&#xa;#     TOC helpers&#xa;# ======================&#xa;&#xa;&#xa;def normalize_title(s: str) -&gt; str:&#xa;    return re.sub(r&quot;\s+&quot;, &quot; &quot;, s.strip().lower().rstrip(&quot;.:&quot;) )&#xa;&#xa;&#xa;&#xa;&#xa;def match_toc_to_headings(toc_items: List[str], headings: List[Heading]) -&gt; List[Tuple[int, Optional[int]]]:&#xa;    norm_heads = [f&quot;{h.number + &#39; &#39; if h.number else &#39;&#39;}{h.text}&quot; for h in headings]&#xa;    norm_heads = [normalize_title(x) for x in norm_heads]&#xa;    results: List[Tuple[int, Optional[int]]] = []&#xa;    for i, item in enumerate(toc_items):&#xa;        ni = normalize_title(item)&#xa;        if ni in norm_heads:&#xa;            results.append((i, norm_heads.index(ni)))&#xa;            continue&#xa;        match = rf_process.extractOne(ni, norm_heads, scorer=fuzz.WRatio)&#xa;        results.append((i, match[2] if match and match[1] &gt;= 90 else None))&#xa;    return results&#xa;&#xa;&#xa;# ======================&#xa;#     Chunking&#xa;# ======================&#xa;&#xa;&#xa;def make_title_path(headings: List[Heading], idx: int) -&gt; List[str]:&#xa;    path: List[str] = []&#xa;    cur_level = headings[idx].level&#xa;    path.append(headings[idx].text)&#xa;    j = idx - 1&#xa;    while j &gt;= 0:&#xa;        if headings[j].level &lt; cur_level:&#xa;            path.insert(0, headings[j].text)&#xa;            cur_level = headings[j].level&#xa;        j -= 1&#xa;    return path&#xa;&#xa;&#xa;&#xa;&#xa;def chunk_section_text(text: str, max_tokens: int = 2048, overlap_tokens: int = 256) -&gt; List[str]:&#xa;    if approx_tokens(text) &lt;= max_tokens:&#xa;        return [text]&#xa;    words = text.split()&#xa;    chunks: List[str] = []&#xa;    cur: List[str] = []&#xa;    cur_tokens = 0&#xa;    for w in words:&#xa;        t = approx_tokens(w + &quot; &quot;)&#xa;        if cur_tokens + t &gt; max_tokens:&#xa;            chunks.append(&quot; &quot;.join(cur).strip())&#xa;            if overlap_tokens &gt; 0 and chunks[-1]:&#xa;                tail_words = chunks[-1].split()&#xa;                tail_words = tail_words[-min(len(tail_words), overlap_tokens):]&#xa;                cur = tail_words.copy()&#xa;                cur_tokens = approx_tokens(&quot; &quot;.join(cur))&#xa;            else:&#xa;                cur = []&#xa;                cur_tokens = 0&#xa;        cur.append(w)&#xa;        cur_tokens += t&#xa;    if cur:&#xa;        chunks.append(&quot; &quot;.join(cur).strip())&#xa;    return [c for c in chunks if c]&#xa;&#xa;&#xa;# ======================&#xa;#     LLM Stub (замени на GigaChat/OpenAI при необходимости)&#xa;# ======================&#xa;class LLMClientStub:&#xa;    def extract_doc_meta(self, text: str, *, doc_id: str) -&gt; DocMeta:&#xa;        title = text.splitlines()[0].strip() if text.strip() else f&quot;{doc_id}&quot;&#xa;        return DocMeta(doc_id=doc_id, title=title, description=None, owners=[], versions=[])&#xa;&#xa;&#xa;    def make_objects_for_chunk(self, *, doc_id: str, version: str, section_id: str, chunk_text: str, full_text: str, position: Dict[str, int]) -&gt; List[KBObject]:&#xa;        base_meta = {&quot;doc_id&quot;: doc_id, &quot;version&quot;: version, &quot;position&quot;: position, &quot;full_text&quot;: full_text}&#xa;        objs: List[KBObject] = []&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;summary&quot;, hashlib.sha1(chunk_text.encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;summary&quot;,&#xa;                payload={&quot;text&quot;: chunk_text[:500]},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        kws = list({w.strip(&quot;,.()[]&quot;).lower() for w in chunk_text.split() if len(w) &gt; 5})[:15]&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;keywords&quot;, hashlib.sha1((chunk_text+&quot;k&quot;).encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;keywords&quot;,&#xa;                payload={&quot;items&quot;: kws},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        qs = [{&quot;q&quot;: f&quot;О чём этот раздел? ({i})&quot;, &quot;type&quot;: &quot;base&quot;} for i in range(1, 6)]&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;questions&quot;, hashlib.sha1((chunk_text+&quot;q&quot;).encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;questions&quot;,&#xa;                payload={&quot;items&quot;: qs},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        return objs&#xa;&#xa;&#xa;# ======================&#xa;#     JSON-store helpers&#xa;# ======================&#xa;&#xa;&#xa;def store_paths(doc_id: str, version: str) -&gt; Dict[str, Path]:&#xa;    root = doc_root(doc_id, version)&#xa;    return {&#xa;        &quot;root&quot;: root,&#xa;        &quot;document&quot;: root / &quot;document.json&quot;,&#xa;        &quot;sections&quot;: root / &quot;sections.json&quot;,&#xa;        &quot;objects&quot;: root / &quot;objects.json&quot;,&#xa;        &quot;terms&quot;: root / &quot;terms.json&quot;,&#xa;        &quot;ast_cache&quot;: CACHE_DIR / f&quot;{doc_id}__{version}.pandoc.json&quot;,&#xa;    }&#xa;&#xa;&#xa;&#xa;&#xa;def load_sections(doc_id: str, version: str) -&gt; List[Dict[str, Any]]:&#xa;    p = store_paths(doc_id, version)[&quot;sections&quot;]&#xa;    return read_json(p, [])&#xa;&#xa;&#xa;&#xa;&#xa;def save_sections(doc_id: str, version: str, sections: List[Dict[str, Any]]) -&gt; None:&#xa;    p = store_paths(doc_id, version)[&quot;sections&quot;]&#xa;    write_json(p, sections)&#xa;&#xa;&#xa;&#xa;&#xa;def load_objects(doc_id: str, version: str) -&gt; List[Dict[str, Any]]:&#xa;    p = store_paths(doc_id, version)[&quot;objects&quot;]&#xa;    return read_json(p, [])&#xa;&#xa;&#xa;&#xa;&#xa;def save_objects(doc_id: str, version: str, objects: List[Dict[str, Any]]) -&gt; None:&#xa;    p = store_paths(doc_id, version)[&quot;objects&quot;]&#xa;    write_json(p, objects)&#xa;&#xa;&#xa;&#xa;&#xa;def load_terms(doc_id: str, version: str) -&gt; List[Dict[str, Any]]:&#xa;    p = store_paths(doc_id, version)[&quot;terms&quot;]&#xa;    return read_json(p, [])&#xa;&#xa;&#xa;&#xa;&#xa;def save_terms(doc_id: str, version: str, terms: List[Dict[str, Any]]) -&gt; None:&#xa;    p = store_paths(doc_id, version)[&quot;terms&quot;]&#xa;    write_json(p, terms)&#xa;&#xa;&#xa;&#xa;&#xa;def load_document(doc_id: str, version: str) -&gt; Dict[str, Any]:&#xa;    p = store_paths(doc_id, version)[&quot;document&quot;]&#xa;    return read_json(p, {})&#xa;&#xa;&#xa;&#xa;&#xa;def save_document(doc_id: str, version: str, data: Dict[str, Any]) -&gt; None:&#xa;    p = store_paths(doc_id, version)[&quot;document&quot;]&#xa;    write_json(p, data)&#xa;&#xa;&#xa;# ======================&#xa;#     CLI Commands&#xa;# ======================&#xa;@app.command()&#xa;def ingest(&#xa;    docx_path: Path = typer.Argument(..., exists=True, readable=True, help=&quot;DOCX-файл&quot;),&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;, help=&quot;ID документа&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;, help=&quot;Версия документа&quot;),&#xa;):&#xa;    &quot;&quot;&quot;DOCX → Pandoc AST (кэш) + начальная запись document.json.&quot;&quot;&quot;&#xa;    paths = store_paths(doc_id, version)&#xa;    typer.echo(f&quot;[ingest] pandoc {docx_path} → {paths[&#39;ast_cache&#39;]}&quot;)&#xa;    ast = run_pandoc_ast(docx_path)&#xa;    cache_write(paths[&quot;ast_cache&quot;], ast)&#xa;    h = doc_source_hash(docx_path)&#xa;    doc = {&#xa;        &quot;doc_id&quot;: doc_id,&#xa;        &quot;version&quot;: version,&#xa;        &quot;title&quot;: &quot;&quot;,&#xa;        &quot;description&quot;: None,&#xa;        &quot;meta_json&quot;: {},&#xa;        &quot;source_hash&quot;: h,&#xa;        &quot;created_at&quot;: int(time.time()),&#xa;    }&#xa;    save_document(doc_id, version, doc)&#xa;    typer.echo(&quot;[ingest] done&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command()&#xa;def parse(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Разбор структуры: заголовки → секции, извлекаем текст и сохраняем sections.json. Очищаем objects.json.&quot;&quot;&quot;&#xa;    paths = store_paths(doc_id, version)&#xa;    if not paths[&quot;ast_cache&quot;].exists():&#xa;        typer.secho(&quot;AST cache not found. Run ingest first.&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;    ast = cache_read(paths[&quot;ast_cache&quot;])&#xa;    blocks = iter_blocks(ast)&#xa;    heads = extract_headings(blocks)&#xa;    spans = section_spans(blocks, heads)&#xa;&#xa;&#xa;    sections: List[Dict[str, Any]] = []&#xa;    for idx, (start, end, h) in enumerate(spans):&#xa;        text = blocks_to_text(blocks, start, end)&#xa;        title_path = make_title_path(heads, idx)&#xa;        section_id = stable_id(doc_id, version, &quot;/&quot;.join(title_path))&#xa;        content_hash = hashlib.sha1(text.encode(&quot;utf-8&quot;)).hexdigest()&#xa;        sections.append({&#xa;            &quot;section_id&quot;: section_id,&#xa;            &quot;doc_id&quot;: doc_id,&#xa;            &quot;version&quot;: version,&#xa;            &quot;level&quot;: h.level,&#xa;            &quot;section_number&quot;: h.number,&#xa;            &quot;title&quot;: h.text,&#xa;            &quot;title_path&quot;: title_path,&#xa;            &quot;start_block_idx&quot;: start,&#xa;            &quot;end_block_idx&quot;: end,&#xa;            &quot;content_hash&quot;: content_hash,&#xa;            &quot;text&quot;: text,&#xa;        })&#xa;&#xa;&#xa;    save_sections(doc_id, version, sections)&#xa;    save_objects(doc_id, version, [])  # сбросим&#xa;    typer.echo(f&quot;[parse] sections stored: {len(sections)}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;# ======== Промпты/LLM (здесь — заглушка) ========&#xa;@app.command(&quot;extract-meta&quot;)&#xa;def extract_meta(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;    first_blocks: int = typer.Option(60, help=&quot;Сколько первых блоков отдавать LLM&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Извлечение метаданных из начала документа (LLM Stub) → обновление document.json.&quot;&quot;&quot;&#xa;    paths = store_paths(doc_id, version)&#xa;    if not paths[&quot;ast_cache&quot;].exists():&#xa;        typer.secho(&quot;AST cache not found. Run ingest first.&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;    ast = cache_read(paths[&quot;ast_cache&quot;])&#xa;    blocks = iter_blocks(ast)&#xa;&#xa;&#xa;    def block_to_text(b: Dict[str, Any]) -&gt; str:&#xa;        t = b.get(&quot;t&quot;)&#xa;        if t in (&quot;Para&quot;, &quot;Plain&quot;):&#xa;            return inlines_to_text(b.get(&quot;c&quot;, []))&#xa;        if t == &quot;Header&quot;:&#xa;            return inlines_to_text(b.get(&quot;c&quot;, [None, None, []])[2])&#xa;        if t == &quot;Table&quot;:&#xa;            c = b.get(&quot;c&quot;, [])&#xa;            if isinstance(c, list) and len(c) &gt; 1:&#xa;                cap = c[1]&#xa;                if isinstance(cap, list):&#xa;                    return inlines_to_text(cap[1] if len(cap) &gt; 1 else [])&#xa;        return &quot;&quot;&#xa;&#xa;&#xa;    first = &quot;\n&quot;.join([block_to_text(b) for b in blocks[:first_blocks] if block_to_text(b)]).strip()&#xa;&#xa;&#xa;    llm = LLMClientStub()&#xa;    meta = llm.extract_doc_meta(first, doc_id=doc_id)&#xa;&#xa;&#xa;    doc = load_document(doc_id, version)&#xa;    try:&#xa;        parsed = meta.model_dump()&#xa;    except ValidationError:&#xa;        parsed = meta.dict()&#xa;    doc.update({&#xa;        &quot;title&quot;: parsed.get(&quot;title&quot;, doc.get(&quot;title&quot;, &quot;&quot;)),&#xa;        &quot;description&quot;: parsed.get(&quot;description&quot;),&#xa;        &quot;meta_json&quot;: parsed,&#xa;    })&#xa;    save_document(doc_id, version, doc)&#xa;    typer.echo(&quot;[extract-meta] updated document meta&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;build-kb&quot;)&#xa;def build_kb(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;    max_tokens: int = typer.Option(2048, help=&quot;лимит токенов на чанк&quot;),&#xa;    overlap_tokens: int = typer.Option(256, help=&quot;оверлап между чанками&quot;),&#xa;    workers: int = typer.Option(4, help=&quot;параллельные воркеры&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Генерация объектов (summary/keywords/questions) по секциям → objects.json.&quot;&quot;&quot;&#xa;    sections = load_sections(doc_id, version)&#xa;    if not sections:&#xa;        typer.secho(&quot;Sections not found. Run parse first.&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;&#xa;&#xa;    llm = LLMClientStub()&#xa;&#xa;&#xa;    def process_section(sec: Dict[str, Any]) -&gt; List[KBObject]:&#xa;        full_text = sec.get(&quot;text&quot;, &quot;&quot;)&#xa;        chunks = chunk_section_text(full_text, max_tokens=max_tokens, overlap_tokens=overlap_tokens)&#xa;        all_objs: List[KBObject] = []&#xa;        for ci, ch in enumerate(chunks):&#xa;            pos = {&quot;start_block_idx&quot;: sec[&quot;start_block_idx&quot;], &quot;end_block_idx&quot;: sec[&quot;end_block_idx&quot;], &quot;chunk_index&quot;: ci}&#xa;            objs = llm.make_objects_for_chunk(&#xa;                doc_id=doc_id,&#xa;                version=version,&#xa;                section_id=sec[&quot;section_id&quot;],&#xa;                chunk_text=ch,&#xa;                full_text=full_text,&#xa;                position=pos,&#xa;            )&#xa;            all_objs.extend(objs)&#xa;        return all_objs&#xa;&#xa;&#xa;    to_insert: List[KBObject] = []&#xa;    with concurrent.futures.ThreadPoolExecutor(max_workers=workers) as ex:&#xa;        futures = [ex.submit(process_section, s) for s in sections]&#xa;        for f in concurrent.futures.as_completed(futures):&#xa;            to_insert.extend(f.result())&#xa;&#xa;&#xa;    # Сохраняем целиком objects.json&#xa;    save_objects(doc_id, version, [o.model_dump() for o in to_insert])&#xa;    typer.echo(f&quot;[build-kb] objects stored: {len(to_insert)}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;export-jsonl&quot;)&#xa;def export_jsonl(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: Optional[str] = typer.Option(None, &quot;--version&quot;),&#xa;    out: Path = typer.Option(..., &quot;--out&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Экспортирует sections + objects в JSONL.&quot;&quot;&quot;&#xa;    if version is None:&#xa;        # если версия не указана — возьмём единственную папку&#xa;        doc_dir = DATA_DIR / doc_id&#xa;        versions = [p.name for p in doc_dir.iterdir() if p.is_dir()] if doc_dir.exists() else []&#xa;        if not versions:&#xa;            typer.secho(&quot;Document not found&quot;, fg=typer.colors.RED); raise typer.Exit(1)&#xa;        version = sorted(versions)[-1]&#xa;&#xa;&#xa;    sections = load_sections(doc_id, version)&#xa;    objects = load_objects(doc_id, version)&#xa;&#xa;&#xa;    with out.open(&quot;w&quot;, encoding=&quot;utf-8&quot;) as f:&#xa;        for s in sections:&#xa;            rec = {&quot;type&quot;: &quot;section&quot;, **s}&#xa;            f.write(json.dumps(rec, ensure_ascii=False) + &quot;\n&quot;)&#xa;        for o in objects:&#xa;            rec = {&quot;type&quot;: &quot;object&quot;, **o}&#xa;            f.write(json.dumps(rec, ensure_ascii=False) + &quot;\n&quot;)&#xa;    typer.echo(f&quot;[export-jsonl] wrote {len(sections)+len(objects)} records → {out}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;validate&quot;)&#xa;def validate(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Мини-проверки покрытия.&quot;&quot;&quot;&#xa;    sections = load_sections(doc_id, version)&#xa;    objects = load_objects(doc_id, version)&#xa;&#xa;&#xa;    sec_ids = {s[&quot;section_id&quot;] for s in sections}&#xa;    obj_by_sec = {sid: 0 for sid in sec_ids}&#xa;    for o in objects:&#xa;        sid = o.get(&quot;section_id&quot;);&#xa;        if sid in obj_by_sec:&#xa;            obj_by_sec[sid] += 1&#xa;&#xa;&#xa;    typer.echo(f&quot;[validate] sections: {len(sections)}, objects: {len(objects)}&quot;)&#xa;    zero = [sid for sid, cnt in obj_by_sec.items() if cnt == 0]&#xa;    if zero:&#xa;        typer.secho(f&quot;[validate] sections without objects: {len(zero)}&quot;, fg=typer.colors.YELLOW)&#xa;    else:&#xa;        typer.echo(&quot;[validate] every section has objects ✅&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;terms-extract&quot;)&#xa;def terms_extract(&#xa;    docx_path: Path = typer.Argument(..., exists=True, readable=True, help=&quot;DOCX-файл (оригинал)&quot;),&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Грубое извлечение терминов/сокращений из таблиц DOCX → terms.json (дополняет).&quot;&quot;&quot;&#xa;    d = DocxDocument(str(docx_path))&#xa;&#xa;&#xa;    def norm(s: str) -&gt; str:&#xa;        return re.sub(r&quot;\s+&quot;, &quot; &quot;, s).strip()&#xa;&#xa;&#xa;    terms = load_terms(doc_id, version)&#xa;    existed = {(t.get(&quot;term&quot;), t.get(&quot;definition&quot;)) for t in terms}&#xa;    inserts = 0&#xa;&#xa;&#xa;    for tbl in d.tables:&#xa;        for row in tbl.rows:&#xa;            cells = [norm(c.text) for c in row.cells]&#xa;            if len(cells) &lt; 2:&#xa;                continue&#xa;            term, definition = cells[0], cells[1]&#xa;            if not term or not definition:&#xa;                continue&#xa;            key = (term, definition)&#xa;            if key in existed:&#xa;                continue&#xa;            terms.append({&#xa;                &quot;id&quot;: stable_id(doc_id, version, term, definition[:20]),&#xa;                &quot;doc_id&quot;: doc_id,&#xa;                &quot;section_id&quot;: None,&#xa;                &quot;term&quot;: term,&#xa;                &quot;normalized&quot;: term.lower(),&#xa;                &quot;kind&quot;: &quot;term&quot;,&#xa;                &quot;definition&quot;: definition,&#xa;            })&#xa;            existed.add(key)&#xa;            inserts += 1&#xa;&#xa;&#xa;    save_terms(doc_id, version, terms)&#xa;    typer.echo(f&quot;[terms-extract] terms upserted: {inserts}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;if __name__ == &quot;__main__&quot;:&#xa;    app()" link="#!/usr/bin/env python3&#xa;&quot;&quot;&quot;&#xa;VND KB CLI — пайплайн DOCX → Pandoc AST → секции/чанки → метаданные → объекты&#xa;Хранилище: JSON-файлы на диске (без SQLite)&#xa;&#xa;&#xa;Зависимости (Python 3.10+):&#xa;  pip install typer[all] pydantic rapidfuzz python-docx&#xa;&#xa;&#xa;Внешние инструменты:&#xa;  pandoc (должен быть в PATH)&#xa;&#xa;&#xa;Переменные окружения:&#xa;  VND_KB_DATA   — директория хранилища (по умолчанию ./vnd_kb_data)&#xa;&#xa;&#xa;Примеры запуска:&#xa;  python vnd_kb_cli_json.py ingest input.docx --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli_json.py parse --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli_json.py extract-meta --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli_json.py build-kb --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli_json.py export-jsonl --doc-id DOC123 --out data.jsonl&#xa;  python vnd_kb_cli_json.py validate --doc-id DOC123 --version 1.0&#xa;  python vnd_kb_cli_json.py terms-extract input.docx --doc-id DOC123 --version 1.0&#xa;&quot;&quot;&quot;&#xa;from __future__ import annotations&#xa;&#xa;&#xa;import concurrent.futures&#xa;import hashlib&#xa;import json&#xa;import os&#xa;import re&#xa;import subprocess&#xa;import time&#xa;from dataclasses import dataclass&#xa;from pathlib import Path&#xa;from typing import Any, Dict, List, Literal, Optional, Tuple&#xa;&#xa;&#xa;import typer&#xa;from pydantic import BaseModel, ValidationError&#xa;from rapidfuzz import fuzz, process as rf_process&#xa;from docx import Document as DocxDocument&#xa;&#xa;&#xa;app = typer.Typer(add_completion=False, help=&quot;VND KB CLI — JSON store&quot;)&#xa;&#xa;&#xa;DATA_DIR = Path(os.environ.get(&quot;VND_KB_DATA&quot;, &quot;vnd_kb_data&quot;))&#xa;CACHE_DIR = Path(os.environ.get(&quot;VND_KB_CACHE&quot;, &quot;.vnd_kb_cache&quot;))&#xa;for d in (DATA_DIR, CACHE_DIR):&#xa;    d.mkdir(parents=True, exist_ok=True)&#xa;&#xa;&#xa;# ======================&#xa;#     Data Models&#xa;# ======================&#xa;class VersionInfo(BaseModel):&#xa;    number: str&#xa;    date: Optional[str] = None&#xa;    status: Optional[str] = None&#xa;&#xa;&#xa;class Owner(BaseModel):&#xa;    role: Optional[str] = None&#xa;    person: str&#xa;&#xa;&#xa;class DocMeta(BaseModel):&#xa;    doc_id: str&#xa;    title: str&#xa;    description: Optional[str] = None&#xa;    owners: List[Owner] = []&#xa;    versions: List[VersionInfo] = []&#xa;    effective_date: Optional[str] = None&#xa;    department: Optional[str] = None&#xa;    document_type: Optional[str] = None&#xa;&#xa;&#xa;class KBObject(BaseModel):&#xa;    object_id: str&#xa;    section_id: str&#xa;    kind: Literal[&quot;summary&quot;, &quot;keywords&quot;, &quot;questions&quot;]&#xa;    payload: Dict[str, Any]&#xa;    meta: Dict[str, Any]&#xa;&#xa;&#xa;@dataclass&#xa;class Heading:&#xa;    block_idx: int&#xa;    level: int&#xa;    text: str&#xa;    number: Optional[str]&#xa;&#xa;&#xa;# ======================&#xa;#     Utils&#xa;# ======================&#xa;&#xa;&#xa;def stable_id(*parts: Optional[str]) -&gt; str:&#xa;    return hashlib.sha1(&quot;||&quot;.join([p or &quot;&quot; for p in parts]).encode(&quot;utf-8&quot;)).hexdigest()[:16]&#xa;&#xa;&#xa;&#xa;&#xa;def approx_tokens(s: str) -&gt; int:&#xa;    return max(1, len(s) // 4)&#xa;&#xa;&#xa;&#xa;&#xa;def doc_root(doc_id: str, version: str) -&gt; Path:&#xa;    p = DATA_DIR / doc_id / version&#xa;    p.mkdir(parents=True, exist_ok=True)&#xa;    return p&#xa;&#xa;&#xa;&#xa;&#xa;def write_json(path: Path, data: Any) -&gt; None:&#xa;    path.parent.mkdir(parents=True, exist_ok=True)&#xa;    path.write_text(json.dumps(data, ensure_ascii=False, indent=2), encoding=&quot;utf-8&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;def read_json(path: Path, default: Any) -&gt; Any:&#xa;    if not path.exists():&#xa;        return default&#xa;    return json.loads(path.read_text(encoding=&quot;utf-8&quot;))&#xa;&#xa;&#xa;&#xa;&#xa;def doc_source_hash(docx_path: Path) -&gt; str:&#xa;    return hashlib.sha256(docx_path.read_bytes()).hexdigest()&#xa;&#xa;&#xa;# ======================&#xa;#     Pandoc&#xa;# ======================&#xa;&#xa;&#xa;def run_pandoc_ast(docx_path: Path) -&gt; Dict[str, Any]:&#xa;    out = subprocess.check_output([&#xa;        &quot;pandoc&quot;,&#xa;        str(docx_path),&#xa;        &quot;--to=json&quot;,&#xa;        &quot;--wrap=none&quot;,&#xa;        &quot;--track-changes=accept&quot;,&#xa;    ])&#xa;    return json.loads(out)&#xa;&#xa;&#xa;&#xa;&#xa;def cache_write(path: Path, data: Any) -&gt; None:&#xa;    write_json(path, data)&#xa;&#xa;&#xa;&#xa;&#xa;def cache_read(path: Path) -&gt; Any:&#xa;    return read_json(path, {})&#xa;&#xa;&#xa;# ======================&#xa;#     AST helpers&#xa;# ======================&#xa;&#xa;&#xa;def iter_blocks(ast: Dict[str, Any]) -&gt; List[Dict[str, Any]]:&#xa;    return ast.get(&quot;blocks&quot;, [])&#xa;&#xa;&#xa;&#xa;&#xa;def inlines_to_text(inlines: List[Dict[str, Any]]) -&gt; str:&#xa;    parts: List[str] = []&#xa;    for x in inlines:&#xa;        t = x.get(&quot;t&quot;); c = x.get(&quot;c&quot;)&#xa;        if t == &quot;Str&quot;:&#xa;            parts.append(c)&#xa;        elif t == &quot;Space&quot;:&#xa;            parts.append(&quot; &quot;)&#xa;        elif t == &quot;SoftBreak&quot;:&#xa;            parts.append(&quot;\n&quot;)&#xa;        elif t == &quot;Code&quot;:&#xa;            parts.append(c[1] if isinstance(c, list) else str(c))&#xa;        elif t in (&quot;Emph&quot;, &quot;Strong&quot;, &quot;Strikeout&quot;, &quot;SmallCaps&quot;, &quot;Superscript&quot;, &quot;Subscript&quot;):&#xa;            parts.append(inlines_to_text(c))&#xa;        elif t == &quot;Span&quot; and isinstance(c, list) and len(c) == 3:&#xa;            parts.append(inlines_to_text(c[2]))&#xa;    return &quot;&quot;.join(parts).strip()&#xa;&#xa;&#xa;&#xa;&#xa;def extract_headings(blocks: List[Dict[str, Any]]) -&gt; List[Heading]:&#xa;    hs: List[Heading] = []&#xa;    for i, b in enumerate(blocks):&#xa;        if b.get(&quot;t&quot;) == &quot;Header&quot;:&#xa;            level = b[&quot;c&quot;][0]&#xa;            inlines = b[&quot;c&quot;][2]&#xa;            text_full = inlines_to_text(inlines)&#xa;            m = re.match(r&quot;^([0-9]+(?:\.[0-9]+)*)[\.)\s]+(.+)$&quot;, text_full)&#xa;            number = m.group(1) if m else None&#xa;            text = m.group(2).strip() if m else text_full&#xa;            hs.append(Heading(block_idx=i, level=level, text=text, number=number))&#xa;    return hs&#xa;&#xa;&#xa;&#xa;&#xa;def section_spans(blocks: List[Dict[str, Any]], hs: List[Heading]) -&gt; List[Tuple[int, int, Heading]]:&#xa;    spans: List[Tuple[int, int, Heading]] = []&#xa;    for idx, h in enumerate(hs):&#xa;        start = h.block_idx + 1&#xa;        end = (hs[idx + 1].block_idx - 1) if idx + 1 &lt; len(hs) else len(blocks) - 1&#xa;        spans.append((start, end, h))&#xa;    return spans&#xa;&#xa;&#xa;&#xa;&#xa;def blocks_to_text(blocks: List[Dict[str, Any]], start: int, end: int) -&gt; str:&#xa;    out: List[str] = []&#xa;    for i in range(start, max(start, end) + 1):&#xa;        b = blocks[i]; t = b.get(&quot;t&quot;)&#xa;        if t in (&quot;Para&quot;, &quot;Plain&quot;):&#xa;            out.append(inlines_to_text(b.get(&quot;c&quot;, [])))&#xa;        elif t == &quot;CodeBlock&quot;:&#xa;            content = b.get(&quot;c&quot;, [None, &quot;&quot;]) [1]&#xa;            out.append(content)&#xa;        elif t == &quot;BlockQuote&quot;:&#xa;            inner = b.get(&quot;c&quot;, [])&#xa;            if isinstance(inner, list):&#xa;                out.append(blocks_to_text(inner, 0, len(inner)-1))&#xa;        elif t == &quot;Table&quot;:&#xa;            # упрощенно: caption в текст&#xa;            c = b.get(&quot;c&quot;, [])&#xa;            if isinstance(c, list) and len(c) &gt; 1:&#xa;                cap = c[1]&#xa;                if isinstance(cap, list):&#xa;                    out.append(inlines_to_text(cap[1] if len(cap) &gt; 1 else []))&#xa;    return &quot;\n&quot;.join([x for x in out if x]).strip()&#xa;&#xa;&#xa;# ======================&#xa;#     TOC helpers&#xa;# ======================&#xa;&#xa;&#xa;def normalize_title(s: str) -&gt; str:&#xa;    return re.sub(r&quot;\s+&quot;, &quot; &quot;, s.strip().lower().rstrip(&quot;.:&quot;) )&#xa;&#xa;&#xa;&#xa;&#xa;def match_toc_to_headings(toc_items: List[str], headings: List[Heading]) -&gt; List[Tuple[int, Optional[int]]]:&#xa;    norm_heads = [f&quot;{h.number + &#39; &#39; if h.number else &#39;&#39;}{h.text}&quot; for h in headings]&#xa;    norm_heads = [normalize_title(x) for x in norm_heads]&#xa;    results: List[Tuple[int, Optional[int]]] = []&#xa;    for i, item in enumerate(toc_items):&#xa;        ni = normalize_title(item)&#xa;        if ni in norm_heads:&#xa;            results.append((i, norm_heads.index(ni)))&#xa;            continue&#xa;        match = rf_process.extractOne(ni, norm_heads, scorer=fuzz.WRatio)&#xa;        results.append((i, match[2] if match and match[1] &gt;= 90 else None))&#xa;    return results&#xa;&#xa;&#xa;# ======================&#xa;#     Chunking&#xa;# ======================&#xa;&#xa;&#xa;def make_title_path(headings: List[Heading], idx: int) -&gt; List[str]:&#xa;    path: List[str] = []&#xa;    cur_level = headings[idx].level&#xa;    path.append(headings[idx].text)&#xa;    j = idx - 1&#xa;    while j &gt;= 0:&#xa;        if headings[j].level &lt; cur_level:&#xa;            path.insert(0, headings[j].text)&#xa;            cur_level = headings[j].level&#xa;        j -= 1&#xa;    return path&#xa;&#xa;&#xa;&#xa;&#xa;def chunk_section_text(text: str, max_tokens: int = 2048, overlap_tokens: int = 256) -&gt; List[str]:&#xa;    if approx_tokens(text) &lt;= max_tokens:&#xa;        return [text]&#xa;    words = text.split()&#xa;    chunks: List[str] = []&#xa;    cur: List[str] = []&#xa;    cur_tokens = 0&#xa;    for w in words:&#xa;        t = approx_tokens(w + &quot; &quot;)&#xa;        if cur_tokens + t &gt; max_tokens:&#xa;            chunks.append(&quot; &quot;.join(cur).strip())&#xa;            if overlap_tokens &gt; 0 and chunks[-1]:&#xa;                tail_words = chunks[-1].split()&#xa;                tail_words = tail_words[-min(len(tail_words), overlap_tokens):]&#xa;                cur = tail_words.copy()&#xa;                cur_tokens = approx_tokens(&quot; &quot;.join(cur))&#xa;            else:&#xa;                cur = []&#xa;                cur_tokens = 0&#xa;        cur.append(w)&#xa;        cur_tokens += t&#xa;    if cur:&#xa;        chunks.append(&quot; &quot;.join(cur).strip())&#xa;    return [c for c in chunks if c]&#xa;&#xa;&#xa;# ======================&#xa;#     LLM Stub (замени на GigaChat/OpenAI при необходимости)&#xa;# ======================&#xa;class LLMClientStub:&#xa;    def extract_doc_meta(self, text: str, *, doc_id: str) -&gt; DocMeta:&#xa;        title = text.splitlines()[0].strip() if text.strip() else f&quot;{doc_id}&quot;&#xa;        return DocMeta(doc_id=doc_id, title=title, description=None, owners=[], versions=[])&#xa;&#xa;&#xa;    def make_objects_for_chunk(self, *, doc_id: str, version: str, section_id: str, chunk_text: str, full_text: str, position: Dict[str, int]) -&gt; List[KBObject]:&#xa;        base_meta = {&quot;doc_id&quot;: doc_id, &quot;version&quot;: version, &quot;position&quot;: position, &quot;full_text&quot;: full_text}&#xa;        objs: List[KBObject] = []&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;summary&quot;, hashlib.sha1(chunk_text.encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;summary&quot;,&#xa;                payload={&quot;text&quot;: chunk_text[:500]},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        kws = list({w.strip(&quot;,.()[]&quot;).lower() for w in chunk_text.split() if len(w) &gt; 5})[:15]&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;keywords&quot;, hashlib.sha1((chunk_text+&quot;k&quot;).encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;keywords&quot;,&#xa;                payload={&quot;items&quot;: kws},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        qs = [{&quot;q&quot;: f&quot;О чём этот раздел? ({i})&quot;, &quot;type&quot;: &quot;base&quot;} for i in range(1, 6)]&#xa;        objs.append(&#xa;            KBObject(&#xa;                object_id=stable_id(section_id, &quot;questions&quot;, hashlib.sha1((chunk_text+&quot;q&quot;).encode()).hexdigest()),&#xa;                section_id=section_id,&#xa;                kind=&quot;questions&quot;,&#xa;                payload={&quot;items&quot;: qs},&#xa;                meta=base_meta,&#xa;            )&#xa;        )&#xa;        return objs&#xa;&#xa;&#xa;# ======================&#xa;#     JSON-store helpers&#xa;# ======================&#xa;&#xa;&#xa;def store_paths(doc_id: str, version: str) -&gt; Dict[str, Path]:&#xa;    root = doc_root(doc_id, version)&#xa;    return {&#xa;        &quot;root&quot;: root,&#xa;        &quot;document&quot;: root / &quot;document.json&quot;,&#xa;        &quot;sections&quot;: root / &quot;sections.json&quot;,&#xa;        &quot;objects&quot;: root / &quot;objects.json&quot;,&#xa;        &quot;terms&quot;: root / &quot;terms.json&quot;,&#xa;        &quot;ast_cache&quot;: CACHE_DIR / f&quot;{doc_id}__{version}.pandoc.json&quot;,&#xa;    }&#xa;&#xa;&#xa;&#xa;&#xa;def load_sections(doc_id: str, version: str) -&gt; List[Dict[str, Any]]:&#xa;    p = store_paths(doc_id, version)[&quot;sections&quot;]&#xa;    return read_json(p, [])&#xa;&#xa;&#xa;&#xa;&#xa;def save_sections(doc_id: str, version: str, sections: List[Dict[str, Any]]) -&gt; None:&#xa;    p = store_paths(doc_id, version)[&quot;sections&quot;]&#xa;    write_json(p, sections)&#xa;&#xa;&#xa;&#xa;&#xa;def load_objects(doc_id: str, version: str) -&gt; List[Dict[str, Any]]:&#xa;    p = store_paths(doc_id, version)[&quot;objects&quot;]&#xa;    return read_json(p, [])&#xa;&#xa;&#xa;&#xa;&#xa;def save_objects(doc_id: str, version: str, objects: List[Dict[str, Any]]) -&gt; None:&#xa;    p = store_paths(doc_id, version)[&quot;objects&quot;]&#xa;    write_json(p, objects)&#xa;&#xa;&#xa;&#xa;&#xa;def load_terms(doc_id: str, version: str) -&gt; List[Dict[str, Any]]:&#xa;    p = store_paths(doc_id, version)[&quot;terms&quot;]&#xa;    return read_json(p, [])&#xa;&#xa;&#xa;&#xa;&#xa;def save_terms(doc_id: str, version: str, terms: List[Dict[str, Any]]) -&gt; None:&#xa;    p = store_paths(doc_id, version)[&quot;terms&quot;]&#xa;    write_json(p, terms)&#xa;&#xa;&#xa;&#xa;&#xa;def load_document(doc_id: str, version: str) -&gt; Dict[str, Any]:&#xa;    p = store_paths(doc_id, version)[&quot;document&quot;]&#xa;    return read_json(p, {})&#xa;&#xa;&#xa;&#xa;&#xa;def save_document(doc_id: str, version: str, data: Dict[str, Any]) -&gt; None:&#xa;    p = store_paths(doc_id, version)[&quot;document&quot;]&#xa;    write_json(p, data)&#xa;&#xa;&#xa;# ======================&#xa;#     CLI Commands&#xa;# ======================&#xa;@app.command()&#xa;def ingest(&#xa;    docx_path: Path = typer.Argument(..., exists=True, readable=True, help=&quot;DOCX-файл&quot;),&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;, help=&quot;ID документа&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;, help=&quot;Версия документа&quot;),&#xa;):&#xa;    &quot;&quot;&quot;DOCX → Pandoc AST (кэш) + начальная запись document.json.&quot;&quot;&quot;&#xa;    paths = store_paths(doc_id, version)&#xa;    typer.echo(f&quot;[ingest] pandoc {docx_path} → {paths[&#39;ast_cache&#39;]}&quot;)&#xa;    ast = run_pandoc_ast(docx_path)&#xa;    cache_write(paths[&quot;ast_cache&quot;], ast)&#xa;    h = doc_source_hash(docx_path)&#xa;    doc = {&#xa;        &quot;doc_id&quot;: doc_id,&#xa;        &quot;version&quot;: version,&#xa;        &quot;title&quot;: &quot;&quot;,&#xa;        &quot;description&quot;: None,&#xa;        &quot;meta_json&quot;: {},&#xa;        &quot;source_hash&quot;: h,&#xa;        &quot;created_at&quot;: int(time.time()),&#xa;    }&#xa;    save_document(doc_id, version, doc)&#xa;    typer.echo(&quot;[ingest] done&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command()&#xa;def parse(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Разбор структуры: заголовки → секции, извлекаем текст и сохраняем sections.json. Очищаем objects.json.&quot;&quot;&quot;&#xa;    paths = store_paths(doc_id, version)&#xa;    if not paths[&quot;ast_cache&quot;].exists():&#xa;        typer.secho(&quot;AST cache not found. Run ingest first.&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;    ast = cache_read(paths[&quot;ast_cache&quot;])&#xa;    blocks = iter_blocks(ast)&#xa;    heads = extract_headings(blocks)&#xa;    spans = section_spans(blocks, heads)&#xa;&#xa;&#xa;    sections: List[Dict[str, Any]] = []&#xa;    for idx, (start, end, h) in enumerate(spans):&#xa;        text = blocks_to_text(blocks, start, end)&#xa;        title_path = make_title_path(heads, idx)&#xa;        section_id = stable_id(doc_id, version, &quot;/&quot;.join(title_path))&#xa;        content_hash = hashlib.sha1(text.encode(&quot;utf-8&quot;)).hexdigest()&#xa;        sections.append({&#xa;            &quot;section_id&quot;: section_id,&#xa;            &quot;doc_id&quot;: doc_id,&#xa;            &quot;version&quot;: version,&#xa;            &quot;level&quot;: h.level,&#xa;            &quot;section_number&quot;: h.number,&#xa;            &quot;title&quot;: h.text,&#xa;            &quot;title_path&quot;: title_path,&#xa;            &quot;start_block_idx&quot;: start,&#xa;            &quot;end_block_idx&quot;: end,&#xa;            &quot;content_hash&quot;: content_hash,&#xa;            &quot;text&quot;: text,&#xa;        })&#xa;&#xa;&#xa;    save_sections(doc_id, version, sections)&#xa;    save_objects(doc_id, version, [])  # сбросим&#xa;    typer.echo(f&quot;[parse] sections stored: {len(sections)}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;# ======== Промпты/LLM (здесь — заглушка) ========&#xa;@app.command(&quot;extract-meta&quot;)&#xa;def extract_meta(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;    first_blocks: int = typer.Option(60, help=&quot;Сколько первых блоков отдавать LLM&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Извлечение метаданных из начала документа (LLM Stub) → обновление document.json.&quot;&quot;&quot;&#xa;    paths = store_paths(doc_id, version)&#xa;    if not paths[&quot;ast_cache&quot;].exists():&#xa;        typer.secho(&quot;AST cache not found. Run ingest first.&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;    ast = cache_read(paths[&quot;ast_cache&quot;])&#xa;    blocks = iter_blocks(ast)&#xa;&#xa;&#xa;    def block_to_text(b: Dict[str, Any]) -&gt; str:&#xa;        t = b.get(&quot;t&quot;)&#xa;        if t in (&quot;Para&quot;, &quot;Plain&quot;):&#xa;            return inlines_to_text(b.get(&quot;c&quot;, []))&#xa;        if t == &quot;Header&quot;:&#xa;            return inlines_to_text(b.get(&quot;c&quot;, [None, None, []])[2])&#xa;        if t == &quot;Table&quot;:&#xa;            c = b.get(&quot;c&quot;, [])&#xa;            if isinstance(c, list) and len(c) &gt; 1:&#xa;                cap = c[1]&#xa;                if isinstance(cap, list):&#xa;                    return inlines_to_text(cap[1] if len(cap) &gt; 1 else [])&#xa;        return &quot;&quot;&#xa;&#xa;&#xa;    first = &quot;\n&quot;.join([block_to_text(b) for b in blocks[:first_blocks] if block_to_text(b)]).strip()&#xa;&#xa;&#xa;    llm = LLMClientStub()&#xa;    meta = llm.extract_doc_meta(first, doc_id=doc_id)&#xa;&#xa;&#xa;    doc = load_document(doc_id, version)&#xa;    try:&#xa;        parsed = meta.model_dump()&#xa;    except ValidationError:&#xa;        parsed = meta.dict()&#xa;    doc.update({&#xa;        &quot;title&quot;: parsed.get(&quot;title&quot;, doc.get(&quot;title&quot;, &quot;&quot;)),&#xa;        &quot;description&quot;: parsed.get(&quot;description&quot;),&#xa;        &quot;meta_json&quot;: parsed,&#xa;    })&#xa;    save_document(doc_id, version, doc)&#xa;    typer.echo(&quot;[extract-meta] updated document meta&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;build-kb&quot;)&#xa;def build_kb(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;    max_tokens: int = typer.Option(2048, help=&quot;лимит токенов на чанк&quot;),&#xa;    overlap_tokens: int = typer.Option(256, help=&quot;оверлап между чанками&quot;),&#xa;    workers: int = typer.Option(4, help=&quot;параллельные воркеры&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Генерация объектов (summary/keywords/questions) по секциям → objects.json.&quot;&quot;&quot;&#xa;    sections = load_sections(doc_id, version)&#xa;    if not sections:&#xa;        typer.secho(&quot;Sections not found. Run parse first.&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;&#xa;&#xa;    llm = LLMClientStub()&#xa;&#xa;&#xa;    def process_section(sec: Dict[str, Any]) -&gt; List[KBObject]:&#xa;        full_text = sec.get(&quot;text&quot;, &quot;&quot;)&#xa;        chunks = chunk_section_text(full_text, max_tokens=max_tokens, overlap_tokens=overlap_tokens)&#xa;        all_objs: List[KBObject] = []&#xa;        for ci, ch in enumerate(chunks):&#xa;            pos = {&quot;start_block_idx&quot;: sec[&quot;start_block_idx&quot;], &quot;end_block_idx&quot;: sec[&quot;end_block_idx&quot;], &quot;chunk_index&quot;: ci}&#xa;            objs = llm.make_objects_for_chunk(&#xa;                doc_id=doc_id,&#xa;                version=version,&#xa;                section_id=sec[&quot;section_id&quot;],&#xa;                chunk_text=ch,&#xa;                full_text=full_text,&#xa;                position=pos,&#xa;            )&#xa;            all_objs.extend(objs)&#xa;        return all_objs&#xa;&#xa;&#xa;    to_insert: List[KBObject] = []&#xa;    with concurrent.futures.ThreadPoolExecutor(max_workers=workers) as ex:&#xa;        futures = [ex.submit(process_section, s) for s in sections]&#xa;        for f in concurrent.futures.as_completed(futures):&#xa;            to_insert.extend(f.result())&#xa;&#xa;&#xa;    # Сохраняем целиком objects.json&#xa;    save_objects(doc_id, version, [o.model_dump() for o in to_insert])&#xa;    typer.echo(f&quot;[build-kb] objects stored: {len(to_insert)}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;export-jsonl&quot;)&#xa;def export_jsonl(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: Optional[str] = typer.Option(None, &quot;--version&quot;),&#xa;    out: Path = typer.Option(..., &quot;--out&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Экспортирует sections + objects в JSONL.&quot;&quot;&quot;&#xa;    if version is None:&#xa;        # если версия не указана — возьмём единственную папку&#xa;        doc_dir = DATA_DIR / doc_id&#xa;        versions = [p.name for p in doc_dir.iterdir() if p.is_dir()] if doc_dir.exists() else []&#xa;        if not versions:&#xa;            typer.secho(&quot;Document not found&quot;, fg=typer.colors.RED); raise typer.Exit(1)&#xa;        version = sorted(versions)[-1]&#xa;&#xa;&#xa;    sections = load_sections(doc_id, version)&#xa;    objects = load_objects(doc_id, version)&#xa;&#xa;&#xa;    with out.open(&quot;w&quot;, encoding=&quot;utf-8&quot;) as f:&#xa;        for s in sections:&#xa;            rec = {&quot;type&quot;: &quot;section&quot;, **s}&#xa;            f.write(json.dumps(rec, ensure_ascii=False) + &quot;\n&quot;)&#xa;        for o in objects:&#xa;            rec = {&quot;type&quot;: &quot;object&quot;, **o}&#xa;            f.write(json.dumps(rec, ensure_ascii=False) + &quot;\n&quot;)&#xa;    typer.echo(f&quot;[export-jsonl] wrote {len(sections)+len(objects)} records → {out}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;validate&quot;)&#xa;def validate(&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Мини-проверки покрытия.&quot;&quot;&quot;&#xa;    sections = load_sections(doc_id, version)&#xa;    objects = load_objects(doc_id, version)&#xa;&#xa;&#xa;    sec_ids = {s[&quot;section_id&quot;] for s in sections}&#xa;    obj_by_sec = {sid: 0 for sid in sec_ids}&#xa;    for o in objects:&#xa;        sid = o.get(&quot;section_id&quot;);&#xa;        if sid in obj_by_sec:&#xa;            obj_by_sec[sid] += 1&#xa;&#xa;&#xa;    typer.echo(f&quot;[validate] sections: {len(sections)}, objects: {len(objects)}&quot;)&#xa;    zero = [sid for sid, cnt in obj_by_sec.items() if cnt == 0]&#xa;    if zero:&#xa;        typer.secho(f&quot;[validate] sections without objects: {len(zero)}&quot;, fg=typer.colors.YELLOW)&#xa;    else:&#xa;        typer.echo(&quot;[validate] every section has objects ✅&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command(&quot;terms-extract&quot;)&#xa;def terms_extract(&#xa;    docx_path: Path = typer.Argument(..., exists=True, readable=True, help=&quot;DOCX-файл (оригинал)&quot;),&#xa;    doc_id: str = typer.Option(..., &quot;--doc-id&quot;),&#xa;    version: str = typer.Option(..., &quot;--version&quot;),&#xa;):&#xa;    &quot;&quot;&quot;Грубое извлечение терминов/сокращений из таблиц DOCX → terms.json (дополняет).&quot;&quot;&quot;&#xa;    d = DocxDocument(str(docx_path))&#xa;&#xa;&#xa;    def norm(s: str) -&gt; str:&#xa;        return re.sub(r&quot;\s+&quot;, &quot; &quot;, s).strip()&#xa;&#xa;&#xa;    terms = load_terms(doc_id, version)&#xa;    existed = {(t.get(&quot;term&quot;), t.get(&quot;definition&quot;)) for t in terms}&#xa;    inserts = 0&#xa;&#xa;&#xa;    for tbl in d.tables:&#xa;        for row in tbl.rows:&#xa;            cells = [norm(c.text) for c in row.cells]&#xa;            if len(cells) &lt; 2:&#xa;                continue&#xa;            term, definition = cells[0], cells[1]&#xa;            if not term or not definition:&#xa;                continue&#xa;            key = (term, definition)&#xa;            if key in existed:&#xa;                continue&#xa;            terms.append({&#xa;                &quot;id&quot;: stable_id(doc_id, version, term, definition[:20]),&#xa;                &quot;doc_id&quot;: doc_id,&#xa;                &quot;section_id&quot;: None,&#xa;                &quot;term&quot;: term,&#xa;                &quot;normalized&quot;: term.lower(),&#xa;                &quot;kind&quot;: &quot;term&quot;,&#xa;                &quot;definition&quot;: definition,&#xa;            })&#xa;            existed.add(key)&#xa;            inserts += 1&#xa;&#xa;&#xa;    save_terms(doc_id, version, terms)&#xa;    typer.echo(f&quot;[terms-extract] terms upserted: {inserts}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;if __name__ == &quot;__main__&quot;:&#xa;    app()" id="QEKYloZPeFY1qbjBXhYU-1">
          <mxCell style="text;whiteSpace=wrap;" vertex="1" parent="1">
            <mxGeometry x="50" y="80" width="560" height="10660" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="#!/usr/bin/env python3&#xa;&quot;&quot;&quot;&#xa;JSON-based Q&amp;A Interface for VND Knowledge Base — without any DBMS.&#xa;&#xa;&#xa;Reads JSON artifacts produced by your pipeline (sections.json, objects.json, terms.json)&#xa;and builds an in-memory BM25 index with light-weight field weighting.&#xa;&#xa;&#xa;CLI commands:&#xa;  • index  — scan data dir and build a JSON index cache&#xa;  • ask    — answer a user question by retrieving top passages (optional LLM synthesis)&#xa;  • search — raw search over sections and FAQs&#xa;&#xa;&#xa;Env (optional, for LLM answer synthesis):&#xa;  GIGACHAT_API_BASE, GIGACHAT_API_KEY, GIGACHAT_MODEL&#xa;&#xa;&#xa;Dependencies (Python 3.10+):&#xa;  pip install typer pydantic tenacity requests&#xa;&#xa;&#xa;Data layout expected (JSON store variant):&#xa;  vnd_kb_data/&lt;doc_id&gt;/&lt;version&gt;/&#xa;    document.json&#xa;    sections.json&#xa;    objects.json&#xa;    terms.json&#xa;&#xa;&#xa;Cache:&#xa;  .vnd_kb_cache/search_index.json&#xa;&quot;&quot;&quot;&#xa;from __future__ import annotations&#xa;&#xa;&#xa;import json&#xa;import math&#xa;import os&#xa;import re&#xa;import time&#xa;from dataclasses import dataclass&#xa;from pathlib import Path&#xa;from typing import Any, Dict, List, Optional, Tuple&#xa;&#xa;&#xa;import typer&#xa;from pydantic import BaseModel&#xa;from tenacity import retry, wait_exponential, stop_after_attempt&#xa;import requests&#xa;&#xa;&#xa;app = typer.Typer(add_completion=False, help=&quot;VND KB — JSON Q&amp;A (no DB)&quot;)&#xa;&#xa;&#xa;DATA_DIR = Path(os.environ.get(&quot;VND_KB_DATA&quot;, &quot;vnd_kb_data&quot;))&#xa;CACHE_DIR = Path(os.environ.get(&quot;VND_KB_CACHE&quot;, &quot;.vnd_kb_cache&quot;))&#xa;CACHE_DIR.mkdir(parents=True, exist_ok=True)&#xa;INDEX_PATH = CACHE_DIR / &quot;search_index.json&quot;&#xa;&#xa;&#xa;# ---------------------&#xa;# Tokenization &amp; utils&#xa;# ---------------------&#xa;TOKEN_RE = re.compile(r&quot;[A-Za-zА-Яа-я0-9]+&quot;, re.UNICODE)&#xa;RU_STOP = set(&#xa;    &quot;и в во не что он на я с со как а то все она так его но да ты к у же вы за бы по только ее мне было вот от меня еще нет о из ему теперь когда даже ну вдруг ли если уже или ни быть был него до вас нибудь опять уж вам ведь там потом себя ничего ей может они тут где есть надо ней для мы тебя их чем была сам чтоб без будто чем раз тоже себя них чем-то чего почему поэтому&quot;.split()&#xa;)&#xa;&#xa;&#xa;&#xa;&#xa;def norm(s: str) -&gt; str:&#xa;    return re.sub(r&quot;\s+&quot;, &quot; &quot;, s).strip()&#xa;&#xa;&#xa;&#xa;&#xa;def tokenize(text: str) -&gt; List[str]:&#xa;    if not text:&#xa;        return []&#xa;    toks = [t.lower() for t in TOKEN_RE.findall(text)]&#xa;    return [t for t in toks if t not in RU_STOP and len(t) &gt; 1]&#xa;&#xa;&#xa;# ---------------------&#xa;# Data loading&#xa;# ---------------------&#xa;class SectionRec(BaseModel):&#xa;    section_id: str&#xa;    doc_id: str&#xa;    version: str&#xa;    level: int&#xa;    section_number: str | None = None&#xa;    title: str&#xa;    title_path: List[str]&#xa;    start_block_idx: int&#xa;    end_block_idx: int&#xa;    content_hash: str&#xa;    text: str&#xa;&#xa;&#xa;class ObjectRec(BaseModel):&#xa;    object_id: str&#xa;    section_id: str&#xa;    kind: str&#xa;    payload_json: Dict[str, Any] | None = None&#xa;    payload: Dict[str, Any] | None = None&#xa;    meta_json: Dict[str, Any] | None = None&#xa;    meta: Dict[str, Any] | None = None&#xa;&#xa;&#xa;    def payload_dict(self) -&gt; Dict[str, Any]:&#xa;        return self.payload or self.payload_json or {}&#xa;&#xa;&#xa;    def meta_dict(self) -&gt; Dict[str, Any]:&#xa;        return self.meta or self.meta_json or {}&#xa;&#xa;&#xa;&#xa;&#xa;@dataclass&#xa;class Entry:&#xa;    &quot;&quot;&quot;Index entry per section.&quot;&quot;&quot;&#xa;    key: str                  # stable_id per section&#xa;    doc_id: str&#xa;    version: str&#xa;    title: str&#xa;    title_path: List[str]&#xa;    section_number: Optional[str]&#xa;    text: str                 # main body&#xa;    summary: str&#xa;    keywords: List[str]&#xa;    faqs: List[str]           # question texts&#xa;&#xa;&#xa;# ---------------------&#xa;# Index building (BM25)&#xa;# ---------------------&#xa;class BM25Index:&#xa;    def __init__(self, k1: float = 1.5, b: float = 0.75, field_weights: Optional[Dict[str, float]] = None):&#xa;        self.k1 = k1&#xa;        self.b = b&#xa;        self.field_weights = field_weights or {&#xa;            &quot;title&quot;: 2.0,&#xa;            &quot;summary&quot;: 1.3,&#xa;            &quot;keywords&quot;: 1.5,&#xa;            &quot;faqs&quot;: 1.2,&#xa;            &quot;text&quot;: 1.0,&#xa;        }&#xa;        # docs&#xa;        self.entries: List[Entry] = []&#xa;        # per-field token stats&#xa;        self.tf: Dict[str, List[Dict[str, int]]] = {f: [] for f in self.field_weights}&#xa;        self.df: Dict[str, int] = {}   # df across all fields combined&#xa;        self.doclen: Dict[str, List[int]] = {f: [] for f in self.field_weights}&#xa;        self.avgdl: Dict[str, float] = {f: 0.0 for f in self.field_weights}&#xa;&#xa;&#xa;    def add_entry(self, e: Entry) -&gt; None:&#xa;        self.entries.append(e)&#xa;        # tokenize per field&#xa;        fields = {&#xa;            &quot;title&quot;: &quot; &quot;.join(e.title_path + [e.title]),&#xa;            &quot;summary&quot;: e.summary,&#xa;            &quot;keywords&quot;: &quot; &quot;.join(e.keywords),&#xa;            &quot;faqs&quot;: &quot; \n&quot;.join(e.faqs),&#xa;            &quot;text&quot;: e.text,&#xa;        }&#xa;        seen_global: set[str] = set()&#xa;        for f, content in fields.items():&#xa;            toks = tokenize(content)&#xa;            counts: Dict[str, int] = {}&#xa;            for t in toks:&#xa;                counts[t] = counts.get(t, 0) + 1&#xa;            self.tf[f].append(counts)&#xa;            self.doclen[f].append(sum(counts.values()))&#xa;            for t in counts.keys():&#xa;                if t not in seen_global:&#xa;                    self.df[t] = self.df.get(t, 0) + 1&#xa;            seen_global.update(counts.keys())&#xa;&#xa;&#xa;    def finalize(self) -&gt; None:&#xa;        n = len(self.entries)&#xa;        for f in self.field_weights.keys():&#xa;            dl = self.doclen[f]&#xa;            self.avgdl[f] = (sum(dl) / n) if n &gt; 0 else 0.0&#xa;&#xa;&#xa;    # idf across all docs/fields&#xa;    def idf(self, term: str) -&gt; float:&#xa;        n = len(self.entries)&#xa;        df = self.df.get(term, 0)&#xa;        return math.log((n - df + 0.5) / (df + 0.5) + 1.0)&#xa;&#xa;&#xa;    def score_doc(self, i: int, qterms: List[str]) -&gt; float:&#xa;        score = 0.0&#xa;        for t in qterms:&#xa;            idf_t = self.idf(t)&#xa;            if idf_t &lt;= 0:&#xa;                continue&#xa;            for f, w in self.field_weights.items():&#xa;                tf = self.tf[f][i].get(t, 0)&#xa;                if tf == 0:&#xa;                    continue&#xa;                dl = self.doclen[f][i] or 1&#xa;                avgdl = self.avgdl[f] or 1.0&#xa;                # BM25 for this field&#xa;                num = tf * (self.k1 + 1)&#xa;                den = tf + self.k1 * (1 - self.b + self.b * (dl / avgdl))&#xa;                score += w * idf_t * (num / den)&#xa;        return score&#xa;&#xa;&#xa;    def search(self, query: str, top_k: int = 10) -&gt; List[Tuple[Entry, float]]:&#xa;        qterms = tokenize(query)&#xa;        if not qterms:&#xa;            return []&#xa;        scores = []&#xa;        for i in range(len(self.entries)):&#xa;            s = self.score_doc(i, qterms)&#xa;            if s &gt; 0:&#xa;                scores.append((i, s))&#xa;        scores.sort(key=lambda x: x[1], reverse=True)&#xa;        return [(self.entries[i], s) for i, s in scores[:top_k]]&#xa;&#xa;&#xa;    # serialization&#xa;    def to_json(self) -&gt; Dict[str, Any]:&#xa;        return {&#xa;            &quot;k1&quot;: self.k1,&#xa;            &quot;b&quot;: self.b,&#xa;            &quot;field_weights&quot;: self.field_weights,&#xa;            &quot;entries&quot;: [e.__dict__ for e in self.entries],&#xa;            &quot;tf&quot;: {f: self.tf[f] for f in self.field_weights},&#xa;            &quot;df&quot;: self.df,&#xa;            &quot;doclen&quot;: self.doclen,&#xa;            &quot;avgdl&quot;: self.avgdl,&#xa;        }&#xa;&#xa;&#xa;    @staticmethod&#xa;    def from_json(d: Dict[str, Any]) -&gt; &quot;BM25Index&quot;:&#xa;        idx = BM25Index(k1=d[&quot;k1&quot;], b=d[&quot;b&quot;], field_weights=d[&quot;field_weights&quot;])&#xa;        idx.entries = [Entry(**e) for e in d[&quot;entries&quot;]]&#xa;        idx.tf = {f: [{k: int(v) for k, v in row.items()} for row in d[&quot;tf&quot;][f]] for f in idx.field_weights}&#xa;        idx.df = {k: int(v) for k, v in d[&quot;df&quot;].items()}&#xa;        idx.doclen = {f: [int(x) for x in d[&quot;doclen&quot;][f]] for f in idx.field_weights}&#xa;        idx.avgdl = {f: float(v) for f, v in d[&quot;avgdl&quot;].items()}&#xa;        return idx&#xa;&#xa;&#xa;# ---------------------&#xa;# Build entries from JSON store&#xa;# ---------------------&#xa;&#xa;&#xa;def load_entries_for(doc_dir: Path) -&gt; List[Entry]:&#xa;    sections_p = doc_dir / &quot;sections.json&quot;&#xa;    objects_p = doc_dir / &quot;objects.json&quot;&#xa;    if not sections_p.exists():&#xa;        return []&#xa;    sections = [SectionRec(**s) for s in json.loads(sections_p.read_text(encoding=&quot;utf-8&quot;))]&#xa;    objects_raw = json.loads(objects_p.read_text(encoding=&quot;utf-8&quot;)) if objects_p.exists() else []&#xa;&#xa;&#xa;    # group objects by section&#xa;    by_sec: Dict[str, List[ObjectRec]] = {}&#xa;    for o in objects_raw:&#xa;        # allow both JSON store (payload/meta) and SQLite export (payload_json/meta_json)&#xa;        rec = ObjectRec(**o)&#xa;        by_sec.setdefault(rec.section_id, []).append(rec)&#xa;&#xa;&#xa;    entries: List[Entry] = []&#xa;    for s in sections:&#xa;        objs = by_sec.get(s.section_id, [])&#xa;        summary = &quot;&quot;&#xa;        keywords: List[str] = []&#xa;        faqs: List[str] = []&#xa;        for o in objs:&#xa;            if o.kind == &quot;summary&quot;:&#xa;                summary = str(o.payload_dict().get(&quot;text&quot;, &quot;&quot;))&#xa;            elif o.kind == &quot;keywords&quot;:&#xa;                items = o.payload_dict().get(&quot;items&quot;, [])&#xa;                keywords.extend([str(x) for x in items])&#xa;            elif o.kind == &quot;questions&quot;:&#xa;                items = o.payload_dict().get(&quot;items&quot;, [])&#xa;                for it in items:&#xa;                    if isinstance(it, dict):&#xa;                        q = it.get(&quot;q&quot;)&#xa;                        if q:&#xa;                            faqs.append(str(q))&#xa;                    elif isinstance(it, str):&#xa;                        faqs.append(it)&#xa;        entries.append(Entry(&#xa;            key=s.section_id,&#xa;            doc_id=s.doc_id,&#xa;            version=s.version,&#xa;            title=s.title,&#xa;            title_path=s.title_path,&#xa;            section_number=s.section_number,&#xa;            text=s.text,&#xa;            summary=summary,&#xa;            keywords=keywords,&#xa;            faqs=faqs,&#xa;        ))&#xa;    return entries&#xa;&#xa;&#xa;&#xa;&#xa;def scan_data(data_dir: Path, only_doc: Optional[str] = None, only_version: Optional[str] = None) -&gt; List[Entry]:&#xa;    entries: List[Entry] = []&#xa;    if only_doc:&#xa;        base = data_dir / only_doc&#xa;        if not base.exists():&#xa;            return []&#xa;        versions = [p for p in base.iterdir() if p.is_dir()] if not only_version else [base / only_version]&#xa;        for vdir in versions:&#xa;            entries.extend(load_entries_for(vdir))&#xa;        return entries&#xa;    # all docs&#xa;    if not data_dir.exists():&#xa;        return []&#xa;    for d in data_dir.iterdir():&#xa;        if not d.is_dir():&#xa;            continue&#xa;        for vdir in d.iterdir():&#xa;            if vdir.is_dir():&#xa;                entries.extend(load_entries_for(vdir))&#xa;    return entries&#xa;&#xa;&#xa;# ---------------------&#xa;# Optional: GigaChat synthesis&#xa;# ---------------------&#xa;class GigaChat:&#xa;    def __init__(self):&#xa;        self.base = (os.environ.get(&quot;GIGACHAT_API_BASE&quot;) or &quot;&quot;).rstrip(&quot;/&quot;)&#xa;        self.key = os.environ.get(&quot;GIGACHAT_API_KEY&quot;)&#xa;        self.model = os.environ.get(&quot;GIGACHAT_MODEL&quot;, &quot;GigaChat:latest&quot;)&#xa;        self.enabled = bool(self.base and self.key)&#xa;&#xa;&#xa;    def headers(self) -&gt; Dict[str, str]:&#xa;        return {&quot;Authorization&quot;: f&quot;Bearer {self.key}&quot;, &quot;Content-Type&quot;: &quot;application/json&quot;}&#xa;&#xa;&#xa;    @retry(wait=wait_exponential(multiplier=1, min=1, max=10), stop=stop_after_attempt(3), reraise=True)&#xa;    def answer(self, question: str, passages: List[Tuple[str, str]], max_words: int = 180) -&gt; str:&#xa;        if not self.enabled:&#xa;            return &quot;&quot;&#xa;        url = f&quot;{self.base}/v1/chat/completions&quot;&#xa;        context = &quot;\n\n&quot;.join([f&quot;[#{i+1}] {title}: {text}&quot; for i, (title, text) in enumerate(passages)])&#xa;        system = (&#xa;            &quot;Ты — ассистент по внутренним документам банка. Отвечай кратко и по делу, на русском. &quot;&#xa;            &quot;Ссылайся на источники квадратными скобками вида [#N], где N — номер пассажа, который ты используешь. &quot;&#xa;            f&quot;Ответ не длиннее {max_words} слов. Если не уверен — скажи, чего не хватает.&quot;&#xa;        )&#xa;        user = f&quot;Вопрос: {question}\n\nКонтекст:\n{context}&quot;&#xa;        data = {&#xa;            &quot;model&quot;: self.model,&#xa;            &quot;messages&quot;: [&#xa;                {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: system},&#xa;                {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: user},&#xa;            ],&#xa;            &quot;temperature&quot;: 0.1,&#xa;        }&#xa;        resp = requests.post(url, headers=self.headers(), json=data, timeout=60)&#xa;        resp.raise_for_status()&#xa;        j = resp.json()&#xa;        return j[&quot;choices&quot;][0][&quot;message&quot;][&quot;content&quot;]&#xa;&#xa;&#xa;# ---------------------&#xa;# CLI: index / ask / search&#xa;# ---------------------&#xa;@app.command()&#xa;def index(doc_id: Optional[str] = typer.Option(None, help=&quot;Ограничить одним документом&quot;),&#xa;          version: Optional[str] = typer.Option(None, help=&quot;Версия документа&quot;)):&#xa;    &quot;&quot;&quot;Просканировать JSON-хранилище и пересобрать индекс BM25.&quot;&quot;&quot;&#xa;    entries = scan_data(DATA_DIR, only_doc=doc_id, only_version=version)&#xa;    if not entries:&#xa;        typer.secho(&quot;Нет данных для индексации&quot;, fg=typer.colors.RED); raise typer.Exit(1)&#xa;    idx = BM25Index()&#xa;    for e in entries:&#xa;        idx.add_entry(e)&#xa;    idx.finalize()&#xa;    INDEX_PATH.write_text(json.dumps(idx.to_json(), ensure_ascii=False))&#xa;    typer.echo(f&quot;[index] entries: {len(entries)} → {INDEX_PATH}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;def _load_index() -&gt; BM25Index:&#xa;    if not INDEX_PATH.exists():&#xa;        typer.secho(&quot;Индекс не найден. Сначала выполните команду: index&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;    return BM25Index.from_json(json.loads(INDEX_PATH.read_text(encoding=&quot;utf-8&quot;)))&#xa;&#xa;&#xa;&#xa;&#xa;def _make_snippet(text: str, query: str, width: int = 220) -&gt; str:&#xa;    toks = tokenize(query)&#xa;    if not text:&#xa;        return &quot;&quot;&#xa;    # ищем первое вхождение любого терма&#xa;    idx = len(text) // 2&#xa;    pos = None&#xa;    for t in toks:&#xa;        m = re.search(re.escape(t), text.lower())&#xa;        if m:&#xa;            pos = m.start(); break&#xa;    if pos is None:&#xa;        pos = 0&#xa;    start = max(0, pos - width // 2)&#xa;    end = min(len(text), start + width)&#xa;    chunk = text[start:end]&#xa;    # подсветка&#xa;    for t in toks:&#xa;        chunk = re.sub(f&quot;(?i)({re.escape(t)})&quot;, r&quot;**\1**&quot;, chunk)&#xa;    return (&quot;…&quot; if start &gt; 0 else &quot;&quot;) + chunk + (&quot;…&quot; if end &lt; len(text) else &quot;&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command()&#xa;def search(query: str = typer.Argument(..., help=&quot;Поисковый запрос&quot;),&#xa;           top_k: int = typer.Option(8, help=&quot;Сколько результатов показать&quot;),&#xa;           show_faqs: bool = typer.Option(True, help=&quot;Показывать совпавшие FAQ-вопросы&quot;)):&#xa;    &quot;&quot;&quot;Просто поиск по разделам (BM25).&quot;&quot;&quot;&#xa;    idx = _load_index()&#xa;    hits = idx.search(query, top_k=top_k)&#xa;    if not hits:&#xa;        typer.echo(&quot;Ничего не найдено&quot;)&#xa;        raise typer.Exit(0)&#xa;    for rank, (e, score) in enumerate(hits, 1):&#xa;        tp = &quot; / &quot;.join(e.title_path + [e.title])&#xa;        typer.echo(f&quot;#{rank}  [{e.doc_id} v{e.version}]  {tp}   (score={score:.3f})&quot;)&#xa;        snippet = _make_snippet(e.summary or e.text, query)&#xa;        if snippet:&#xa;            typer.echo(f&quot;    {snippet}&quot;)&#xa;        if show_faqs and e.faqs:&#xa;            # покажем до 2 релевантных FAQ&#xa;            rel = [q for q in e.faqs if any(t in q.lower() for t in tokenize(query))][:2]&#xa;            for q in rel:&#xa;                typer.echo(f&quot;    FAQ: · {q}&quot;)&#xa;        typer.echo(&quot;&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command()&#xa;def ask(question: str = typer.Argument(..., help=&quot;Вопрос пользователя&quot;),&#xa;        top_k: int = typer.Option(5, help=&quot;Сколько пассажей отдать в ответ&quot;),&#xa;        with_llm: bool = typer.Option(False, help=&quot;Синтез ответа через GigaChat&quot;),&#xa;        max_words: int = typer.Option(180, help=&quot;Ограничение длины ответа LLM&quot;)):&#xa;    &quot;&quot;&quot;Задаёт вопрос: достаёт лучшие пассажи и (опционально) синтезирует краткий ответ.&#xa;    Без LLM выводит только пассажи со сниппетами.&#xa;    &quot;&quot;&quot;&#xa;    idx = _load_index()&#xa;    hits = idx.search(question, top_k=top_k)&#xa;    if not hits:&#xa;        typer.echo(&quot;Ничего не найдено&quot;)&#xa;        raise typer.Exit(0)&#xa;&#xa;&#xa;    passages: List[Tuple[str, str]] = []&#xa;    typer.echo(&quot; Топ-пассажи:\n&quot;)&#xa;    for i, (e, score) in enumerate(hits, 1):&#xa;        tp = &quot; / &quot;.join(e.title_path + [e.title])&#xa;        snippet = _make_snippet(e.summary or e.text, question, width=360)&#xa;        typer.echo(f&quot;[{i}] [{e.doc_id} v{e.version}] {tp}  (score={score:.3f})&quot;)&#xa;        typer.echo(f&quot;    {snippet}\n&quot;)&#xa;        passages.append((tp, (e.summary or e.text)))&#xa;&#xa;&#xa;    if with_llm:&#xa;        giga = GigaChat()&#xa;        if giga.enabled:&#xa;            typer.echo(&quot;—&quot;*60)&#xa;            answer = giga.answer(question, passages, max_words=max_words)&#xa;            typer.echo(&quot;Ответ (LLM):\n&quot;)&#xa;            typer.echo(answer)&#xa;        else:&#xa;            typer.secho(&quot;GigaChat env vars not set; showing passages only.&quot;, fg=typer.colors.YELLOW)&#xa;&#xa;&#xa;&#xa;&#xa;if __name__ == &quot;__main__&quot;:&#xa;    app()" link="#!/usr/bin/env python3&#xa;&quot;&quot;&quot;&#xa;JSON-based Q&amp;A Interface for VND Knowledge Base — without any DBMS.&#xa;&#xa;&#xa;Reads JSON artifacts produced by your pipeline (sections.json, objects.json, terms.json)&#xa;and builds an in-memory BM25 index with light-weight field weighting.&#xa;&#xa;&#xa;CLI commands:&#xa;  • index  — scan data dir and build a JSON index cache&#xa;  • ask    — answer a user question by retrieving top passages (optional LLM synthesis)&#xa;  • search — raw search over sections and FAQs&#xa;&#xa;&#xa;Env (optional, for LLM answer synthesis):&#xa;  GIGACHAT_API_BASE, GIGACHAT_API_KEY, GIGACHAT_MODEL&#xa;&#xa;&#xa;Dependencies (Python 3.10+):&#xa;  pip install typer pydantic tenacity requests&#xa;&#xa;&#xa;Data layout expected (JSON store variant):&#xa;  vnd_kb_data/&lt;doc_id&gt;/&lt;version&gt;/&#xa;    document.json&#xa;    sections.json&#xa;    objects.json&#xa;    terms.json&#xa;&#xa;&#xa;Cache:&#xa;  .vnd_kb_cache/search_index.json&#xa;&quot;&quot;&quot;&#xa;from __future__ import annotations&#xa;&#xa;&#xa;import json&#xa;import math&#xa;import os&#xa;import re&#xa;import time&#xa;from dataclasses import dataclass&#xa;from pathlib import Path&#xa;from typing import Any, Dict, List, Optional, Tuple&#xa;&#xa;&#xa;import typer&#xa;from pydantic import BaseModel&#xa;from tenacity import retry, wait_exponential, stop_after_attempt&#xa;import requests&#xa;&#xa;&#xa;app = typer.Typer(add_completion=False, help=&quot;VND KB — JSON Q&amp;A (no DB)&quot;)&#xa;&#xa;&#xa;DATA_DIR = Path(os.environ.get(&quot;VND_KB_DATA&quot;, &quot;vnd_kb_data&quot;))&#xa;CACHE_DIR = Path(os.environ.get(&quot;VND_KB_CACHE&quot;, &quot;.vnd_kb_cache&quot;))&#xa;CACHE_DIR.mkdir(parents=True, exist_ok=True)&#xa;INDEX_PATH = CACHE_DIR / &quot;search_index.json&quot;&#xa;&#xa;&#xa;# ---------------------&#xa;# Tokenization &amp; utils&#xa;# ---------------------&#xa;TOKEN_RE = re.compile(r&quot;[A-Za-zА-Яа-я0-9]+&quot;, re.UNICODE)&#xa;RU_STOP = set(&#xa;    &quot;и в во не что он на я с со как а то все она так его но да ты к у же вы за бы по только ее мне было вот от меня еще нет о из ему теперь когда даже ну вдруг ли если уже или ни быть был него до вас нибудь опять уж вам ведь там потом себя ничего ей может они тут где есть надо ней для мы тебя их чем была сам чтоб без будто чем раз тоже себя них чем-то чего почему поэтому&quot;.split()&#xa;)&#xa;&#xa;&#xa;&#xa;&#xa;def norm(s: str) -&gt; str:&#xa;    return re.sub(r&quot;\s+&quot;, &quot; &quot;, s).strip()&#xa;&#xa;&#xa;&#xa;&#xa;def tokenize(text: str) -&gt; List[str]:&#xa;    if not text:&#xa;        return []&#xa;    toks = [t.lower() for t in TOKEN_RE.findall(text)]&#xa;    return [t for t in toks if t not in RU_STOP and len(t) &gt; 1]&#xa;&#xa;&#xa;# ---------------------&#xa;# Data loading&#xa;# ---------------------&#xa;class SectionRec(BaseModel):&#xa;    section_id: str&#xa;    doc_id: str&#xa;    version: str&#xa;    level: int&#xa;    section_number: str | None = None&#xa;    title: str&#xa;    title_path: List[str]&#xa;    start_block_idx: int&#xa;    end_block_idx: int&#xa;    content_hash: str&#xa;    text: str&#xa;&#xa;&#xa;class ObjectRec(BaseModel):&#xa;    object_id: str&#xa;    section_id: str&#xa;    kind: str&#xa;    payload_json: Dict[str, Any] | None = None&#xa;    payload: Dict[str, Any] | None = None&#xa;    meta_json: Dict[str, Any] | None = None&#xa;    meta: Dict[str, Any] | None = None&#xa;&#xa;&#xa;    def payload_dict(self) -&gt; Dict[str, Any]:&#xa;        return self.payload or self.payload_json or {}&#xa;&#xa;&#xa;    def meta_dict(self) -&gt; Dict[str, Any]:&#xa;        return self.meta or self.meta_json or {}&#xa;&#xa;&#xa;&#xa;&#xa;@dataclass&#xa;class Entry:&#xa;    &quot;&quot;&quot;Index entry per section.&quot;&quot;&quot;&#xa;    key: str                  # stable_id per section&#xa;    doc_id: str&#xa;    version: str&#xa;    title: str&#xa;    title_path: List[str]&#xa;    section_number: Optional[str]&#xa;    text: str                 # main body&#xa;    summary: str&#xa;    keywords: List[str]&#xa;    faqs: List[str]           # question texts&#xa;&#xa;&#xa;# ---------------------&#xa;# Index building (BM25)&#xa;# ---------------------&#xa;class BM25Index:&#xa;    def __init__(self, k1: float = 1.5, b: float = 0.75, field_weights: Optional[Dict[str, float]] = None):&#xa;        self.k1 = k1&#xa;        self.b = b&#xa;        self.field_weights = field_weights or {&#xa;            &quot;title&quot;: 2.0,&#xa;            &quot;summary&quot;: 1.3,&#xa;            &quot;keywords&quot;: 1.5,&#xa;            &quot;faqs&quot;: 1.2,&#xa;            &quot;text&quot;: 1.0,&#xa;        }&#xa;        # docs&#xa;        self.entries: List[Entry] = []&#xa;        # per-field token stats&#xa;        self.tf: Dict[str, List[Dict[str, int]]] = {f: [] for f in self.field_weights}&#xa;        self.df: Dict[str, int] = {}   # df across all fields combined&#xa;        self.doclen: Dict[str, List[int]] = {f: [] for f in self.field_weights}&#xa;        self.avgdl: Dict[str, float] = {f: 0.0 for f in self.field_weights}&#xa;&#xa;&#xa;    def add_entry(self, e: Entry) -&gt; None:&#xa;        self.entries.append(e)&#xa;        # tokenize per field&#xa;        fields = {&#xa;            &quot;title&quot;: &quot; &quot;.join(e.title_path + [e.title]),&#xa;            &quot;summary&quot;: e.summary,&#xa;            &quot;keywords&quot;: &quot; &quot;.join(e.keywords),&#xa;            &quot;faqs&quot;: &quot; \n&quot;.join(e.faqs),&#xa;            &quot;text&quot;: e.text,&#xa;        }&#xa;        seen_global: set[str] = set()&#xa;        for f, content in fields.items():&#xa;            toks = tokenize(content)&#xa;            counts: Dict[str, int] = {}&#xa;            for t in toks:&#xa;                counts[t] = counts.get(t, 0) + 1&#xa;            self.tf[f].append(counts)&#xa;            self.doclen[f].append(sum(counts.values()))&#xa;            for t in counts.keys():&#xa;                if t not in seen_global:&#xa;                    self.df[t] = self.df.get(t, 0) + 1&#xa;            seen_global.update(counts.keys())&#xa;&#xa;&#xa;    def finalize(self) -&gt; None:&#xa;        n = len(self.entries)&#xa;        for f in self.field_weights.keys():&#xa;            dl = self.doclen[f]&#xa;            self.avgdl[f] = (sum(dl) / n) if n &gt; 0 else 0.0&#xa;&#xa;&#xa;    # idf across all docs/fields&#xa;    def idf(self, term: str) -&gt; float:&#xa;        n = len(self.entries)&#xa;        df = self.df.get(term, 0)&#xa;        return math.log((n - df + 0.5) / (df + 0.5) + 1.0)&#xa;&#xa;&#xa;    def score_doc(self, i: int, qterms: List[str]) -&gt; float:&#xa;        score = 0.0&#xa;        for t in qterms:&#xa;            idf_t = self.idf(t)&#xa;            if idf_t &lt;= 0:&#xa;                continue&#xa;            for f, w in self.field_weights.items():&#xa;                tf = self.tf[f][i].get(t, 0)&#xa;                if tf == 0:&#xa;                    continue&#xa;                dl = self.doclen[f][i] or 1&#xa;                avgdl = self.avgdl[f] or 1.0&#xa;                # BM25 for this field&#xa;                num = tf * (self.k1 + 1)&#xa;                den = tf + self.k1 * (1 - self.b + self.b * (dl / avgdl))&#xa;                score += w * idf_t * (num / den)&#xa;        return score&#xa;&#xa;&#xa;    def search(self, query: str, top_k: int = 10) -&gt; List[Tuple[Entry, float]]:&#xa;        qterms = tokenize(query)&#xa;        if not qterms:&#xa;            return []&#xa;        scores = []&#xa;        for i in range(len(self.entries)):&#xa;            s = self.score_doc(i, qterms)&#xa;            if s &gt; 0:&#xa;                scores.append((i, s))&#xa;        scores.sort(key=lambda x: x[1], reverse=True)&#xa;        return [(self.entries[i], s) for i, s in scores[:top_k]]&#xa;&#xa;&#xa;    # serialization&#xa;    def to_json(self) -&gt; Dict[str, Any]:&#xa;        return {&#xa;            &quot;k1&quot;: self.k1,&#xa;            &quot;b&quot;: self.b,&#xa;            &quot;field_weights&quot;: self.field_weights,&#xa;            &quot;entries&quot;: [e.__dict__ for e in self.entries],&#xa;            &quot;tf&quot;: {f: self.tf[f] for f in self.field_weights},&#xa;            &quot;df&quot;: self.df,&#xa;            &quot;doclen&quot;: self.doclen,&#xa;            &quot;avgdl&quot;: self.avgdl,&#xa;        }&#xa;&#xa;&#xa;    @staticmethod&#xa;    def from_json(d: Dict[str, Any]) -&gt; &quot;BM25Index&quot;:&#xa;        idx = BM25Index(k1=d[&quot;k1&quot;], b=d[&quot;b&quot;], field_weights=d[&quot;field_weights&quot;])&#xa;        idx.entries = [Entry(**e) for e in d[&quot;entries&quot;]]&#xa;        idx.tf = {f: [{k: int(v) for k, v in row.items()} for row in d[&quot;tf&quot;][f]] for f in idx.field_weights}&#xa;        idx.df = {k: int(v) for k, v in d[&quot;df&quot;].items()}&#xa;        idx.doclen = {f: [int(x) for x in d[&quot;doclen&quot;][f]] for f in idx.field_weights}&#xa;        idx.avgdl = {f: float(v) for f, v in d[&quot;avgdl&quot;].items()}&#xa;        return idx&#xa;&#xa;&#xa;# ---------------------&#xa;# Build entries from JSON store&#xa;# ---------------------&#xa;&#xa;&#xa;def load_entries_for(doc_dir: Path) -&gt; List[Entry]:&#xa;    sections_p = doc_dir / &quot;sections.json&quot;&#xa;    objects_p = doc_dir / &quot;objects.json&quot;&#xa;    if not sections_p.exists():&#xa;        return []&#xa;    sections = [SectionRec(**s) for s in json.loads(sections_p.read_text(encoding=&quot;utf-8&quot;))]&#xa;    objects_raw = json.loads(objects_p.read_text(encoding=&quot;utf-8&quot;)) if objects_p.exists() else []&#xa;&#xa;&#xa;    # group objects by section&#xa;    by_sec: Dict[str, List[ObjectRec]] = {}&#xa;    for o in objects_raw:&#xa;        # allow both JSON store (payload/meta) and SQLite export (payload_json/meta_json)&#xa;        rec = ObjectRec(**o)&#xa;        by_sec.setdefault(rec.section_id, []).append(rec)&#xa;&#xa;&#xa;    entries: List[Entry] = []&#xa;    for s in sections:&#xa;        objs = by_sec.get(s.section_id, [])&#xa;        summary = &quot;&quot;&#xa;        keywords: List[str] = []&#xa;        faqs: List[str] = []&#xa;        for o in objs:&#xa;            if o.kind == &quot;summary&quot;:&#xa;                summary = str(o.payload_dict().get(&quot;text&quot;, &quot;&quot;))&#xa;            elif o.kind == &quot;keywords&quot;:&#xa;                items = o.payload_dict().get(&quot;items&quot;, [])&#xa;                keywords.extend([str(x) for x in items])&#xa;            elif o.kind == &quot;questions&quot;:&#xa;                items = o.payload_dict().get(&quot;items&quot;, [])&#xa;                for it in items:&#xa;                    if isinstance(it, dict):&#xa;                        q = it.get(&quot;q&quot;)&#xa;                        if q:&#xa;                            faqs.append(str(q))&#xa;                    elif isinstance(it, str):&#xa;                        faqs.append(it)&#xa;        entries.append(Entry(&#xa;            key=s.section_id,&#xa;            doc_id=s.doc_id,&#xa;            version=s.version,&#xa;            title=s.title,&#xa;            title_path=s.title_path,&#xa;            section_number=s.section_number,&#xa;            text=s.text,&#xa;            summary=summary,&#xa;            keywords=keywords,&#xa;            faqs=faqs,&#xa;        ))&#xa;    return entries&#xa;&#xa;&#xa;&#xa;&#xa;def scan_data(data_dir: Path, only_doc: Optional[str] = None, only_version: Optional[str] = None) -&gt; List[Entry]:&#xa;    entries: List[Entry] = []&#xa;    if only_doc:&#xa;        base = data_dir / only_doc&#xa;        if not base.exists():&#xa;            return []&#xa;        versions = [p for p in base.iterdir() if p.is_dir()] if not only_version else [base / only_version]&#xa;        for vdir in versions:&#xa;            entries.extend(load_entries_for(vdir))&#xa;        return entries&#xa;    # all docs&#xa;    if not data_dir.exists():&#xa;        return []&#xa;    for d in data_dir.iterdir():&#xa;        if not d.is_dir():&#xa;            continue&#xa;        for vdir in d.iterdir():&#xa;            if vdir.is_dir():&#xa;                entries.extend(load_entries_for(vdir))&#xa;    return entries&#xa;&#xa;&#xa;# ---------------------&#xa;# Optional: GigaChat synthesis&#xa;# ---------------------&#xa;class GigaChat:&#xa;    def __init__(self):&#xa;        self.base = (os.environ.get(&quot;GIGACHAT_API_BASE&quot;) or &quot;&quot;).rstrip(&quot;/&quot;)&#xa;        self.key = os.environ.get(&quot;GIGACHAT_API_KEY&quot;)&#xa;        self.model = os.environ.get(&quot;GIGACHAT_MODEL&quot;, &quot;GigaChat:latest&quot;)&#xa;        self.enabled = bool(self.base and self.key)&#xa;&#xa;&#xa;    def headers(self) -&gt; Dict[str, str]:&#xa;        return {&quot;Authorization&quot;: f&quot;Bearer {self.key}&quot;, &quot;Content-Type&quot;: &quot;application/json&quot;}&#xa;&#xa;&#xa;    @retry(wait=wait_exponential(multiplier=1, min=1, max=10), stop=stop_after_attempt(3), reraise=True)&#xa;    def answer(self, question: str, passages: List[Tuple[str, str]], max_words: int = 180) -&gt; str:&#xa;        if not self.enabled:&#xa;            return &quot;&quot;&#xa;        url = f&quot;{self.base}/v1/chat/completions&quot;&#xa;        context = &quot;\n\n&quot;.join([f&quot;[#{i+1}] {title}: {text}&quot; for i, (title, text) in enumerate(passages)])&#xa;        system = (&#xa;            &quot;Ты — ассистент по внутренним документам банка. Отвечай кратко и по делу, на русском. &quot;&#xa;            &quot;Ссылайся на источники квадратными скобками вида [#N], где N — номер пассажа, который ты используешь. &quot;&#xa;            f&quot;Ответ не длиннее {max_words} слов. Если не уверен — скажи, чего не хватает.&quot;&#xa;        )&#xa;        user = f&quot;Вопрос: {question}\n\nКонтекст:\n{context}&quot;&#xa;        data = {&#xa;            &quot;model&quot;: self.model,&#xa;            &quot;messages&quot;: [&#xa;                {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: system},&#xa;                {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: user},&#xa;            ],&#xa;            &quot;temperature&quot;: 0.1,&#xa;        }&#xa;        resp = requests.post(url, headers=self.headers(), json=data, timeout=60)&#xa;        resp.raise_for_status()&#xa;        j = resp.json()&#xa;        return j[&quot;choices&quot;][0][&quot;message&quot;][&quot;content&quot;]&#xa;&#xa;&#xa;# ---------------------&#xa;# CLI: index / ask / search&#xa;# ---------------------&#xa;@app.command()&#xa;def index(doc_id: Optional[str] = typer.Option(None, help=&quot;Ограничить одним документом&quot;),&#xa;          version: Optional[str] = typer.Option(None, help=&quot;Версия документа&quot;)):&#xa;    &quot;&quot;&quot;Просканировать JSON-хранилище и пересобрать индекс BM25.&quot;&quot;&quot;&#xa;    entries = scan_data(DATA_DIR, only_doc=doc_id, only_version=version)&#xa;    if not entries:&#xa;        typer.secho(&quot;Нет данных для индексации&quot;, fg=typer.colors.RED); raise typer.Exit(1)&#xa;    idx = BM25Index()&#xa;    for e in entries:&#xa;        idx.add_entry(e)&#xa;    idx.finalize()&#xa;    INDEX_PATH.write_text(json.dumps(idx.to_json(), ensure_ascii=False))&#xa;    typer.echo(f&quot;[index] entries: {len(entries)} → {INDEX_PATH}&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;def _load_index() -&gt; BM25Index:&#xa;    if not INDEX_PATH.exists():&#xa;        typer.secho(&quot;Индекс не найден. Сначала выполните команду: index&quot;, fg=typer.colors.RED)&#xa;        raise typer.Exit(1)&#xa;    return BM25Index.from_json(json.loads(INDEX_PATH.read_text(encoding=&quot;utf-8&quot;)))&#xa;&#xa;&#xa;&#xa;&#xa;def _make_snippet(text: str, query: str, width: int = 220) -&gt; str:&#xa;    toks = tokenize(query)&#xa;    if not text:&#xa;        return &quot;&quot;&#xa;    # ищем первое вхождение любого терма&#xa;    idx = len(text) // 2&#xa;    pos = None&#xa;    for t in toks:&#xa;        m = re.search(re.escape(t), text.lower())&#xa;        if m:&#xa;            pos = m.start(); break&#xa;    if pos is None:&#xa;        pos = 0&#xa;    start = max(0, pos - width // 2)&#xa;    end = min(len(text), start + width)&#xa;    chunk = text[start:end]&#xa;    # подсветка&#xa;    for t in toks:&#xa;        chunk = re.sub(f&quot;(?i)({re.escape(t)})&quot;, r&quot;**\1**&quot;, chunk)&#xa;    return (&quot;…&quot; if start &gt; 0 else &quot;&quot;) + chunk + (&quot;…&quot; if end &lt; len(text) else &quot;&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command()&#xa;def search(query: str = typer.Argument(..., help=&quot;Поисковый запрос&quot;),&#xa;           top_k: int = typer.Option(8, help=&quot;Сколько результатов показать&quot;),&#xa;           show_faqs: bool = typer.Option(True, help=&quot;Показывать совпавшие FAQ-вопросы&quot;)):&#xa;    &quot;&quot;&quot;Просто поиск по разделам (BM25).&quot;&quot;&quot;&#xa;    idx = _load_index()&#xa;    hits = idx.search(query, top_k=top_k)&#xa;    if not hits:&#xa;        typer.echo(&quot;Ничего не найдено&quot;)&#xa;        raise typer.Exit(0)&#xa;    for rank, (e, score) in enumerate(hits, 1):&#xa;        tp = &quot; / &quot;.join(e.title_path + [e.title])&#xa;        typer.echo(f&quot;#{rank}  [{e.doc_id} v{e.version}]  {tp}   (score={score:.3f})&quot;)&#xa;        snippet = _make_snippet(e.summary or e.text, query)&#xa;        if snippet:&#xa;            typer.echo(f&quot;    {snippet}&quot;)&#xa;        if show_faqs and e.faqs:&#xa;            # покажем до 2 релевантных FAQ&#xa;            rel = [q for q in e.faqs if any(t in q.lower() for t in tokenize(query))][:2]&#xa;            for q in rel:&#xa;                typer.echo(f&quot;    FAQ: · {q}&quot;)&#xa;        typer.echo(&quot;&quot;)&#xa;&#xa;&#xa;&#xa;&#xa;@app.command()&#xa;def ask(question: str = typer.Argument(..., help=&quot;Вопрос пользователя&quot;),&#xa;        top_k: int = typer.Option(5, help=&quot;Сколько пассажей отдать в ответ&quot;),&#xa;        with_llm: bool = typer.Option(False, help=&quot;Синтез ответа через GigaChat&quot;),&#xa;        max_words: int = typer.Option(180, help=&quot;Ограничение длины ответа LLM&quot;)):&#xa;    &quot;&quot;&quot;Задаёт вопрос: достаёт лучшие пассажи и (опционально) синтезирует краткий ответ.&#xa;    Без LLM выводит только пассажи со сниппетами.&#xa;    &quot;&quot;&quot;&#xa;    idx = _load_index()&#xa;    hits = idx.search(question, top_k=top_k)&#xa;    if not hits:&#xa;        typer.echo(&quot;Ничего не найдено&quot;)&#xa;        raise typer.Exit(0)&#xa;&#xa;&#xa;    passages: List[Tuple[str, str]] = []&#xa;    typer.echo(&quot; Топ-пассажи:\n&quot;)&#xa;    for i, (e, score) in enumerate(hits, 1):&#xa;        tp = &quot; / &quot;.join(e.title_path + [e.title])&#xa;        snippet = _make_snippet(e.summary or e.text, question, width=360)&#xa;        typer.echo(f&quot;[{i}] [{e.doc_id} v{e.version}] {tp}  (score={score:.3f})&quot;)&#xa;        typer.echo(f&quot;    {snippet}\n&quot;)&#xa;        passages.append((tp, (e.summary or e.text)))&#xa;&#xa;&#xa;    if with_llm:&#xa;        giga = GigaChat()&#xa;        if giga.enabled:&#xa;            typer.echo(&quot;—&quot;*60)&#xa;            answer = giga.answer(question, passages, max_words=max_words)&#xa;            typer.echo(&quot;Ответ (LLM):\n&quot;)&#xa;            typer.echo(answer)&#xa;        else:&#xa;            typer.secho(&quot;GigaChat env vars not set; showing passages only.&quot;, fg=typer.colors.YELLOW)&#xa;&#xa;&#xa;&#xa;&#xa;if __name__ == &quot;__main__&quot;:&#xa;    app()" id="QEKYloZPeFY1qbjBXhYU-2">
          <mxCell style="text;whiteSpace=wrap;" vertex="1" parent="1">
            <mxGeometry x="450" y="20" width="560" height="7340" as="geometry" />
          </mxCell>
        </UserObject>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
